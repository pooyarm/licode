var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,p,l){h!=Array.prototype&&h!=Object.prototype&&(h[p]=l.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var h=0;return function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+h++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(h){var p=0;return $jscomp.iteratorPrototype(function(){return p<h.length?{done:!1,value:h[p++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};$jscomp.polyfill=function(h,p,l,b){if(p){l=$jscomp.global;h=h.split(".");for(b=0;b<h.length-1;b++){var a=h[b];a in l||(l[a]={});l=l[a]}h=h[h.length-1];b=l[h];p=p(b);p!=b&&null!=p&&$jscomp.defineProperty(l,h,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("Array.from",function(h){return h?h:function(h,l,b){$jscomp.initSymbolIterator();l=null!=l?l:function(a){return a};var a=[],w=h[Symbol.iterator];if("function"==typeof w){h=w.call(h);for(var e=0;!(w=h.next()).done;)a.push(l.call(b,w.value,e++))}else for(w=h.length,e=0;e<w;e++)a.push(l.call(b,h[e],e));return a}},"es6","es3");
$jscomp.iteratorFromArray=function(h,p){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var l=0,b={next:function(){if(l<h.length){var a=l++;return{value:p(a,h[a]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill("Array.prototype.keys",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h){return h})}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var h={},p=Object.create(new $jscomp.global.Proxy(h,{get:function(l,b,a){return l==h&&"q"==b&&a==p}}));return!0===p.q}catch(l){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(h){$jscomp.initSymbolIterator();var p=h[Symbol.iterator];return p?p.call(h):$jscomp.arrayIterator(h)};
$jscomp.owns=function(h,p){return Object.prototype.hasOwnProperty.call(h,p)};
$jscomp.polyfill("WeakMap",function(h){function p(){if(!h||!Object.seal)return!1;try{var a=Object.seal({}),g=Object.seal({}),d=new h([[a,2],[g,3]]);if(2!=d.get(a)||3!=d.get(g))return!1;d.delete(a);d.set(g,4);return!d.has(a)&&4==d.get(g)}catch(z){return!1}}function l(e){$jscomp.owns(e,a)||$jscomp.defineProperty(e,a,{value:{}})}function b(a){var g=Object[a];g&&(Object[a]=function(d){l(d);return g(d)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(h&&$jscomp.ES6_CONFORMANCE)return h}else if(p())return h;
var a="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var w=0,e=function(a){this.id_=(w+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};e.prototype.set=function(e,g){l(e);if(!$jscomp.owns(e,a))throw Error("WeakMap key fail: "+e);e[a][this.id_]=g;return this};e.prototype.get=function(e){return $jscomp.owns(e,a)?e[a][this.id_]:void 0};e.prototype.has=
function(e){return $jscomp.owns(e,a)&&$jscomp.owns(e[a],this.id_)};e.prototype.delete=function(e){return $jscomp.owns(e,a)&&$jscomp.owns(e[a],this.id_)?delete e[a][this.id_]:!1};return e},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(h){function p(){if($jscomp.ASSUME_NO_NATIVE_MAP||!h||"function"!=typeof h||!h.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),d=new h($jscomp.makeIterator([[g,"s"]]));if("s"!=d.get(g)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var a=d.entries(),u=a.next();if(u.done||u.value[0]!=g||"s"!=u.value[1])return!1;u=a.next();return u.done||4!=u.value[0].x||"t"!=u.value[1]||!a.next().done?!1:!0}catch(t){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(h&&$jscomp.ES6_CONFORMANCE)return h}else if(p())return h;$jscomp.initSymbol();$jscomp.initSymbolIterator();var l=new WeakMap,b=function(g){this.data_={};this.head_=e();this.size=0;if(g){g=$jscomp.makeIterator(g);for(var d;!(d=g.next()).done;)d=d.value,this.set(d[0],d[1])}};b.prototype.set=function(g,d){g=0===g?0:g;var e=a(this,g);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:g,value:d},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};b.prototype.delete=function(g){g=a(this,g);return g.entry&&g.list?(g.list.splice(g.index,1),g.list.length||delete this.data_[g.id],g.entry.previous.next=g.entry.next,g.entry.next.previous=g.entry.previous,g.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};b.prototype.has=function(g){return!!a(this,g).entry};
b.prototype.get=function(g){return(g=a(this,g).entry)&&g.value};b.prototype.entries=function(){return w(this,function(g){return[g.key,g.value]})};b.prototype.keys=function(){return w(this,function(g){return g.key})};b.prototype.values=function(){return w(this,function(g){return g.value})};b.prototype.forEach=function(g,d){for(var a=this.entries(),u;!(u=a.next()).done;)u=u.value,g.call(d,u[1],u[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var a=function(g,d){var a=d&&typeof d;"object"==
a||"function"==a?l.has(d)?a=l.get(d):(a=""+ ++G,l.set(d,a)):a="p_"+d;var u=g.data_[a];if(u&&$jscomp.owns(g.data_,a))for(g=0;g<u.length;g++){var t=u[g];if(d!==d&&t.key!==t.key||d===t.key)return{id:a,list:u,index:g,entry:t}}return{id:a,list:u,index:-1,entry:void 0}},w=function(g,d){var a=g.head_;return $jscomp.iteratorPrototype(function(){if(a){for(;a.head!=g.head_;)a=a.previous;for(;a.next!=a.head;)return a=a.next,{done:!1,value:d(a)};a=null}return{done:!0,value:void 0}})},e=function(){var g={};return g.previous=
g.next=g.head=g},G=0;return b},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h,l){return l})}},"es8","es3");$jscomp.findInternal=function(h,p,l){h instanceof String&&(h=String(h));for(var b=h.length,a=0;a<b;a++){var w=h[a];if(p.call(l,w,a,h))return{i:a,v:w}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(h){return h?h:function(h,l){return $jscomp.findInternal(this,h,l).v}},"es6","es3");
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(h){function p(){this.batch_=null}function l(e){return e instanceof a?e:new a(function(a,g){a(e)})}if(h&&!$jscomp.FORCE_POLYFILL_PROMISE)return h;p.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};p.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var b=$jscomp.global.setTimeout;p.prototype.asyncExecuteFunction=function(a){b(a,
0)};p.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var g=a[b];a[b]=null;try{g()}catch(d){this.asyncThrow_(d)}}}this.batch_=null};p.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var a=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var e=this.createResolveAndReject_();try{a(e.resolve,e.reject)}catch(g){e.reject(g)}};a.prototype.createResolveAndReject_=
function(){function a(d){return function(a){g||(g=!0,d.call(b,a))}}var b=this,g=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};a.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof a)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var b=null!=e;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};a.prototype.resolveToNonPromiseObj_=function(a){var e=
void 0;try{e=a.then}catch(g){this.reject_(g);return}"function"==typeof e?this.settleSameAsThenable_(e,a):this.fulfill_(a)};a.prototype.reject_=function(a){this.settle_(2,a)};a.prototype.fulfill_=function(a){this.settle_(1,a)};a.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)w.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var w=new p;a.prototype.settleSameAsPromise_=function(a){var e=this.createResolveAndReject_();a.callWhenSettled_(e.resolve,e.reject)};a.prototype.settleSameAsThenable_=function(a,b){var g=this.createResolveAndReject_();try{a.call(b,g.resolve,g.reject)}catch(d){g.reject(d)}};a.prototype.then=function(e,b){function g(a,c){return"function"==typeof a?function(c){try{d(a(c))}catch(E){z(E)}}:
c}var d,z,u=new a(function(a,c){d=a;z=c});this.callWhenSettled_(g(e,d),g(b,z));return u};a.prototype.catch=function(a){return this.then(void 0,a)};a.prototype.callWhenSettled_=function(a,b){function g(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?w.asyncExecute(g):this.onSettledCallbacks_.push(g)};a.resolve=l;a.reject=function(e){return new a(function(a,g){g(e)})};a.race=function(e){return new a(function(a,
g){for(var d=$jscomp.makeIterator(e),z=d.next();!z.done;z=d.next())l(z.value).callWhenSettled_(a,g)})};a.all=function(e){var b=$jscomp.makeIterator(e),g=b.next();return g.done?l([]):new a(function(a,e){function d(f){return function(g){t[f]=g;c--;0==c&&a(t)}}var t=[],c=0;do t.push(void 0),c++,l(g.value).callWhenSettled_(d(t.length-1),e),g=b.next();while(!g.done)})};return a},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(h,p){for(var l=1;l<arguments.length;l++){var b=arguments[l];if(b)for(var a in b)$jscomp.owns(b,a)&&(h[a]=b[a])}return h};$jscomp.polyfill("Object.assign",function(h){return h||$jscomp.assign},"es6","es3");$jscomp.underscoreProtoCanBeSet=function(){var h={a:!0},p={};try{return p.__proto__=h,p.a}catch(l){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(h,p){h.__proto__=p;if(h.__proto__!==p)throw new TypeError(h+" is not extensible");return h}:null;$jscomp.polyfill("Object.setPrototypeOf",function(h){return h||$jscomp.setPrototypeOf},"es6","es5");
var Erizo=function(h){function p(b){if(l[b])return l[b].exports;var a=l[b]={i:b,l:!1,exports:{}};return h[b].call(a.exports,a,a.exports,p),a.l=!0,a.exports}var l={};return p.m=h,p.c=l,p.d=function(b,a,w){p.o(b,a)||Object.defineProperty(b,a,{enumerable:!0,get:w})},p.r=function(b){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"});Object.defineProperty(b,"__esModule",{value:!0})},p.t=function(b,a){if((1&a&&(b=p(b)),8&a)||4&a&&"object"==typeof b&&
b&&b.__esModule)return b;var w=Object.create(null);if(p.r(w),Object.defineProperty(w,"default",{enumerable:!0,value:b}),2&a&&"string"!=typeof b)for(var e in b)p.d(w,e,function(a){return b[a]}.bind(null,e));return w},p.n=function(b){var a=b&&b.__esModule?function(){return b.default}:function(){return b};return p.d(a,"a",a),a},p.o=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)},p.p="",p(p.s=34)}([function(h,p,l){function b(a){if(!(a=function(a){if(Array.isArray(a)){for(var e=0,g=Array(a.length);e<
a.length;e++)g[e]=a[e];return g}}(a)||function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}(a)))throw new TypeError("Invalid attempt to spread non-iterable instance");return a}var a=function(){var w="";var e=function(a){var g;(g=console).log.apply(g,b(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(e){var g=e;e>a.NONE?g=a.NONE:e<a.DEBUG&&(g=a.DEBUG);a.logLevel=g},setOutputFunction:function(a){e=
a},setLogPrefix:function(a){w=a},log:function(b){var g=w;if(!(b<a.logLevel)){b===a.DEBUG?g="".concat(g,"DEBUG"):b===a.TRACE?g="".concat(g,"TRACE"):b===a.INFO?g="".concat(g,"INFO"):b===a.WARNING?g="".concat(g,"WARNING"):b===a.ERROR&&(g="".concat(g,"ERROR"));g="".concat(g,": ");for(var d=arguments.length,z=Array(1<d?d-1:0),u=1;u<d;u++)z[u-1]=arguments[u];g=[g].concat(z);if(void 0!==a.panel){d="";for(z=0;z<g.length;z+=1)d+=g[z];a.panel.value="".concat(a.panel.value,"\n").concat(d)}else e.apply(a,[g])}},
debug:function(){for(var e=arguments.length,g=Array(e),d=0;d<e;d++)g[d]=arguments[d];a.log.apply(a,[a.DEBUG].concat(g))},trace:function(){for(var e=arguments.length,g=Array(e),d=0;d<e;d++)g[d]=arguments[d];a.log.apply(a,[a.TRACE].concat(g))},info:function(){for(var e=arguments.length,g=Array(e),d=0;d<e;d++)g[d]=arguments[d];a.log.apply(a,[a.INFO].concat(g))},warning:function(){for(var e=arguments.length,g=Array(e),d=0;d<e;d++)g[d]=arguments[d];a.log.apply(a,[a.WARNING].concat(g))},error:function(){for(var e=
arguments.length,g=Array(e),d=0;d<e;d++)g[d]=arguments[d];a.log.apply(a,[a.ERROR].concat(g))}}}();p.a=a},function(h,p,l){p=l(20);var b=l(8),a=l(9),w=l(10),e=l(11),G=l(12),g=l(4),d=l(14),z=l(15),u=l(16),t=l(17);l=l(6);h.exports={SDPInfo:p,CandidateInfo:b,CodecInfo:a,DTLSInfo:w,ICEInfo:e,MediaInfo:G,Setup:g,SourceGroupInfo:d,SourceInfo:z,StreamInfo:u,TrackInfo:t,Direction:l}},function(h,p,l){(function(b){var a=l(0),w=function(){var a="none";return void 0!==b&&b.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?
a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari"),a};p.a={GetUserMedia:function(e){var h,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},z=function(a,g,c){navigator.mediaDevices.getUserMedia(a).then(g).catch(c)};
e.screen?function(){switch(a.a.debug("Screen access requested"),w()){case "electron":a.a.debug("Screen sharing in Electron");(h={}).video=e.video||{};h.video.mandatory=e.video.mandatory||{};h.video.mandatory.chromeMediaSource="desktop";h.video.mandatory.chromeMediaSourceId=e.desktopStreamId;z(h,g,d);break;case "mozilla":a.a.debug("Screen sharing in Firefox");h={};void 0!==e.video?(h.video=e.video,h.video.mediaSource||(h.video.mediaSource="window")):h={audio:e.audio,video:{mediaSource:"window"}};z(h,
g,d);break;case "chrome-stable":if(a.a.debug("Screen sharing in Chrome"),h={},App&&App.isDesktop)chrome.desktopCapture.chooseDesktopMedia(["screen","window"],function(a){console.log("opening stream with id",a);z({video:{mandatory:{chromeMediaSourceId:a,chromeMediaSource:"desktop"}}},g,d)});else if(e.desktopStreamId)h.video=e.video||{mandatory:{}},h.video.mandatory=h.video.mandatory||{},h.video.mandatory.chromeMediaSource="desktop",h.video.mandatory.chromeMediaSourceId=e.desktopStreamId,z(h,g,d);else{var u=
"okeephmleflklcdebijnponpabbmmgeo";e.extensionId&&(a.a.debug("extensionId supplied, using ".concat(e.extensionId)),u=e.extensionId);a.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(u,{getStream:!0},function(t){void 0!==t?(t=t.streamId,void 0!==e.video.mandatory?(h.video=e.video||{mandatory:{}},h.video.mandatory.chromeMediaSource="desktop",h.video.mandatory.chromeMediaSourceId=t):h={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t}}},
z(h,g,d)):(a.a.error("Access to screen denied"),d({code:"Access to screen denied"}))})}catch(t){a.a.debug("Screensharing plugin is not accessible "),d({code:"no_plugin_present"})}}break;default:a.a.error("This browser does not support ScreenSharing")}}():void 0!==b&&b.exports?a.a.error("Video/audio streams not supported in erizofc yet"):(a.a.debug("Calling getUserMedia with config",e),z(e,g,d))},getBrowser:w}}).call(this,l(27)(h))},function(h,p,l){var b=l(5)("SEND","RECV");b.byValue=function(a){return b[a.toUpperCase()]};
b.toString=function(a){switch(a){case b.SEND:return"send";case b.RECV:return"recv";default:return"unknown"}};b.reverse=function(a){switch(a){case b.SEND:return b.RECV;default:return b.SEND}};h.exports=b},function(h,p,l){var b=l(5)("ACTIVE","PASSIVE","ACTPASS","INACTIVE");b.byValue=function(a){return b[a.toUpperCase()]};b.toString=function(a){switch(a){case b.ACTIVE:return"active";case b.PASSIVE:return"passive";case b.ACTPASS:return"actpass";case b.INACTIVE:return"inactive";default:return null}};b.reverse=
function(a){switch(a){case b.ACTIVE:return b.PASSIVE;case b.PASSIVE:return b.ACTIVE;case b.ACTPASS:return b.PASSIVE;case b.INACTIVE:return b.INACTIVE;default:return b.ACTIVE}};h.exports=b},function(h,p){h.exports=function b(){for(var a=this,h=arguments.length,e=Array(h),G=0;G<h;G++)e[G]=arguments[G];if(!(this instanceof b))return new (Function.prototype.bind.apply(b,[null].concat(Array.prototype.slice.call(e))));Array.from(e).forEach(function(g){a[g]=Symbol.for("LICODE_SEMANTIC_SDP_".concat(g))})}},
function(h,p,l){var b=l(5)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");b.byValue=function(a){return b[a.toUpperCase()]};b.toString=function(a){switch(a){case b.SENDRECV:return"sendrecv";case b.SENDONLY:return"sendonly";case b.RECVONLY:return"recvonly";case b.INACTIVE:return"inactive";default:return"unknown"}};b.reverse=function(a){switch(a){case b.SENDRECV:return b.SENDRECV;case b.SENDONLY:return b.RECVONLY;case b.RECVONLY:return b.SENDONLY;case b.INACTIVE:return b.INACTIVE;default:return b.SENDRECV}};
h.exports=b},function(h,p){var l=h.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,
names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(b){return b.encoding?"rtpmap:%d %s/%s/%s":b.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,
names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(b){return null!=b.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(b){return null!=
b.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(b){return"extmap:%d"+(b.direction?"/%s":"%v")+" %s"+(b.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(b){return null!=b.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",
reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},
{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),format:function(b){var a="candidate:%s %d %s %d %s %d typ %s";return a+=null!=b.raddr?" raddr %s rport %d":"%v%v",a+=null!=b.tcptype?" tcptype %s":"%v",null!=b.generation&&(a+=
" generation %d"),a+=null!=b["network-id"]?" network-id %d":"%v",a+(null!=b["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(b){var a="ssrc:%d";return null!=b.attribute&&(a+=" %s",null!=b.value&&(a+=
":%s")),a}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber",
"app","maxMessageSize"],format:function(b){return null!=b.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(b){return b.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,
names:["pt","dir1","attrs1","dir2","attrs2"],format:function(b){return"imageattr:%s %s %s"+(b.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(b){return"simulcast:%s %s"+(b.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},
{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{push:"invalid",names:["value"]}]};Object.keys(l).forEach(function(b){l[b].forEach(function(a){a.reg||(a.reg=/(.*)/);a.format||(a.format="%s")})})},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,
e.key,e)}}p=function(){function b(a,h,e,l,g,d,z,u,t,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.foundation=a;this.componentId=h;this.transport=e;this.priority=l;this.address=g;this.port=d;this.type=z;this.generation=u;this.relAddr=t;this.relPort=c}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){return new b(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,
this.relAddr,this.relPort)}},{key:"plain",value:function(){var a={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};return this.relAddr&&(a.relAddr=this.relAddr),this.relPort&&(a.relPort=this.relPort),a}},{key:"getFoundation",value:function(){return this.foundation}},{key:"getComponentId",value:function(){return this.componentId}},{key:"getTransport",value:function(){return this.transport}},
{key:"getPriority",value:function(){return this.priority}},{key:"getAddress",value:function(){return this.address}},{key:"getPort",value:function(){return this.port}},{key:"getType",value:function(){return this.type}},{key:"getGeneration",value:function(){return this.generation}},{key:"getRelAddr",value:function(){return this.relAddr}},{key:"getRelPort",value:function(){return this.relPort}}]),b}();h.exports=p},function(h,p){function l(a,b){for(var e=0;e<b.length;e++){var h=b[e];h.enumerable=h.enumerable||
!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}var b=function(){function a(b,e,h,g,d,z){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!0;this.codec=b;this.type=e;this.rate=h;this.encoding=g;this.params=d||{};this.feedback=z||[]}return function(a,e,b){e&&l(a.prototype,e);b&&l(a,b)}(a,[{key:"clone",value:function(){var b=new a(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);return this.rtx&&b.setRTX(this.rtx),
b}},{key:"plain",value:function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,feedback:this.feedback}}},{key:"setRTX",value:function(a){this.rtx=a}},{key:"getType",value:function(){return this.type}},{key:"setType",value:function(a){this.type=a}},{key:"getCodec",value:function(){return this.codec}},{key:"getParams",value:function(){return this.params}},{key:"setParam",value:function(a,e){this.params[a]=e}},{key:"hasRTX",value:function(){return this.rtx}},
{key:"getRTX",value:function(){return this.rtx}},{key:"getRate",value:function(){return this.rate}},{key:"getEncoding",value:function(){return this.encoding}},{key:"getFeedback",value:function(){return this.feedback}}]),a}();b.mapFromNames=function(a,h){var e=new Map,l=96;return a.forEach(function(a){a=a.toLowerCase();var d="pcmu"===a?0:"pcma"===a?8:l+=1;d=new b(a,d);h&&"ulpfec"!==a&&"flexfec-03"!==a&&"red"!==a&&(l+=1,d.setRTX(l));e.set(d.getCodec().toLowerCase(),d)}),e};h.exports=b},function(h,p,
l){function b(a,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}var a=l(4);p=function(){function h(a,b,g){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");!0;this.setup=a;this.hash=b;this.fingerprint=g}return function(a,h,g){h&&b(a.prototype,h);g&&b(a,g)}(h,[{key:"clone",value:function(){return new h(this.setup,this.hash,this.fingerprint)}},{key:"plain",value:function(){return{setup:a.toString(this.setup),
hash:this.hash,fingerprint:this.fingerprint}}},{key:"getFingerprint",value:function(){return this.fingerprint}},{key:"getHash",value:function(){return this.hash}},{key:"getSetup",value:function(){return this.setup}},{key:"setSetup",value:function(a){this.setup=a}}]),h}();h.exports=p},function(h,p){function l(a,b){for(var g=0;g<b.length;g++){var d=b[g];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function b(a){a=new Uint8Array(a);for(var e=
0;e<a.length;e+=1)a[e]=Math.floor(256*Math.random());return a}function a(a){return Array.prototype.map.call(new Uint8Array(a),function(a){a=a.toString(16);return"00".concat(a).slice(-2)}).join("")}var w=function(){function a(b,g,d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!0;this.ufrag=b;this.pwd=g;this.opts=d;this.endOfCandidates=this.lite=!1}return function(a,g,d){g&&l(a.prototype,g);d&&l(a,d)}(a,[{key:"clone",value:function(){var b=new a(this.ufrag,this.pwd,
this.opts);return b.setLite(this.lite),b.setEndOfCandidates(this.endOfCandidates),b}},{key:"plain",value:function(){var a={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(a.lite=this.lite),this.endOfCandidates&&(a.endOfCandidates=this.endOfCandidates),a}},{key:"getUfrag",value:function(){return this.ufrag}},{key:"getPwd",value:function(){return this.pwd}},{key:"isLite",value:function(){return this.lite}},{key:"getOpts",value:function(){return this.opts}},{key:"setLite",value:function(a){this.lite=
a}},{key:"isEndOfCandidates",value:function(){return this.endOfCandidates}},{key:"setEndOfCandidates",value:function(a){this.endOfCandidates=a}}]),a}();w.generate=function(){var e=new w,h=b(8),g=b(24);return e.ufrag=a(h),e.pwd=a(g),e};h.exports=w},function(h,p,l){function b(a,g){for(var d=0;d<g.length;d++){var b=g[d];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}var a=l(13),w=l(6),e=l(3);p=function(){function h(a,d,b){if(!(this instanceof
h))throw new TypeError("Cannot call a class as a function");!0;this.id=a;this.type=b;this.port=d;this.direction=w.SENDRECV;this.extensions=new Map;this.codecs=new Map;this.rids=new Map;this.simulcast_03=this.simulcast=null;this.bitrate=0;this.connection=this.dtls=this.ice=null;this.candidates=[]}return function(a,d,e){d&&b(a.prototype,d);e&&b(a,e)}(h,[{key:"clone",value:function(){var a=new h(this.id,this.port,this.type);return a.setDirection(this.direction),a.setBitrate(this.bitrate),a.setConnection(this.connection),
this.codecs.forEach(function(d){a.addCodec(d.clone())}),this.extensions.forEach(function(d,g){a.addExtension(g,d)}),this.rids.forEach(function(d,g){a.addRID(g,d.clone())}),this.simulcast&&a.setSimulcast(this.simulcast.clone()),this.xGoogleFlag&&a.setXGoogleFlag(this.xGoogleFlag),this.ice&&a.setICE(this.ice.clone()),this.dtls&&a.setDTLS(this.dtls.clone()),this.candidates.forEach(function(d){a.addCandidate(d.clone())}),this.setup&&a.setSetup(this.setup),a}},{key:"plain",value:function(){var a={id:this.id,
port:this.port,type:this.type,connection:this.connection,direction:w.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],candidates:[]};return this.bitrate&&(a.bitrate=this.bitrate),this.codecs.forEach(function(d){a.codecs.push(d.plain())}),this.extensions.forEach(function(d){a.extensions.push(d.plain())}),this.rids.forEach(function(d){a.rids.push(d.plain())}),this.simulcast&&(a.simulcast=this.simulcast.plain()),this.candidates.forEach(function(d){a.candidates.push(d.plain())}),
a.ice=this.ice&&this.ice.plain(),a.dtls=this.dtls&&this.dtls.plain(),a}},{key:"getType",value:function(){return this.type}},{key:"getPort",value:function(){return this.port}},{key:"getId",value:function(){return this.id}},{key:"addExtension",value:function(a,d){this.extensions.set(a,d)}},{key:"addRID",value:function(a){this.rids.set(a.getId(),a)}},{key:"addCodec",value:function(a){this.codecs.set(a.getType(),a)}},{key:"getCodecForType",value:function(a){return this.codecs.get(a)}},{key:"getCodec",
value:function(a){var d;return this.codecs.forEach(function(g){g.getCodec().toLowerCase()===a.toLowerCase()&&(d=g)}),d}},{key:"hasCodec",value:function(a){return null!==this.getCodec(a)}},{key:"getCodecs",value:function(){return this.codecs}},{key:"getExtensions",value:function(){return this.extensions}},{key:"getRIDs",value:function(){return this.rids}},{key:"getRID",value:function(a){return this.rids.get(a)}},{key:"getBitrate",value:function(){return this.bitrate}},{key:"setBitrate",value:function(a){this.bitrate=
a}},{key:"getDirection",value:function(){return this.direction}},{key:"setDirection",value:function(a){this.direction=a}},{key:"getDTLS",value:function(){return this.dtls}},{key:"setDTLS",value:function(a){this.dtls=a}},{key:"getICE",value:function(){return this.ice}},{key:"setICE",value:function(a){this.ice=a}},{key:"addCandidate",value:function(a){this.candidates.push(a)}},{key:"addCandidates",value:function(a){var d=this;a.forEach(function(a){d.addCandidate(a)})}},{key:"getCandidates",value:function(){return this.candidates}},
{key:"setXGoogleFlag",value:function(a){this.xGoogleFlag=a}},{key:"getXGoogleFlag",value:function(){return this.xGoogleFlag}},{key:"getConnection",value:function(){return this.connection}},{key:"setConnection",value:function(a){this.connection=a}},{key:"answer",value:function(g){var d=new h(this.id,this.port,this.type);if(d.setDirection(w.reverse(this.direction)),g.codecs&&this.codecs.forEach(function(a){if(g.codecs.has(a.getCodec().toLowerCase())){var c=g.codecs.get(a.getCodec().toLowerCase()).clone();
c.setType(a.getType());c.hasRTX()&&c.setRTX(a.getRTX());d.addCodec(c)}}),this.extensions.forEach(function(a,c){g.extensions.has(c)&&d.addExtension(c,a)}),g.simulcast&&this.simulcast){var b=new a,u=this.simulcast.getSimulcastStreams(e.SEND);u&&u.forEach(function(a){var c=[];a.forEach(function(a){c.push(a.clone())});b.addSimulcastAlternativeStreams(e.RECV,c)});(u=this.simulcast.getSimulcastStreams(e.RECV))&&u.forEach(function(a){var c=[];a.forEach(function(a){c.push(a.clone())});b.addSimulcastAlternativeStreams(e.SEND,
c)});this.rids.forEach(function(a){var c=a.clone();c.setDirection(e.reverse(a.getDirection()));d.addRID(c)});d.setSimulcast(b)}return d}},{key:"getSimulcast",value:function(){return this.simulcast}},{key:"setSimulcast",value:function(a){this.simulcast=a}},{key:"getSimulcast03",value:function(){return this.simulcast_03}},{key:"setSimulcast03",value:function(a){this.simulcast_03=a}},{key:"getSetup",value:function(){return this.setup}},{key:"setSetup",value:function(a){this.setup=a}}]),h}();h.exports=
p},function(h,p,l){function b(a,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}var a=l(3);p=function(){function h(){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");!0;this.send=[];this.recv=[];this.plainString=null}return function(a,h,g){h&&b(a.prototype,h);g&&b(a,g)}(h,[{key:"clone",value:function(){var a=new h;return this.send.forEach(function(b){var g=[];b.forEach(function(a){g.push(a.clone())});
a.addSimulcastAlternativeStreams(g)}),this.recv.forEach(function(b){var g=[];b.forEach(function(a){g.push(a.clone())});a.addSimulcastAlternativeStreams(g)}),a}},{key:"plain",value:function(){var a={send:[],recv:[]};return this.send.forEach(function(b){var g=[];b.forEach(function(a){g.push(a.plain())});a.send.push(g)}),this.recv.forEach(function(b){var g=[];b.forEach(function(a){g.push(a.plain())});a.recv.push(g)}),a}},{key:"addSimulcastAlternativeStreams",value:function(b,h){return b===a.SEND?this.send.push(h):
this.recv.push(h)}},{key:"addSimulcastStream",value:function(b,h){return b===a.SEND?this.send.push([h]):this.recv.push([h])}},{key:"getSimulcastStreams",value:function(b){return b===a.SEND?this.send:this.recv}},{key:"setSimulcastPlainString",value:function(a){this.plainString=a}},{key:"getSimulcastPlainString",value:function(){return this.plainString}}]),h}();h.exports=p},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in
e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a,h){var e=this;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.semantics=a;this.ssrcs=[];h.forEach(function(a){e.ssrcs.push(parseInt(a,10))})}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){return new b(this.semantics,this.ssrcs)}},{key:"plain",value:function(){var a={semantics:this.semantics,ssrcs:[]};return a.ssrcs=this.ssrcs,a}},{key:"getSemantics",
value:function(){return this.semantics}},{key:"getSSRCs",value:function(){return this.ssrcs}}]),b}();h.exports=p},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.ssrc=a}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){var a=
new b(this.ssrc);a.setCName(this.cname);a.setStreamId(this.streamId);this.setTrackId(this.trackId)}},{key:"plain",value:function(){var a={ssrc:this.ssrc};return this.cname&&(a.cname=this.cname),this.label&&(a.label=this.label),this.mslabel&&(a.mslabel=this.mslabel),this.streamId&&(a.streamId=this.streamId),this.trackId&&(a.trackid=this.trackId),a}},{key:"getCName",value:function(){return this.cname}},{key:"setCName",value:function(a){this.cname=a}},{key:"getStreamId",value:function(){return this.streamId}},
{key:"setStreamId",value:function(a){this.streamId=a}},{key:"getTrackId",value:function(){return this.trackId}},{key:"setTrackId",value:function(a){this.trackId=a}},{key:"getMSLabel",value:function(){return this.mslabel}},{key:"setMSLabel",value:function(a){this.mslabel=a}},{key:"getLabel",value:function(){return this.label}},{key:"setLabel",value:function(a){this.label=a}},{key:"getSSRC",value:function(){return this.ssrc}}]),b}();h.exports=p},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=
a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.id=a;this.tracks=new Map}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){var a=new b(this.id);return this.tracks.forEach(function(b){a.addTrack(b.clone())}),a}},{key:"plain",value:function(){var a={id:this.id,tracks:[]};return this.tracks.forEach(function(b){a.tracks.push(b.plain())}),
a}},{key:"getId",value:function(){return this.id}},{key:"addTrack",value:function(a){this.tracks.set(a.getId(),a)}},{key:"getFirstTrack",value:function(a){var b;return this.tracks.forEach(function(e){e.getMedia().toLowerCase()===a.toLowerCase()&&(b=e)}),b}},{key:"getTracks",value:function(){return this.tracks}},{key:"removeAllTracks",value:function(){this.tracks.clear()}},{key:"getTrack",value:function(a){return this.tracks.get(a)}}]),b}();h.exports=p},function(h,p){function l(b,a){for(var h=0;h<
a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a,h){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.media=a;this.id=h;this.ssrcs=[];this.groups=[];this.encodings=[]}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){var a=new b(this.media,this.id);return this.mediaId&&a.setMediaId(this.mediaId),this.ssrcs.forEach(function(b){a.addSSRC(b)}),
this.groups.forEach(function(b){a.addSourceGroup(b.clone())}),this.encodings.forEach(function(b){var e=[];b.forEach(function(a){e.push(a.cloned())});a.addAlternativeEncoding(e)}),a}},{key:"plain",value:function(){var a={media:this.media,id:this.id,ssrcs:[],groups:[],encodings:[]};return this.mediaId&&(a.mediaId=this.mediaId),this.ssrcs.forEach(function(b){a.ssrcs.push(b)}),this.groups.forEach(function(b){a.groups.push(b.plain())}),this.encodings.forEach(function(b){var e=[];b.forEach(function(a){e.push(a.plain())});
a.encodings.push(e)}),a}},{key:"getMedia",value:function(){return this.media}},{key:"setMediaId",value:function(a){this.mediaId=a}},{key:"getMediaId",value:function(){return this.mediaId}},{key:"getId",value:function(){return this.id}},{key:"addSSRC",value:function(a){this.ssrcs.push(a)}},{key:"getSSRCs",value:function(){return this.ssrcs}},{key:"addSourceGroup",value:function(a){this.groups.push(a)}},{key:"getSourceGroup",value:function(a){var b;return this.groups.forEach(function(e){e.getSemantics().toLowerCase()===
a.toLowerCase()&&(b=e)}),b}},{key:"getSourceGroups",value:function(){return this.groups}},{key:"hasSourceGroup",value:function(a){var b=!1;return this.groups.forEach(function(e){e.getSemantics().toLowerCase()===a.toLowerCase()&&(b=!0)}),b}},{key:"getEncodings",value:function(){return this.encodings}},{key:"addAlternaticeEncodings",value:function(a){this.encodings.push(a)}},{key:"setEncodings",value:function(a){this.encodings=a}}]),b}();h.exports=p},function(h,p){p=function(){return this}();try{p=
p||Function("return this")()||(0,eval)("this")}catch(l){"object"==typeof window&&(p=window)}h.exports=p},function(h,p,l){(function(b){function a(g){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(g)}var h,e,l;!function(g,d){"object"==a(p)&&"object"==a(b)?b.exports=d():(e=[],void 0===(l="function"==typeof(h=d)?h.apply(p,e):h)||(b.exports=
l))}(0,function(){return function(a){function d(b){if(g[b])return g[b].exports;var t=g[b]={exports:{},id:b,loaded:!1};return a[b].call(t.exports,t,t.exports,d),t.loaded=!0,t.exports}var g={};return d.m=a,d.c=g,d.p="",d(0)}([function(g,d,b){function u(a,f){"object"===(void 0===a?"undefined":t(a))&&(f=a,a=void 0);f=f||{};var d;a=c(a);var q=a.source,k=a.id,y=a.path;y=v[k]&&y in v[k].nsps;return f.forceNew||f["force new connection"]||!1===f.multiplex||y?(m("ignoring socket cache for %s",q),d=E(q,f)):
(v[k]||(m("new io instance for %s",q),v[k]=E(q,f)),d=v[k]),a.query&&!f.query&&(f.query=a.query),d.socket(a.path,f)}var t="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(c){return a(c)}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":a(c)},c=b(1),f=b(7),E=b(13),m=b(3)("socket.io-client");g.exports=d=u;var v=d.managers={};d.protocol=f.protocol;d.connect=u;d.Manager=b(13);d.Socket=b(39)},function(a,d,b){(function(d){var g=b(2),c=
b(3)("socket.io-client:url");a.exports=function(a,b){var f=a;b=b||d.location;null==a&&(a=b.protocol+"//"+b.host);"string"==typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?b.protocol+a:b.host+a),/^(https?|wss?):\/\//.test(a)||(c("protocol-less url %s",a),a=void 0!==b?b.protocol+"//"+a:"https://"+a),c("parse %s",a),f=g(a));f.port||(/^(http|ws)$/.test(f.protocol)?f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port="443"));f.path=f.path||"/";a=-1!==f.host.indexOf(":")?"["+f.host+"]":f.host;return f.id=
f.protocol+"://"+a+":"+f.port,f.href=f.protocol+"://"+a+(b&&b.port===f.port?"":":"+f.port),f}}).call(d,function(){return this}())},function(a,d){var b=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,g="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
a.exports=function(a){var c=a,f=a.indexOf("["),d=a.indexOf("]");-1!=f&&-1!=d&&(a=a.substring(0,f)+a.substring(f,d).replace(/:/g,";")+a.substring(d,a.length));a=b.exec(a||"");for(var m={},t=14;t--;)m[g[t]]=a[t]||"";return-1!=f&&-1!=d&&(m.source=c,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=!0),m}},function(b,d,e){(function(g){function t(){try{var a=d.storage.debug}catch(m){}return!a&&void 0!==g&&"env"in
g&&(a=g.env.DEBUG),a}(d=b.exports=e(5)).log=function(){return"object"==("undefined"==typeof console?"undefined":a(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(a){var c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+d.humanize(this.diff),c){c="color: "+this.color;a.splice(1,0,c,"color: inherit");var f=0,b=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&"%c"===a&&(b=++f)});a.splice(b,0,c)}};d.save=
function(a){try{null==a?d.storage.removeItem("debug"):d.storage.debug=a}catch(m){}};d.load=t;d.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&
navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var c=d;if("undefined"!=typeof chrome&&void 0!==chrome.storage)var f=chrome.storage.local;else a:{try{f=window.localStorage;break a}catch(E){}f=void 0}c.storage=f;d.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");d.formatters.j=function(a){try{return JSON.stringify(a)}catch(m){return"[UnexpectedJSONParseError]: "+
m.message}};d.enable(t())}).call(d,e(4))},function(a,d){function b(){throw Error("setTimeout has not been defined");}function g(){throw Error("clearTimeout has not been defined");}function t(a){if(v===setTimeout)return setTimeout(a,0);if((v===b||!v)&&setTimeout)return v=setTimeout,setTimeout(a,0);try{return v(a,0)}catch(x){try{return v.call(null,a,0)}catch(B){return v.call(this,a,0)}}}function c(){q&&n&&(q=!1,n.length?r=n.concat(r):k=-1,r.length&&f())}function f(){if(!q){var a=t(c);q=!0;for(var f=
r.length;f;){n=r;for(r=[];++k<f;)n&&n[k].run();k=-1;f=r.length}n=null;q=!1;(function(a){if(e===clearTimeout)return clearTimeout(a);if((e===g||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(a);try{e(a)}catch(I){try{return e.call(null,a)}catch(H){return e.call(this,a)}}})(a)}}function E(a,k){this.fun=a;this.array=k}function m(){}a=a.exports={};try{var v="function"==typeof setTimeout?setTimeout:b}catch(y){v=b}try{var e="function"==typeof clearTimeout?clearTimeout:g}catch(y){e=g}!0;var n,r=[],q=
!1,k=-1;a.nextTick=function(a){var k=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)k[c-1]=arguments[c];r.push(new E(a,k));1!==r.length||q||t(f)};E.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=m;a.addListener=m;a.once=m;a.off=m;a.removeListener=m;a.removeAllListeners=m;a.emit=m;a.prependListener=m;a.prependOnceListener=m;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");
};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(a,d,b){function g(a){function c(){if(c.enabled){var a=+new Date;c.diff=a-(t||a);c.prev=t;t=c.curr=a;var f=Array(arguments.length);for(a=0;a<f.length;a++)f[a]=arguments[a];f[0]=d.coerce(f[0]);"string"!=typeof f[0]&&f.unshift("%O");var b=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,function(a,m){if("%%"===a)return a;b++;m=d.formatters[m];"function"==typeof m&&(a=m.call(c,f[b]),
f.splice(b,1),b--);return a});d.formatArgs.call(c,f);(c.log||d.log||console.log.bind(console)).apply(c,f)}}return c.namespace=a,c.enabled=d.enabled(a),c.useColors=d.useColors(),c.color=function(a){var c,f=0;for(c in a)f=(f<<5)-f+a.charCodeAt(c),f|=0;return d.colors[Math.abs(f)%d.colors.length]}(a),"function"==typeof d.init&&d.init(c),c}var t;(d=a.exports=g.debug=g.default=g).coerce=function(a){return a instanceof Error?a.stack||a.message:a};d.disable=function(){d.enable("")};d.enable=function(a){d.save(a);
d.names=[];d.skips=[];for(var c=("string"==typeof a?a:"").split(/[\s,]+/),b=c.length,m=0;m<b;m++)c[m]&&("-"===(a=c[m].replace(/\*/g,".*?"))[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$")))};d.enabled=function(a){var c;var b=0;for(c=d.skips.length;b<c;b++)if(d.skips[b].test(a))return!1;b=0;for(c=d.names.length;b<c;b++)if(d.names[b].test(a))return!0;return!1};d.humanize=b(6);d.names=[];d.skips=[];d.formatters={}},function(b,d){function g(a){return u(a,e,"day")||
u(a,f,"hour")||u(a,c,"minute")||u(a,t,"second")||a+" ms"}function u(a,c,f){if(!(a<c))return a<1.5*c?Math.floor(a/c)+" "+f:Math.ceil(a/c)+" "+f+"s"}var t=1E3,c=60*t,f=60*c,e=24*f,m=365.25*e;b.exports=function(d,b){b=b||{};var n=a(d);if("string"===n&&0<d.length)return function(a){if(!(100<(a=String(a)).length)&&(a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a))){var q=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return q*
m;case "days":case "day":case "d":return q*e;case "hours":case "hour":case "hrs":case "hr":case "h":return q*f;case "minutes":case "minute":case "mins":case "min":case "m":return q*c;case "seconds":case "second":case "secs":case "sec":case "s":return q*t;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return q}}}(d);if("number"===n&&!1===isNaN(d))return b.long?g(d):d>=e?Math.round(d/e)+"d":d>=f?Math.round(d/f)+"h":d>=c?Math.round(d/c)+"m":d>=t?Math.round(d/t)+"s":d+"ms";
throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(d));}},function(a,d,b){function g(){}function t(a){var c=""+a.type;return d.BINARY_EVENT!==a.type&&d.BINARY_ACK!==a.type||(c+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(c+=a.nsp+","),null!=a.id&&(c+=a.id),null!=a.data&&(c+=JSON.stringify(a.data)),m("encoded %j as %s",a,c),c}function c(){this.reconstructor=null}function f(a){this.reconPack=a;this.buffers=[]}function e(){return{type:d.ERROR,data:"parser error"}}var m=
b(3)("socket.io-parser");a=b(8);var v=b(9),h=b(11),n=b(12);d.protocol=4;d.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");d.CONNECT=0;d.DISCONNECT=1;d.EVENT=2;d.ACK=3;d.ERROR=4;d.BINARY_EVENT=5;d.BINARY_ACK=6;d.Encoder=g;d.Decoder=c;g.prototype.encode=function(a,c){(a.type!==d.EVENT&&a.type!==d.ACK||!v(a.data)||(a.type=a.type===d.EVENT?d.BINARY_EVENT:d.BINARY_ACK),m("encoding packet %j",a),d.BINARY_EVENT===a.type||d.BINARY_ACK===a.type)?function(a,c){h.removeBlobs(a,
function(a){var k=h.deconstructPacket(a);a=t(k.packet);k=k.buffers;k.unshift(a);c(k)})}(a,c):c([t(a)])};a(c.prototype);c.prototype.add=function(a){if("string"==typeof a){var c=0;var k={type:Number(a.charAt(0))};if(null==d.types[k.type])c=e();else{if(d.BINARY_EVENT===k.type||d.BINARY_ACK===k.type){for(var b="";"-"!==a.charAt(++c)&&(b+=a.charAt(c),c!=a.length););if(b!=Number(b)||"-"!==a.charAt(c))throw Error("Illegal attachments");k.attachments=Number(b)}if("/"===a.charAt(c+1))for(k.nsp="";++c&&","!==
(x=a.charAt(c))&&(k.nsp+=x,c!==a.length););else k.nsp="/";b=a.charAt(c+1);if(""!==b&&Number(b)==b){for(k.id="";++c;){var x;if(null==(x=a.charAt(c))||Number(x)!=x){--c;break}if(k.id+=a.charAt(c),c===a.length)break}k.id=Number(k.id)}if(a.charAt(++c)){b:{x=k;c=a.substr(c);try{x.data=JSON.parse(c)}catch(B){c=e();break b}c=x}k=c}c=(m("decoded %s as %j",a,k),k)}d.BINARY_EVENT===c.type||d.BINARY_ACK===c.type?(this.reconstructor=new f(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):
this.emit("decoded",c)}else{if(!n(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(c=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,this.emit("decoded",c))}};c.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};f.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=h.reconstructPacket(this.reconPack,
this.buffers),this.finishedReconstruction(),a):null};f.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(a,d,b){function g(a){if(a){for(var c in g.prototype)a[c]=g.prototype[c];return a}}a.exports=g;g.prototype.on=g.prototype.addEventListener=function(a,c){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(c),this};g.prototype.once=function(a,c){function f(){this.off(a,f);c.apply(this,arguments)}return f.fn=
c,this.on(a,f),this};g.prototype.off=g.prototype.removeListener=g.prototype.removeAllListeners=g.prototype.removeEventListener=function(a,c){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var f=this._callbacks["$"+a];if(!f)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var d,b=0;b<f.length;b++)if((d=f[b])===c||d.fn===c){f.splice(b,1);break}return this};g.prototype.emit=function(a){this._callbacks=this._callbacks||{};var c=
[].slice.call(arguments,1),f=this._callbacks["$"+a];if(f)for(var d=0,b=(f=f.slice(0)).length;d<b;++d)f[d].apply(this,c);return this};g.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};g.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(b,d,e){(function(d){var g=e(10),c=Object.prototype.toString,f="function"==typeof d.Blob||"[object BlobConstructor]"===c.call(d.Blob),u="function"==typeof d.File||"[object FileConstructor]"===
c.call(d.File);b.exports=function A(c){if(!c||"object"!=a(c))return!1;if(g(c)){for(var b=0,r=c.length;b<r;b++)if(A(c[b]))return!0;return!1}if("function"==typeof d.Buffer&&d.Buffer.isBuffer&&d.Buffer.isBuffer(c)||"function"==typeof d.ArrayBuffer&&c instanceof ArrayBuffer||f&&c instanceof Blob||u&&c instanceof File)return!0;if(c.toJSON&&"function"==typeof c.toJSON&&1===arguments.length)return A(c.toJSON(),!0);for(b in c)if(Object.prototype.hasOwnProperty.call(c,b)&&A(c[b]))return!0;return!1}}).call(d,
function(){return this}())},function(a,d){var b={}.toString;a.exports=Array.isArray||function(a){return"[object Array]"==b.call(a)}},function(b,d,e){(function(b){var g=e(10),c=e(12),f=Object.prototype.toString,u="function"==typeof b.Blob||"[object BlobConstructor]"===f.call(b.Blob),m="function"==typeof b.File||"[object FileConstructor]"===f.call(b.File);d.deconstructPacket=function(f){var b=[];return f.data=function k(f,q){if(!f)return f;if(c(f)){var b={_placeholder:!0,num:q.length};return q.push(f),
b}if(g(f)){b=Array(f.length);for(var d=0;d<f.length;d++)b[d]=k(f[d],q);return b}if("object"==a(f)&&!(f instanceof Date)){for(d in b={},f)b[d]=k(f[d],q);return b}return f}(f.data,b),f.attachments=b.length,{packet:f,buffers:b}};d.reconstructPacket=function(c,f){return c.data=function k(c,f){if(!c)return c;if(c&&c._placeholder)return f[c.num];if(g(c))for(var q=0;q<c.length;q++)c[q]=k(c[q],f);else if("object"==a(c))for(q in c)c[q]=k(c[q],f);return c}(c.data,f),c.attachments=void 0,c};d.removeBlobs=function(f,
b){var d=0,t=f;(function B(k,f,x){if(!k)return k;if(u&&k instanceof Blob||m&&k instanceof File){d++;var y=new FileReader;y.onload=function(){x?x[f]=this.result:t=this.result;--d||b(t)};y.readAsArrayBuffer(k)}else if(g(k))for(y=0;y<k.length;y++)B(k[y],y,k);else if("object"==a(k)&&!c(k))for(y in k)B(k[y],y,k)})(t);d||b(t)}}).call(d,function(){return this}())},function(a,b){(function(b){a.exports=function(a){return b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer}}).call(b,function(){return this}())},
function(b,d,e){function g(a,c){if(!(this instanceof g))return new g(a,c);a&&"object"===(void 0===a?"undefined":t(a))&&(c=a,a=void 0);(c=c||{}).path=c.path||"/socket.io";this.nsps={};this.subs=[];this.opts=c;this.reconnection(!1!==c.reconnection);this.reconnectionAttempts(c.reconnectionAttempts||1/0);this.reconnectionDelay(c.reconnectionDelay||1E3);this.reconnectionDelayMax(c.reconnectionDelayMax||5E3);this.randomizationFactor(c.randomizationFactor||.5);this.backoff=new r({min:this.reconnectionDelay(),
max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==c.timeout?2E4:c.timeout);this.readyState="closed";this.uri=a;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];a=c.parser||h;this.encoder=new a.Encoder;this.decoder=new a.Decoder;(this.autoConnect=!1!==c.autoConnect)&&this.open()}var t="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(c){return a(c)}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&
c!==Symbol.prototype?"symbol":a(c)},c=e(14),f=e(39);d=e(8);var h=e(7),m=e(41),v=e(42),A=e(3)("socket.io-client:manager"),n=e(37),r=e(43),q=Object.prototype.hasOwnProperty;b.exports=g;g.prototype.emitAll=function(){for(var a in this.emit.apply(this,arguments),this.nsps)q.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};g.prototype.updateSocketIds=function(){for(var a in this.nsps)q.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};g.prototype.generateId=function(a){return("/"===
a?"":a+"#")+this.engine.id};d(g.prototype);g.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};g.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts};g.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay};g.prototype.randomizationFactor=function(a){return arguments.length?
(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor};g.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax};g.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout};g.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};g.prototype.open=
g.prototype.connect=function(a,f){if(A("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;A("opening %s",this.uri);var k=this.engine=c(this.uri,this.opts),q=this;this.readyState="opening";this.skipReconnect=!1;var b=m(k,"open",function(){q.onopen();a&&a()});f=m(k,"error",function(c){if(A("connect_error"),q.cleanup(),q.readyState="closed",q.emitAll("connect_error",c),a){var k=Error("Connection error");k.data=c;a(k)}else q.maybeReconnectOnOpen()});if(!1!==this._timeout){var d=
this._timeout;A("connect attempt will timeout after %d",d);var g=setTimeout(function(){A("connect attempt timed out after %d",d);b.destroy();k.close();k.emit("error","timeout");q.emitAll("connect_timeout",d)},d);this.subs.push({destroy:function(){clearTimeout(g)}})}return this.subs.push(b),this.subs.push(f),this};g.prototype.onopen=function(){A("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(m(a,"data",v(this,"ondata")));this.subs.push(m(a,"ping",v(this,
"onping")));this.subs.push(m(a,"pong",v(this,"onpong")));this.subs.push(m(a,"error",v(this,"onerror")));this.subs.push(m(a,"close",v(this,"onclose")));this.subs.push(m(this.decoder,"decoded",v(this,"ondecoded")))};g.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};g.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};g.prototype.ondata=function(a){this.decoder.add(a)};g.prototype.ondecoded=function(a){this.emit("packet",a)};g.prototype.onerror=function(a){A("error",
a);this.emitAll("error",a)};g.prototype.socket=function(a,c){function k(){~n(b.connecting,q)||b.connecting.push(q)}var q=this.nsps[a];if(!q){q=new f(this,a,c);this.nsps[a]=q;var b=this;q.on("connecting",k);q.on("connect",function(){q.id=b.generateId(a)});this.autoConnect&&k()}return q};g.prototype.destroy=function(a){a=n(this.connecting,a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};g.prototype.packet=function(a){A("writing packet %j",a);var c=this;a.query&&0===a.type&&(a.nsp+=
"?"+a.query);c.encoding?c.packetBuffer.push(a):(c.encoding=!0,this.encoder.encode(a,function(k){for(var f=0;f<k.length;f++)c.engine.write(k[f],a.options);c.encoding=!1;c.processPacketQueue()}))};g.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};g.prototype.cleanup=function(){A("cleanup");for(var a=this.subs.length,c=0;c<a;c++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;
this.decoder.destroy()};g.prototype.close=g.prototype.disconnect=function(){A("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};g.prototype.onclose=function(a){A("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};g.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;
var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)A("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var c=this.backoff.duration();A("will wait %dms before reconnect attempt",c);this.reconnecting=!0;var f=setTimeout(function(){a.skipReconnect||(A("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(c){c?(A("reconnect attempt error"),a.reconnecting=
!1,a.reconnect(),a.emitAll("reconnect_error",c.data)):(A("reconnect success"),a.onreconnect())}))},c);this.subs.push({destroy:function(){clearTimeout(f)}})}};g.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},function(a,b,e){a.exports=e(15)},function(a,b,e){a.exports=e(16);a.exports.parser=e(23)},function(b,d,e){(function(d){function g(c,k){if(!(this instanceof g))return new g(c,k);k=k||{};c&&
"object"==a(c)&&(k=c,c=null);c?(c=u(c),k.hostname=c.host,k.secure="https"===c.protocol||"wss"===c.protocol,k.port=c.port,c.query&&(k.query=c.query)):k.host&&(k.hostname=u(k.host).host);this.secure=null!=k.secure?k.secure:d.location&&"https:"===location.protocol;k.hostname&&!k.port&&(k.port=this.secure?"443":"80");this.agent=k.agent||!1;this.hostname=k.hostname||(d.location?location.hostname:"localhost");this.port=k.port||(d.location&&location.port?location.port:this.secure?443:80);this.query=k.query||
{};"string"==typeof this.query&&(this.query=r.decode(this.query));this.upgrade=!1!==k.upgrade;this.path=(k.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!k.forceJSONP;this.jsonp=!1!==k.jsonp;this.forceBase64=!!k.forceBase64;this.enablesXDR=!!k.enablesXDR;this.timestampParam=k.timestampParam||"t";this.timestampRequests=k.timestampRequests;this.transports=k.transports||["polling","websocket"];this.transportOptions=k.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=
0;this.policyPort=k.policyPort||843;this.rememberUpgrade=k.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=k.onlyBinaryUpgrades;this.perMessageDeflate=!1!==k.perMessageDeflate&&(k.perMessageDeflate||{});!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=k.pfx||null;this.key=k.key||null;this.passphrase=k.passphrase||null;this.cert=k.cert||null;this.ca=k.ca||null;this.ciphers=
k.ciphers||null;this.rejectUnauthorized=void 0===k.rejectUnauthorized||k.rejectUnauthorized;this.forceNode=!!k.forceNode;c="object"==a(d)&&d;c.global===c&&(k.extraHeaders&&0<Object.keys(k.extraHeaders).length&&(this.extraHeaders=k.extraHeaders),k.localAddress&&(this.localAddress=k.localAddress));this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var c=e(17),f=e(8),h=e(3)("engine.io-client:socket"),m=e(37),v=e(23),u=e(2),n=e(38),r=
e(31);b.exports=g;g.priorWebsocketSuccess=!1;f(g.prototype);g.protocol=v.protocol;g.Socket=g;g.Transport=e(22);g.transports=e(17);g.parser=e(23);g.prototype.createTransport=function(a){h('creating transport "%s"',a);var k=this.query,f={},q;for(q in k)k.hasOwnProperty(q)&&(f[q]=k[q]);f.EIO=v.protocol;f.transport=a;k=this.transportOptions[a]||{};return this.id&&(f.sid=this.id),new c[a]({query:f,socket:this,agent:k.agent||this.agent,hostname:k.hostname||this.hostname,port:k.port||this.port,secure:k.secure||
this.secure,path:k.path||this.path,forceJSONP:k.forceJSONP||this.forceJSONP,jsonp:k.jsonp||this.jsonp,forceBase64:k.forceBase64||this.forceBase64,enablesXDR:k.enablesXDR||this.enablesXDR,timestampRequests:k.timestampRequests||this.timestampRequests,timestampParam:k.timestampParam||this.timestampParam,policyPort:k.policyPort||this.policyPort,pfx:k.pfx||this.pfx,key:k.key||this.key,passphrase:k.passphrase||this.passphrase,cert:k.cert||this.cert,ca:k.ca||this.ca,ciphers:k.ciphers||this.ciphers,rejectUnauthorized:k.rejectUnauthorized||
this.rejectUnauthorized,perMessageDeflate:k.perMessageDeflate||this.perMessageDeflate,extraHeaders:k.extraHeaders||this.extraHeaders,forceNode:k.forceNode||this.forceNode,localAddress:k.localAddress||this.localAddress,requestTimeout:k.requestTimeout||this.requestTimeout,protocols:k.protocols||void 0})};g.prototype.open=function(){if(this.rememberUpgrade&&g.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var c=this;return void setTimeout(function(){c.emit("error",
"No transports available")},0)}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(y){return this.transports.shift(),void this.open()}a.open();this.setTransport(a)};g.prototype.setTransport=function(a){h("setting transport %s",a.name);var c=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){c.onDrain()}).on("packet",function(a){c.onPacket(a)}).on("error",function(a){c.onError(a)}).on("close",
function(){c.onClose("transport close")})};g.prototype.probe=function(a){function c(){if(t.onlyBinaryUpgrades){var c=!this.supportsBinary&&t.transport.supportsBinary;n=n||c}n||(h('probe transport "%s" opened',a),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(c){if(!n)if("pong"===c.type&&"probe"===c.data){if(h('probe transport "%s" pong',a),t.upgrading=!0,t.emit("upgrading",r),r)g.priorWebsocketSuccess="websocket"===r.name,h('pausing current transport "%s"',t.transport.name),t.transport.pause(function(){n||
"closed"!==t.readyState&&(h("changing transport and sending upgrade packet"),e(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emit("upgrade",r),r=null,t.upgrading=!1,t.flush())})}else h('probe transport "%s" failed',a),c=Error("probe error"),c.transport=r.name,t.emit("upgradeError",c)}))}function f(){n||(n=!0,e(),r.close(),r=null)}function b(c){var k=Error("probe error: "+c);k.transport=r.name;f();h('probe transport "%s" failed because of error: %s',a,c);t.emit("upgradeError",k)}function q(){b("transport closed")}
function d(){b("socket closed")}function m(a){r&&a.name!==r.name&&(h('"%s" works - aborting "%s"',a.name,r.name),f())}function e(){r.removeListener("open",c);r.removeListener("error",b);r.removeListener("close",q);t.removeListener("close",d);t.removeListener("upgrading",m)}h('probing transport "%s"',a);var r=this.createTransport(a,{probe:1}),n=!1,t=this;g.priorWebsocketSuccess=!1;r.once("open",c);r.once("error",b);r.once("close",q);this.once("close",d);this.once("upgrading",m);r.open()};g.prototype.onOpen=
function(){if(h("socket open"),this.readyState="open",g.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])}};g.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",
a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(n(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var c=Error("server error");c.code=a.data;this.onError(c);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)};g.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=
a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};g.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var c=this;c.pingTimeoutTimer=setTimeout(function(){"closed"!==c.readyState&&c.onClose("ping timeout")},a||c.pingInterval+c.pingTimeout)};g.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",
a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};g.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};g.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};g.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),
this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};g.prototype.write=g.prototype.send=function(a,c,f){return this.sendPacket("message",a,c,f),this};g.prototype.sendPacket=function(a,c,f,b){if("function"==typeof c&&(b=c,c=void 0),"function"==typeof f&&(b=f,f=null),"closing"!==this.readyState&&"closed"!==this.readyState)(f=f||{}).compress=!1!==f.compress,a={type:a,data:c,options:f},this.emit("packetCreate",a),this.writeBuffer.push(a),b&&this.once("flush",
b),this.flush()};g.prototype.close=function(){function a(){b.onClose("forced close");h("socket closing - telling transport to close");b.transport.close()}function c(){b.removeListener("upgrade",c);b.removeListener("upgradeError",c);a()}function f(){b.once("upgrade",c);b.once("upgradeError",c)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var b=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?f():a()}):this.upgrading?f():a()}return this};
g.prototype.onError=function(a){h("socket error %j",a);g.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};g.prototype.onClose=function(a,c){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)h('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=
null,this.emit("close",a,c),this.writeBuffer=[],this.prevBufferLen=0};g.prototype.filterUpgrades=function(a){for(var c=[],f=0,b=a.length;f<b;f++)~m(this.transports,a[f])&&c.push(a[f]);return c}}).call(d,function(){return this}())},function(a,b,e){(function(a){var d=e(18),c=e(20),f=e(34),g=e(35);b.polling=function(b){var g=!1,m=!1,e=!1!==b.jsonp;a.location&&(m="https:"===location.protocol,(g=location.port)||(g=m?443:80),g=b.hostname!==location.hostname||g!==b.port,m=b.secure!==m);if(b.xdomain=g,b.xscheme=
m,"open"in new d(b)&&!b.forceJSONP)return new c(b);if(!e)throw Error("JSONP disabled");return new f(b)};b.websocket=g}).call(b,function(){return this}())},function(a,b,e){(function(b){var d=e(19);a.exports=function(a){var c=a.xdomain,g=a.xscheme;a=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!c||d))return new XMLHttpRequest}catch(m){}try{if("undefined"!=typeof XDomainRequest&&!g&&a)return new XDomainRequest}catch(m){}if(!c)try{return new (b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(m){}}}).call(b,
function(){return this}())},function(a,b){try{a.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(z){a.exports=!1}},function(a,b,e){(function(b){function d(){}function c(a){if(h.call(this,a),this.requestTimeout=a.requestTimeout,this.extraHeaders=a.extraHeaders,b.location){var c="https:"===location.protocol,f=location.port;f||(f=c?443:80);this.xd=a.hostname!==b.location.hostname||f!==a.port;this.xs=a.secure!==c}}function f(a){this.method=a.method||"GET";this.uri=
a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function g(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&
f.requests[a].abort()}var m=e(18),h=e(21),u=e(8),n=e(32),r=e(3)("engine.io-client:polling-xhr");a.exports=c;a.exports.Request=f;n(c,h);c.prototype.supportsBinary=!0;c.prototype.request=function(a){return(a=a||{}).uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=
this.requestTimeout,a.extraHeaders=this.extraHeaders,new f(a)};c.prototype.doWrite=function(a,c){a=this.request({method:"POST",data:a,isBinary:"string"!=typeof a&&void 0!==a});var f=this;a.on("success",c);a.on("error",function(a){f.onError("xhr post error",a)});this.sendXhr=a};c.prototype.doPoll=function(){r("xhr poll");var a=this.request(),c=this;a.on("data",function(a){c.onData(a)});a.on("error",function(a){c.onError("xhr poll error",a)});this.pollXhr=a};u(f.prototype);f.prototype.create=function(){var a=
{agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new m(a),d=this;try{r("xhr open %s: %s",this.method,this.uri);c.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var g in c.setDisableHeaderCheck&&c.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(g)&&c.setRequestHeader(g,
this.extraHeaders[g])}catch(B){}if("POST"===this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type","text/plain;charset\x3dUTF-8")}catch(B){}try{c.setRequestHeader("Accept","*/*")}catch(B){}"withCredentials"in c&&(c.withCredentials=!0);this.requestTimeout&&(c.timeout=this.requestTimeout);this.hasXDR()?(c.onload=function(){d.onLoad()},c.onerror=function(){d.onError(c.responseText)}):c.onreadystatechange=function(){if(2===c.readyState){try{var a=
c.getResponseHeader("Content-Type")}catch(I){}"application/octet-stream"===a&&(c.responseType="arraybuffer")}4===c.readyState&&(200===c.status||1223===c.status?d.onLoad():setTimeout(function(){d.onError(c.status)},0))};r("xhr data %s",this.data);c.send(this.data)}catch(B){return void setTimeout(function(){d.onError(B)},0)}b.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)};f.prototype.onSuccess=function(){this.emit("success");this.cleanup()};f.prototype.onData=function(a){this.emit("data",
a);this.onSuccess()};f.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};f.prototype.cleanup=function(a){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,a)try{this.xhr.abort()}catch(k){}b.document&&delete f.requests[this.index];this.xhr=null}};f.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(y){}var c="application/octet-stream"===a&&this.xhr.response||this.xhr.responseText}catch(y){this.onError(y)}null!=
c&&this.onData(c)};f.prototype.hasXDR=function(){return void 0!==b.XDomainRequest&&!this.xs&&this.enablesXDR};f.prototype.abort=function(){this.cleanup()};f.requestsCount=0;f.requests={};b.document&&(b.attachEvent?b.attachEvent("onunload",g):b.addEventListener&&b.addEventListener("beforeunload",g,!1))}).call(b,function(){return this}())},function(a,b,e){function d(a){var c=a&&a.forceBase64;v&&!c||(this.supportsBinary=!1);g.call(this,a)}var g=e(22),c=e(31),f=e(23);b=e(32);var h=e(33),m=e(3)("engine.io-client:polling");
a.exports=d;var v=null!=(new (e(18))({xdomain:!1})).responseType;b(d,g);d.prototype.name="polling";d.prototype.doOpen=function(){this.poll()};d.prototype.pause=function(a){function c(){m("paused");f.readyState="paused";a()}var f=this;if(this.readyState="pausing",this.polling||!this.writable){var b=0;this.polling&&(m("we are currently polling - waiting to pause"),b++,this.once("pollComplete",function(){m("pre-pause polling complete");--b||c()}));this.writable||(m("we are currently writing - waiting to pause"),
b++,this.once("drain",function(){m("pre-pause writing complete");--b||c()}))}else c()};d.prototype.poll=function(){m("polling");this.polling=!0;this.doPoll();this.emit("poll")};d.prototype.onData=function(a){var c=this;m("polling got data %s",a);f.decodePayload(a,this.socket.binaryType,function(a,f,b){return"opening"===c.readyState&&c.onOpen(),"close"===a.type?(c.onClose(),!1):void c.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():
m('ignoring poll - transport state "%s"',this.readyState))};d.prototype.doClose=function(){function a(){m("writing close packet");c.write([{type:"close"}])}var c=this;"open"===this.readyState?(m("transport open - closing"),a()):(m("transport not open - deferring close"),this.once("open",a))};d.prototype.write=function(a){var c=this;this.writable=!1;var b=function(){c.writable=!0;c.emit("drain")};f.encodePayload(a,this.supportsBinary,function(a){c.doWrite(a,b)})};d.prototype.uri=function(){var a=this.query||
{},f=this.secure?"https":"http",b="";return!1!==this.timestampRequests&&(a[this.timestampParam]=h()),this.supportsBinary||a.sid||(a.b64=1),a=c.encode(a),this.port&&("https"===f&&443!==Number(this.port)||"http"===f&&80!==Number(this.port))&&(b=":"+this.port),a.length&&(a="?"+a),f+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+b+this.path+a}},function(a,b,e){function d(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;
this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.forceNode=a.forceNode;this.extraHeaders=a.extraHeaders;this.localAddress=a.localAddress}var g=e(23);b=e(8);a.exports=d;b(d.prototype);d.prototype.onError=function(a,f){a=
Error(a);return a.type="TransportError",a.description=f,this.emit("error",a),this};d.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};d.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};d.prototype.send=function(a){if("open"!==this.readyState)throw Error("Transport not open");this.write(a)};d.prototype.onOpen=function(){this.readyState="open";
this.writable=!0;this.emit("open")};d.prototype.onData=function(a){a=g.decodePacket(a,this.socket.binaryType);this.onPacket(a)};d.prototype.onPacket=function(a){this.emit("packet",a)};d.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(a,b,e){(function(a){function d(a,c,f){if(!c)return b.encodeBase64Packet(a,f);if(k)return function(a,c,f){if(!c)return b.encodeBase64Packet(a,f);var k=new FileReader;return k.onload=function(){a.data=k.result;b.encodePacket(a,c,!0,f)},
k.readAsArrayBuffer(a.data)}(a,c,f);c=new Uint8Array(1);return c[0]=y[a.type],f(new l([c.buffer,a.data]))}function c(a,c,f){var b=Array(a.length);f=u(a.length,f);for(var k=function(a,f,k){c(f,function(c,f){b[a]=f;k(c,b)})},d=0;d<a.length;d++)k(d,a[d],f)}var f,g=e(24),m=e(9),h=e(25),u=e(26),n=e(27);a&&a.ArrayBuffer&&(f=e(29));var r="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),q="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),k=r||q;b.protocol=3;var y=b.packets=
{open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},x=g(y),B={type:"error",data:"parser error"},l=e(30);b.encodePacket=function(c,f,k,g){"function"==typeof f&&(g=f,f=!1);"function"==typeof k&&(g=k,k=null);var m=void 0===c.data?void 0:c.data.buffer||c.data;if(a.ArrayBuffer&&m instanceof ArrayBuffer){k=g;if(f){g=c.data;f=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=y[c.type];for(c=0;c<f.length;c++)g[c+1]=f[c];c=k(g.buffer)}else c=b.encodeBase64Packet(c,k);return c}if(l&&m instanceof
a.Blob)return d(c,f,g);if(m&&m.base64)return g("b"+b.packets[c.type]+c.data.data);f=y[c.type];return void 0!==c.data&&(f+=k?n.encode(String(c.data),{strict:!1}):String(c.data)),g(""+f)};b.encodeBase64Packet=function(c,f){var k="b"+b.packets[c.type];if(l&&c.data instanceof a.Blob){var d=new FileReader;return d.onload=function(){var a=d.result.split(",")[1];f(k+a)},d.readAsDataURL(c.data)}try{var g=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(N){c=new Uint8Array(c.data);g=Array(c.length);
for(var m=0;m<c.length;m++)g[m]=c[m];g=String.fromCharCode.apply(null,g)}return k+=a.btoa(g),f(k)};b.decodePacket=function(a,c,f){if(void 0===a)return B;if("string"==typeof a){if("b"===a.charAt(0))return b.decodeBase64Packet(a.substr(1),c);if(c=f){try{a=n.decode(a,{strict:!1})}catch(J){a=!1}c=!1===a}if(c)return B;f=a.charAt(0);return Number(f)==f&&x[f]?1<a.length?{type:x[f],data:a.substring(1)}:{type:x[f]}:B}f=(new Uint8Array(a))[0];a=h(a,1);return l&&"blob"===c&&(a=new l([a])),{type:x[f],data:a}};
b.decodeBase64Packet=function(a,c){var b=x[a.charAt(0)];if(!f)return{type:b,data:{base64:!0,data:a.substr(1)}};a=f.decode(a.substr(1));return"blob"===c&&l&&(a=new l([a])),{type:b,data:a}};b.encodePayload=function(a,f,d){"function"==typeof f&&(d=f,f=null);var g=m(a);return f&&g?l&&!k?b.encodePayloadAsBlob(a,d):b.encodePayloadAsArrayBuffer(a,d):a.length?void c(a,function(a,c){b.encodePacket(a,!!g&&f,!1,function(a){c(null,a.length+":"+a)})},function(a,c){return d(c.join(""))}):d("0:")};b.decodePayload=
function(a,c,f){if("string"!=typeof a)return b.decodePayloadAsBinary(a,c,f);var k;if("function"==typeof c&&(f=c,c=null),""===a)return f(B,0,1);for(var d,g,m="",e=0,q=a.length;e<q;e++){var r=a.charAt(e);if(":"===r){if(""===m||m!=(d=Number(m))||m!=(g=a.substr(e+1,d)).length)return f(B,0,1);if(g.length){if(k=b.decodePacket(g,c,!1),B.type===k.type&&B.data===k.data)return f(B,0,1);if(!1===f(k,e+d,q))return}e+=d;m=""}else m+=r}return""!==m?f(B,0,1):void 0};b.encodePayloadAsArrayBuffer=function(a,f){return a.length?
void c(a,function(a,c){b.encodePacket(a,!0,!0,function(a){return c(null,a)})},function(a,c){a=c.reduce(function(a,c){var f;return a+(f="string"==typeof c?c.length:c.byteLength).toString().length+f+2},0);var b=new Uint8Array(a),k=0;return c.forEach(function(a){var c="string"==typeof a,f=a;if(c){f=new Uint8Array(a.length);for(var d=0;d<a.length;d++)f[d]=a.charCodeAt(d);f=f.buffer}b[k++]=c?0:1;a=f.byteLength.toString();for(d=0;d<a.length;d++)b[k++]=parseInt(a[d]);b[k++]=255;f=new Uint8Array(f);for(d=
0;d<f.length;d++)b[k++]=f[d]}),f(b.buffer)}):f(new ArrayBuffer(0))};b.encodePayloadAsBlob=function(a,f){c(a,function(a,c){b.encodePacket(a,!0,!0,function(a){var f=new Uint8Array(1);if(f[0]=1,"string"==typeof a){for(var b=new Uint8Array(a.length),k=0;k<a.length;k++)b[k]=a.charCodeAt(k);a=b.buffer;f[0]=0}b=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var d=new Uint8Array(b.length+1);for(k=0;k<b.length;k++)d[k]=parseInt(b[k]);if(d[b.length]=255,l)a=new l([f.buffer,d.buffer,a]),c(null,a)})},
function(a,c){return f(new l(c))})};b.decodePayloadAsBinary=function(a,c,f){"function"==typeof c&&(f=c,c=null);for(var k=[];0<a.byteLength;){for(var d=new Uint8Array(a),g=0===d[0],m="",e=1;255!==d[e];e++){if(310<m.length)return f(B,0,1);m+=d[e]}a=h(a,2+m.length);m=parseInt(m);d=h(a,0,m);if(g)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(T){for(g=new Uint8Array(d),d="",e=0;e<g.length;e++)d+=String.fromCharCode(g[e])}k.push(d);a=h(a,m)}var q=k.length;k.forEach(function(a,k){f(b.decodePacket(a,
c,!0),k,q)})}}).call(b,function(){return this}())},function(a,b){a.exports=Object.keys||function(a){var b=[],d=Object.prototype.hasOwnProperty,c;for(c in a)d.call(a,c)&&b.push(c);return b}},function(a,b){a.exports=function(a,b,d){var c=a.byteLength;if(b=b||0,d=d||c,a.slice)return a.slice(b,d);if(0>b&&(b+=c),0>d&&(d+=c),d>c&&(d=c),b>=c||b>=d||0===c)return new ArrayBuffer(0);a=new Uint8Array(a);c=new Uint8Array(d-b);for(var f=0;b<d;b++,f++)c[f]=a[b];return c.buffer}},function(a,b){function d(){}a.exports=
function(a,b,c){function f(a,d){if(0>=f.count)throw Error("after called too many times");--f.count;a?(g=!0,b(a),b=c):0!==f.count||g||b(null,d)}var g=!1;return c=c||d,f.count=a,0===a?b():f}},function(b,d,e){var g;(function(b,c){!function(f){function e(a){for(var c,f,b=[],k=0,d=a.length;k<d;)55296<=(c=a.charCodeAt(k++))&&56319>=c&&k<d?56320==(64512&(f=a.charCodeAt(k++)))?b.push(((1023&c)<<10)+(1023&f)+65536):(b.push(c),k--):b.push(c);return b}function m(a,c){if(55296<=a&&57343>=a){if(c)throw Error("Lone surrogate U+"+
a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function h(){if(q>=r)throw Error("Invalid byte index");var a=255&n[q];if(q++,128==(192&a))return 63&a;throw Error("Invalid continuation byte");}function t(a){var c,f;if(q>r)throw Error("Invalid byte index");if(q==r)return!1;if(c=255&n[q],q++,0==(128&c))return c;if(192==(224&c)){if(128<=(f=(31&c)<<6|h()))return f;throw Error("Invalid continuation byte");}if(224==(240&c)){if(2048<=(f=(15&c)<<12|h()<<6|h()))return m(f,a)?f:65533;
throw Error("Invalid continuation byte");}if(240==(248&c)&&65536<=(f=(7&c)<<18|h()<<12|h()<<6|h())&&1114111>=f)return f;throw Error("Invalid UTF-8 detected");}a(d);f=("object"==a(b)&&b&&b.exports,"object"==a(c)&&c);f.global!==f&&f.window;var n,r,q,k=String.fromCharCode;void 0===(g={version:"2.1.2",encode:function(a,c){c=!1!==(c||{}).strict;a=e(a);for(var f=a.length,b=-1,d="";++b<f;){var g=a[b];var q=c;if(0==(4294967168&g))q=k(g);else{var r="";q=(0==(4294965248&g)?r=k(g>>6&31|192):0==(4294901760&g)?
(m(g,q)||(g=65533),r=k(g>>12&15|224),r+=k(g>>6&63|128)):0==(4292870144&g)&&(r=k(g>>18&7|240),r+=k(g>>12&63|128),r+=k(g>>6&63|128)),r+k(63&g|128))}d+=q}return d},decode:function(a,c){c=!1!==(c||{}).strict;n=e(a);r=n.length;q=0;var f;for(a=[];!1!==(f=t(c));)a.push(f);var b;c=a.length;f=-1;for(var d="";++f<c;)65535<(b=a[f])&&(d+=k((b-=65536)>>>10&1023|55296),b=56320|1023&b),d+=k(b);return d}})||(b.exports=g)}()}).call(d,e(28)(b),function(){return this}())},function(a,b){a.exports=function(a){return a.webpackPolyfill||
(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b){!function(){for(var a=new Uint8Array(256),d=0;64>d;d++)a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(d)]=d;b.encode=function(a){var c=new Uint8Array(a),f=c.length,b="";for(a=0;a<f;a+=3)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c[a]>>2],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&c[a])<<4|c[a+1]>>4],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&
c[a+1])<<2|c[a+2]>>6],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&c[a+2]];return 2==f%3?b=b.substring(0,b.length-1)+"\x3d":1==f%3&&(b=b.substring(0,b.length-2)+"\x3d\x3d"),b};b.decode=function(b){var c=.75*b.length;var f=b.length,d=0;"\x3d"===b[b.length-1]&&(c--,"\x3d"===b[b.length-2]&&c--);var g=new ArrayBuffer(c),e=new Uint8Array(g);for(c=0;c<f;c+=4){var h=a[b.charCodeAt(c)];var n=a[b.charCodeAt(c+1)];var r=a[b.charCodeAt(c+2)];var q=a[b.charCodeAt(c+3)];e[d++]=h<<2|
n>>4;e[d++]=(15&n)<<4|r>>2;e[d++]=(3&r)<<6|63&q}return g}}()},function(a,b){(function(b){function d(a){for(var c=0;c<a.length;c++){var f=a[c];if(f.buffer instanceof ArrayBuffer){var b=f.buffer;if(f.byteLength!==b.byteLength){var k=new Uint8Array(f.byteLength);k.set(new Uint8Array(b,f.byteOffset,f.byteLength));b=k.buffer}a[c]=b}}}function g(a,c){c=c||{};var b=new f;d(a);for(var g=0;g<a.length;g++)b.append(a[g]);return c.type?b.getBlob(c.type):b.getBlob()}function c(a,c){return d(a),new Blob(a,c||{})}
var f=b.BlobBuilder||b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder;try{var e=2===(new Blob(["hi"])).size}catch(A){e=!1}var m;if(m=e)try{m=2===(new Blob([new Uint8Array([1,2])])).size}catch(A){m=!1}var h=f&&f.prototype.append&&f.prototype.getBlob;a.exports=e?m?b.Blob:c:h?g:void 0}).call(b,function(){return this}())},function(a,b){b.encode=function(a){var b="",d;for(d in a)a.hasOwnProperty(d)&&(b.length&&(b+="\x26"),b+=encodeURIComponent(d)+"\x3d"+encodeURIComponent(a[d]));return b};b.decode=
function(a){var b={};a=a.split("\x26");for(var d=0,c=a.length;d<c;d++){var f=a[d].split("\x3d");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},function(a,b){a.exports=function(a,b){var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a}},function(a,b){function d(a){var b="";do b=c[a%f]+b,a=Math.floor(a/f);while(0<a);return b}function g(){var a=d(+new Date);return a!==e?(m=0,e=a):a+"."+d(m++)}for(var e,c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
f=64,h={},m=0,v=0;v<f;v++)h[c[v]]=v;g.encode=d;g.decode=function(a){var c=0;for(v=0;v<a.length;v++)c=c*f+h[a.charAt(v)];return c};a.exports=g},function(a,b,e){(function(b){function d(){}function c(a){f.call(this,a);this.query=this.query||{};m||(b.___eio||(b.___eio=[]),m=b.___eio);this.index=m.length;var c=this;m.push(function(a){c.onData(a)});this.query.j=this.index;b.document&&b.addEventListener&&b.addEventListener("beforeunload",function(){c.script&&(c.script.onerror=d)},!1)}var f=e(21),g=e(32);
a.exports=c;var m,h=/\n/g,l=/\\n/g;g(c,f);c.prototype.supportsBinary=!1;c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null);f.prototype.doClose.call(this)};c.prototype.doPoll=function(){var a=this,c=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);c.async=!0;c.src=this.uri();c.onerror=function(c){a.onError("jsonp poll error",
c)};var b=document.getElementsByTagName("script")[0];b?b.parentNode.insertBefore(c,b):(document.head||document.body).appendChild(c);this.script=c;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};c.prototype.doWrite=function(a,c){function b(){f();c()}function f(){if(d.iframe)try{d.form.removeChild(d.iframe)}catch(K){d.onError("jsonp polling iframe removal error",
K)}try{g=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+d.iframeId+'"\x3e')}catch(K){(g=document.createElement("iframe")).name=d.iframeId,g.src="javascript:0"}g.id=d.iframeId;d.form.appendChild(g);d.iframe=g}var d=this;if(!this.form){var g,e=document.createElement("form"),m=document.createElement("textarea"),r=this.iframeId="eio_iframe_"+this.index;e.className="socketio";e.style.position="absolute";e.style.top="-1000px";e.style.left="-1000px";e.target=r;e.method="POST";e.setAttribute("accept-charset",
"utf-8");m.name="d";e.appendChild(m);document.body.appendChild(e);this.form=e;this.area=m}this.form.action=this.uri();f();a=a.replace(l,"\\\n");this.area.value=a.replace(h,"\\n");try{this.form.submit()}catch(K){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===d.iframe.readyState&&b()}:this.iframe.onload=b}}).call(b,function(){return this}())},function(a,b,e){(function(b){function d(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;
this.usingBrowserWebSocket=n&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(q=r);c.call(this,a)}var c=e(22),f=e(23),g=e(31),m=e(32),h=e(33),l=e(3)("engine.io-client:websocket"),n=b.WebSocket||b.MozWebSocket;if("undefined"==typeof window)try{var r=e(36)}catch(k){}var q=n;q||"undefined"!=typeof window||(q=r);a.exports=d;m(d,c);d.prototype.name="websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),c=this.protocols,b={agent:this.agent,
perMessageDeflate:this.perMessageDeflate};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(b.headers=this.extraHeaders);this.localAddress&&(b.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?c?new q(a,c):new q(a):new q(a,c,b)}catch(B){return this.emit("error",B)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?
(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(c){a.onData(c.data)};this.ws.onerror=function(c){a.onError("websocket error",c)}};d.prototype.write=function(a){var c=this;this.writable=!1;for(var d=a.length,k=0,g=d;k<g;k++)!function(a){f.encodePacket(a,c.supportsBinary,function(f){if(!c.usingBrowserWebSocket){var k=
{};(a.options&&(k.compress=a.options.compress),c.perMessageDeflate)&&("string"==typeof f?b.Buffer.byteLength(f):f.length)<c.perMessageDeflate.threshold&&(k.compress=!1)}try{c.usingBrowserWebSocket?c.ws.send(f):c.ws.send(f,k)}catch(J){l("websocket closed before onclose event")}--d||(c.emit("flush"),setTimeout(function(){c.writable=!0;c.emit("drain")},0))})}(a[k])};d.prototype.onClose=function(){c.prototype.onClose.call(this)};d.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()};d.prototype.uri=
function(){var a=this.query||{},c=this.secure?"wss":"ws",b="";return this.port&&("wss"===c&&443!==Number(this.port)||"ws"===c&&80!==Number(this.port))&&(b=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=h()),this.supportsBinary||(a.b64=1),(a=g.encode(a)).length&&(a="?"+a),c+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+b+this.path+a};d.prototype.check=function(){return!(!q||"__initialize"in q&&this.name===d.prototype.name)}}).call(b,function(){return this}())},
function(a,b){},function(a,b){var d=[].indexOf;a.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},function(a,b){(function(b){var d=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,c=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,e=/^\s+/,m=/\s+$/;a.exports=function(a){return"string"==typeof a&&a?(a=a.replace(e,"").replace(m,""),b.JSON&&JSON.parse?JSON.parse(a):d.test(a.replace(g,"@").replace(c,
"]").replace(f,""))?(new Function("return "+a))():void 0):null}}).call(b,function(){return this}())},function(b,d,e){function g(a,c,b){this.io=a;this.nsp=c;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;b&&b.query&&(this.query=b.query);this.io.autoConnect&&this.open()}var h="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(c){return a(c)}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&
c!==Symbol.prototype?"symbol":a(c)},c=e(7);d=e(8);var f=e(40),E=e(41),m=e(42),v=e(3)("socket.io-client:socket"),l=e(31);b.exports=g;var n={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},r=d.prototype.emit;d(g.prototype);g.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[E(a,"open",m(this,"onopen")),E(a,"packet",m(this,"onpacket")),E(a,"close",m(this,
"onclose"))]}};g.prototype.open=g.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)};g.prototype.send=function(){var a=f(arguments);return a.unshift("message"),this.emit.apply(this,a),this};g.prototype.emit=function(a){if(n.hasOwnProperty(a))return r.apply(this,arguments),this;var b=f(arguments),d={type:c.EVENT,data:b,options:{}};return d.options.compress=!this.flags||!1!==this.flags.compress,
"function"==typeof b[b.length-1]&&(v("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),delete this.flags,this};g.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};g.prototype.onopen=function(){if(v("transport is open - connecting"),"/"!==this.nsp)if(this.query){var a="object"===h(this.query)?l.encode(this.query):this.query;v("sending connect packet with query %s",a);this.packet({type:c.CONNECT,
query:a})}else this.packet({type:c.CONNECT})};g.prototype.onclose=function(a){v("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};g.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case c.CONNECT:this.onconnect();break;case c.EVENT:case c.BINARY_EVENT:this.onevent(a);break;case c.ACK:case c.BINARY_ACK:this.onack(a);break;case c.DISCONNECT:this.ondisconnect();break;case c.ERROR:this.emit("error",a.data)}};g.prototype.onevent=function(a){var c=
a.data||[];v("emitting event %j",c);null!=a.id&&(v("attaching ack callback to event"),c.push(this.ack(a.id)));this.connected?r.apply(this,c):this.receiveBuffer.push(c)};g.prototype.ack=function(a){var b=this,d=!1;return function(){if(!d){d=!0;var k=f(arguments);v("sending ack %j",k);b.packet({type:c.ACK,id:a,data:k})}}};g.prototype.onack=function(a){var c=this.acks[a.id];"function"==typeof c?(v("calling ack %s with %j",a.id,a.data),c.apply(this,a.data),delete this.acks[a.id]):v("bad ack %s",a.id)};
g.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};g.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)r.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};g.prototype.ondisconnect=function(){v("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};g.prototype.destroy=function(){if(this.subs){for(var a=
0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};g.prototype.close=g.prototype.disconnect=function(){return this.connected&&(v("performing disconnect (%s)",this.nsp),this.packet({type:c.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this};g.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},function(a,b){a.exports=function(a,b){for(var d=[],c=(b=b||0)||0;c<a.length;c++)d[c-b]=a[c];return d}},
function(a,b){a.exports=function(a,b,d){return a.on(b,d),{destroy:function(){a.removeListener(b,d)}}}},function(a,b){var d=[].slice;a.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw Error("bind() requires a function");var c=d.call(arguments,2);return function(){return b.apply(a,c.concat(d.call(arguments)))}}},function(a,b){function d(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=
0}a.exports=d;d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)};d.prototype.reset=function(){this.attempts=0};d.prototype.setMin=function(a){this.ms=a};d.prototype.setMax=function(a){this.max=a};d.prototype.setJitter=function(a){this.jitter=a}}])})}).call(this,l(28)(h))},function(h,p,l){function b(a,c){for(var b=0;b<c.length;b++){var f=
c[b];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}function a(a,b,f){var d=b.simulcast["dir".concat(a)];a=b.simulcast["list".concat(a)];if(d){var k=c.byValue(d);w.parseSimulcastStreamList(a).forEach(function(a){var c=[];a.forEach(function(a){c.push(new r(a.scid,a.paused))});f.addSimulcastAlternativeStreams(k,c)})}}var w=l(21),e=l(8),G=l(9),g=l(10),d=l(11),z=l(12),u=l(4),t=l(6),c=l(3),f=l(14),E=l(15),m=l(16),v=l(17),A=l(24),n=l(13),r=
l(25),q=l(26),k=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!0;this.version=c||1;this.name="sdp-semantic";this.streams=new Map;this.medias=[];this.candidates=[];this.dtls=this.ice=this.connection=null}return function(a,c,f){c&&b(a.prototype,c);f&&b(a,f)}(a,[{key:"clone",value:function(){var c=new a(this.version);return c.name=this.name,c.setConnection(this.connection),this.medias.forEach(function(a){c.addMedia(a.clone())}),this.streams.forEach(function(a){c.addStream(a.clone())}),
this.candidates.forEach(function(a){c.addCandidate(a.clone())}),c.setICE(this.ice.clone()),c.setDTLS(this.dtls.clone()),c}},{key:"plain",value:function(){var a={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};return this.medias.forEach(function(c){a.medias.push(c.plain())}),this.streams.forEach(function(c){a.streams.push(c.plain())}),this.candidates.forEach(function(c){a.candidates.push(c.plain())}),a.ice=this.ice&&this.ice.plain(),a.dtls=this.dtls&&
this.dtls.plain(),a}},{key:"setVersion",value:function(a){this.version=a}},{key:"setOrigin",value:function(a){this.origin=a}},{key:"setName",value:function(a){this.name=a}},{key:"getConnection",value:function(){return this.connection}},{key:"setConnection",value:function(a){this.connection=a}},{key:"setTiming",value:function(a){this.timing=a}},{key:"addMedia",value:function(a){this.medias.push(a)}},{key:"getMedia",value:function(a){var c;return this.medias.forEach(function(b){b.getType().toLowerCase()===
a.toLowerCase()&&(c=b)}),c}},{key:"getMedias",value:function(a){if(!a)return this.medias;var c=[];return this.medias.forEach(function(b){b.getType().toLowerCase()===a.toLowerCase()&&c.push(b)}),c}},{key:"getMediaById",value:function(a){var c;return this.medias.forEach(function(b){b.getId().toLowerCase()===a.toLowerCase()&&(c=b)}),c}},{key:"getVersion",value:function(){return this.version}},{key:"getDTLS",value:function(){return this.dtls}},{key:"setDTLS",value:function(a){this.dtls=a}},{key:"getICE",
value:function(){return this.ice}},{key:"setICE",value:function(a){this.ice=a}},{key:"addCandidate",value:function(a){this.candidates.push(a)}},{key:"addCandidates",value:function(a){var c=this;a.forEach(function(a){c.addCandidate(a)})}},{key:"getCandidates",value:function(){return this.candidates}},{key:"getStream",value:function(a){return this.streams.get(a)}},{key:"getStreams",value:function(){return this.streams}},{key:"getFirstStream",value:function(){return 0<this.streams.values().length?this.streams.values()[0]:
null}},{key:"addStream",value:function(a){this.streams.set(a.getId(),a)}},{key:"removeStream",value:function(a){this.streams.delete(a.getId())}},{key:"toJSON",value:function(){var a={version:0,media:[]};a.version=this.version||0;a.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"};a.name=this.name||"semantic-sdp";a.connection=this.getConnection();a.timing=this.timing||{start:0,stop:0};var b=this.getICE();b&&(b.isLite()&&
(a.icelite="ice-lite"),a.iceOptions=b.getOpts(),a.iceUfrag=b.getUfrag(),a.icePwd=b.getPwd());a.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"};a.groups=[];var f={type:"BUNDLE",mids:[]},d=this.getDTLS();d&&(a.fingerprint={type:d.getHash(),hash:d.getFingerprint()},a.setup=u.toString(d.getSetup()));this.medias.forEach(function(k){var g={type:k.getType(),port:k.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};
g.direction=t.toString(k.getDirection());g.rtcpMux="rtcp-mux";g.connection=k.getConnection();g.xGoogleFlag=k.getXGoogleFlag();g.mid=k.getId();f.mids.push(k.getId());g.rtcp=k.rtcp;0<k.getBitrate()&&g.bandwidth.push({type:"AS",limit:k.getBitrate()});k.getCandidates().forEach(function(a){g.candidates.push({foundation:a.getFoundation(),component:a.getComponentId(),transport:a.getTransport(),priority:a.getPriority(),ip:a.getAddress(),port:a.getPort(),type:a.getType(),relAddr:a.getRelAddr(),relPort:a.getRelPort(),
generation:a.getGeneration()})});(b=k.getICE())&&(b.isLite()&&(g.icelite="ice-lite"),g.iceOptions=b.getOpts(),g.iceUfrag=b.getUfrag(),g.icePwd=b.getPwd(),b.isEndOfCandidates()&&(g.endOfCandidates=b.isEndOfCandidates()));(d=k.getDTLS())&&(g.fingerprint={type:d.getHash(),hash:d.getFingerprint()},g.setup=u.toString(d.getSetup()));k.setup&&(g.setup=u.toString(k.setup));k.getCodecs().forEach(function(a){g.rtp.push({payload:a.getType(),codec:a.getCodec(),rate:a.getRate(),encoding:a.getEncoding()});var c=
a.getParams();0<Object.keys(c).length&&g.fmtp.push({payload:a.getType(),config:Object.keys(c).map(function(a){return a+(c[a]?"\x3d".concat(c[a]):"")}).join(";")});a.getFeedback().forEach(function(c){g.rtcpFb.push({payload:a.getType(),type:c.type,subtype:c.subtype})});a.hasRTX()&&(g.rtp.push({payload:a.getRTX(),codec:"rtx",rate:a.getRate(),encoding:a.getEncoding()}),g.fmtp.push({payload:a.getRTX(),config:"apt\x3d".concat(a.getType())}))});var C=[];g.rtp.forEach(function(a){C.push(a.payload)});g.payloads=
C.join(" ");k.getExtensions().forEach(function(a,c){g.ext.push({value:c,uri:a})});k.getRIDs().forEach(function(a){var b={id:a.getId(),direction:c.toString(a.getDirection()),params:""};a.getFormats().length&&(b.params="pt\x3d".concat(a.getFormats().join(",")));a.getParams().forEach(function(a,c){b.params+="".concat(b.params.length?";":"").concat(c,"\x3d").concat(a)});g.rids.push(b)});var e=k.getSimulcast();k=k.getSimulcast03();if(e){var D=1;g.simulcast={};var m=e.getSimulcastStreams(c.SEND);e=e.getSimulcastStreams(c.RECV);
if(m&&m.length){var r="";m.forEach(function(a){var c="";a.forEach(function(a){c+=(c.length?",":"")+(a.isPaused()?"~":"")+a.getId()});r+=(r.length?";":"")+c});g.simulcast["dir".concat(D)]="send";g.simulcast["list".concat(D)]=r;D+=1}if(e&&e.length){var h=[];e.forEach(function(a){var c="";a.forEach(function(a){c+=(c.length?",":"")+(a.isPaused()?"~":"")+a.getId()});h+=(h.length?";":"")+c});g.simulcast["dir".concat(D)]="recv";g.simulcast["list".concat(D)]=h;D+=1}}k&&(g.simulcast_03={value:k.getSimulcastPlainString()});
a.media.push(g)});f.mids.sort();a.media.sort(function(a,c){return a.mid<c.mid?-1:a.mid>c.mid?1:0});var k=!0,g=!1,e=void 0;try{for(var m,r=this.streams.values()[Symbol.iterator]();!(k=(m=r.next()).done);k=!0){var h=m.value,q=!0,n=!1,y=void 0;try{for(var v,E=h.getTracks().values()[Symbol.iterator]();!(q=(v=E.next()).done);q=!0){var l=v.value,A=!0,p=!1,w=void 0;try{for(var z,Q=function(){var a=z.value;if(l.getMediaId()){if(l.getMediaId()===a.mid)return l.getSourceGroups().forEach(function(c){a.ssrcGroups.push({semantics:c.getSemantics(),
ssrcs:c.getSSRCs().join(" ")})}),l.getSSRCs().forEach(function(c){a.ssrcs.push({id:c.ssrc,attribute:"cname",value:c.getCName()})}),h.getId()&&l.getId()&&(a.msid="".concat(h.getId()," ").concat(l.getId())),"break"}else if(a.type.toLowerCase()===l.getMedia().toLowerCase())return l.getSourceGroups().forEach(function(c){a.ssrcGroups.push({semantics:c.getSemantics(),ssrcs:c.getSSRCs().join(" ")})}),l.getSSRCs().forEach(function(c){a.ssrcs.push({id:c.ssrc,attribute:"cname",value:c.getCName()});c.getStreamId()&&
c.getTrackId()&&a.ssrcs.push({id:c.ssrc,attribute:"msid",value:"".concat(c.getStreamId()," ").concat(c.getTrackId())});c.getMSLabel()&&a.ssrcs.push({id:c.ssrc,attribute:"mslabel",value:c.getMSLabel()});c.getLabel()&&a.ssrcs.push({id:c.ssrc,attribute:"label",value:c.getLabel()})}),"break"},C=a.media[Symbol.iterator]();!(A=(z=C.next()).done)&&"break"!==Q();A=!0);}catch(D){p=!0,w=D}finally{try{A||null==C.return||C.return()}finally{if(p)throw w;}}}}catch(D){n=!0,y=D}finally{try{q||null==E.return||E.return()}finally{if(n)throw y;
}}}}catch(D){g=!0,e=D}finally{try{k||null==r.return||r.return()}finally{if(g)throw e;}}return f.mids=f.mids.join(" "),a.groups.push(f),a}},{key:"toString",value:function(){var a=this.toJSON();return w.write(a)}}]),a}();k.processString=function(a){a=w.parse(a);return k.process(a)};k.process=function(b){var r=new k;r.setVersion(b.version);r.setTiming(b.timing);r.setConnection(b.connection);r.setOrigin(b.origin);r.msidSemantic=b.msidSemantic;r.name=b.name;var h=b.iceUfrag,y=b.icePwd,l=b.iceOptions;(h||
y||l)&&r.setICE(new d(h,y,l));var p=b.fingerprint;if(p){var F=p.type,J=p.hash,M=null;b.setup&&(M=u.byValue(b.setup));r.setDTLS(new g(M,F,J))}return b.media.forEach(function(b){var k=new z(b.mid,b.port,b.type);if(k.setXGoogleFlag(b.xGoogleFlag),k.rtcp=b.rtcp,k.setConnection(b.connection),b.bandwidth&&0<b.bandwidth.length&&b.bandwidth.forEach(function(a){"AS"===a.type&&k.setBitrate(a.limit)}),h=b.iceUfrag,y=b.icePwd,l=b.iceOptions,h||y||l){var B=new d(h,y,l);b.endOfCandidates&&B.setEndOfCandidates("end-of-candidates");
k.setICE(B)}if(p=b.fingerprint){B=p.type;var x=p.hash,H=u.ACTPASS;b.setup&&(H=u.byValue(b.setup));k.setDTLS(new g(H,B,x))}b.setup&&k.setSetup(u.byValue(b.setup));B=t.SENDRECV;b.direction&&(B=t.byValue(b.direction.toUpperCase()));k.setDirection(B);(B=b.candidates)&&B.forEach(function(a){k.addCandidate(new e(a.foundation,a.component,a.transport,a.priority,a.ip,a.port,a.type,a.generation,a.relAddr,a.relPort))});(function(a,c){var b=new Map;c.rtp.forEach(function(f){var d=f.payload,k=f.codec,g=f.rate;
f=f.encoding;var e={},C=[];c.fmtp.forEach(function(a){a.payload===d&&a.config.split(";").forEach(function(a){a=a.split("\x3d");e[a[0].trim()]=(a[1]||"").trim()})});c.rtcpFb&&c.rtcpFb.forEach(function(a){a.payload===d&&C.push({type:a.type,subtype:a.subtype})});"RTX"===k.toUpperCase()?b.set(parseInt(e.apt,10),d):a.addCodec(new G(k,d,g,f,e,C))});b.forEach(function(c,b){(b=a.getCodecForType(b))&&b.setRTX(c)})})(k,b);(B=b.ext)&&B.forEach(function(a){k.addExtension(a.value,a.uri)});(function(a,b){(b=b.rids)&&
b.forEach(function(b){var f=new q(b.id,c.byValue(b.direction)),d=[],k=new Map;if(b.params){var g=w.parseParams(b.params);Object.keys(g).forEach(function(a){"pt"===a?d=g[a].split(","):k.set(a,g[a])});f.setFormats(d);f.setParams(k)}a.addRID(f)})})(k,b);(function(a,c,b){var d,k,g,e=new Map,r=b.type;if(b.ssrcs&&b.ssrcs.forEach(function(b){var f=b.id,C=b.attribute;b=b.value;((g=e.get(f))||(g=new E(f),e.set(g.getSSRC(),g)),"cname"===C.toLowerCase())?g.setCName(b):"mslabel"===C.toLowerCase()?g.setMSLabel(b):
"label"===C.toLowerCase()?g.setLabel(b):"msid"===C.toLowerCase()&&(C=b.split(" "),f=C[0],C=C[1],g.setStreamId(f),g.setTrackId(C),(k=c.getStream(f))||(k=new m(f),c.addStream(k)),(d=k.getTrack(C))||((d=new v(r,C)).setEncodings(a),k.addTrack(d)),d.addSSRC(g))}),b.msid){var C=b.msid.split(" "),D=C[0],h=C[1];(C=c.getStream(D))||(C=new m(D),c.addStream(C));var q=C.getTrack(h);q||((q=new v(r,h)).setMediaId(b.mid),q.setEncodings(a),C.addTrack(q));e.forEach(function(a,c){a=e.get(c);a.getStreamId()||(a.setStreamId(D),
a.setTrackId(h),q.addSSRC(a))})}b.ssrcGroups&&b.ssrcGroups.forEach(function(a){var b=a.ssrcs.split(" ");a=new f(a.semantics,b);b=e.get(parseInt(b[0],10));c.getStream(b.getStreamId()).getTrack(b.getTrackId()).addSourceGroup(a)})})(function(b,f){var d=[];if(f.simulcast){var k=new n;a("1",f,k);a("2",f,k);k.getSimulcastStreams(c.SEND).forEach(function(a){var c=[];a.forEach(function(a){var f=new A(a.getId(),a.isPaused());(a=b.getRID(f.getId()))&&(a.getFormats().forEach(function(a){(a=b.getCodecForType(a))&&
f.addCodec(a)}),f.setParams(a.getParams()),c.push(f))});c.length&&d.push(c)});b.setSimulcast(k)}f.simulcast_03&&(k=new n,k.setSimulcastPlainString(f.simulcast_03.value),!0,b.setSimulcast03(k));return d}(k,b),r,b);r.addMedia(k)}),r};h.exports=k},function(h,p,l){h=l(22);l=l(23);p.write=l;p.parse=h.parse;p.parseFmtpConfig=h.parseFmtpConfig;p.parseParams=h.parseParams;p.parsePayloads=h.parsePayloads;p.parseRemoteCandidates=h.parseRemoteCandidates;p.parseImageAttributes=h.parseImageAttributes;p.parseSimulcastStreamList=
h.parseSimulcastStreamList},function(h,p,l){var b=function(a){return String(Number(a))===a?Number(a):a},a=l(7),w=RegExp.prototype.test.bind(/^([a-z])=(.*)/);p.parse=function(e){var g={},d=[],h=g;return e.split(/(\r\n|\r|\n)/).filter(w).forEach(function(g){var e=g[0],c=g.slice(2);"m"===e&&(d.push({rtp:[],fmtp:[]}),h=d[d.length-1]);for(g=0;g<(a[e]||[]).length;g+=1){var f=a[e][g];if(f.reg.test(c)){e=f;g=h;f=c;c=e.name&&e.names;e.push&&!g[e.push]?g[e.push]=[]:c&&!g[e.name]&&(g[e.name]={});c=e.push?{}:
c?g[e.name]:g;f=f.match(e.reg);var E=e.names,m=e.name;if(m&&!E)c[m]=b(f[1]);else for(m=0;m<E.length;m+=1)null!=f[m+1]&&(c[E[m]]=b(f[m+1]));!0;e.push&&g[e.push].push(c);break}}}),g.media=d,g};var e=function(a,g){var d=g.split(/=(.+)/,2);return 2===d.length?a[d[0]]=b(d[1]):1===d.length&&1<g.length&&(a[d[0]]=void 0),a};p.parseParams=function(a){return a.split(/;\s?/).reduce(e,{})};p.parseFmtpConfig=p.parseParams;p.parsePayloads=function(a){return a.split(" ").map(Number)};p.parseRemoteCandidates=function(a){var g=
[];a=a.split(" ").map(b);for(var d=0;d<a.length;d+=3)g.push({component:a[d],ip:a[d+1],port:a[d+2]});return g};p.parseImageAttributes=function(a){return a.split(" ").map(function(a){return a.substring(1,a.length-1).split(",").reduce(e,{})})};p.parseSimulcastStreamList=function(a){return a.split(";").map(function(a){return a.split(",").map(function(a){var d,g=!1;return"~"!==a[0]?d=b(a):(d=b(a.substring(1,a.length)),g=!0),{scid:d,paused:g}})})}},function(h,p,l){var b=l(7),a=/%[sdv%]/g,w=function(b,d,
e){b=[b+"\x3d"+(d.format instanceof Function?d.format(d.push?e:e[d.name]):d.format)];if(d.names)for(var g=0;g<d.names.length;g+=1){var h=d.names[g];d.name?b.push(e[d.name][h]):b.push(e[d.names[g]])}else b.push(e[d.name]);return function(c){var b=1,d=arguments,g=d.length;return c.replace(a,function(a){if(b>=g)return a;var c=d[b];switch(b+=1,a){case "%%":return"%";case "%s":return String(c);case "%d":return Number(c);case "%v":return""}})}.apply(null,b)},e="vosiuepcbtrza".split(""),G=["i","c","b","a"];
h.exports=function(a,d){d=d||{};null==a.version&&(a.version=0);null==a.name&&(a.name=" ");a.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var g=d.innerOrder||G,h=[];return(d.outerOrder||e).forEach(function(d){b[d].forEach(function(c){c.name in a&&null!=a[c.name]?h.push(w(d,c,a)):c.push in a&&null!=a[c.push]&&a[c.push].forEach(function(a){h.push(w(d,c,a))})})}),a.media.forEach(function(a){h.push(w("m",b.m[0],a));g.forEach(function(c){b[c].forEach(function(b){b.name in a&&null!=a[b.name]?
h.push(w(c,b,a)):b.push in a&&null!=a[b.push]&&a[b.push].forEach(function(a){h.push(w(c,b,a))})})})}),h.join("\r\n")+"\r\n"}},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a,h){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");!0;this.id=a;this.paused=h;this.codecs=new Map;this.params=new Map}return function(a,
b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){var a=new b(this.id,this.paused);return this.codecs.forEach(function(b){a.addCodec(b.cloned())}),a.setParams(this.params),a}},{key:"plain",value:function(){var a=this,b={id:this.id,paused:this.paused,codecs:{},params:{}};return this.codecs.keys().forEach(function(e){b.codecs[e]=a.codecs.get(e).plain()}),this.params.keys().forEach(function(e){b.params[e]=a.params.get(e).param}),b}},{key:"getId",value:function(){return this.id}},{key:"getCodecs",
value:function(){return this.codecs}},{key:"addCodec",value:function(a){this.codecs.set(a.getType(),a)}},{key:"getParams",value:function(){return this.params}},{key:"setParams",value:function(a){this.params=new Map(a)}},{key:"isPaused",value:function(){return this.paused}}]),b}();h.exports=p},function(h,p){function l(b,a){for(var h=0;h<a.length;h++){var e=a[h];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}p=function(){function b(a,h){if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");!0;this.paused=h;this.id=a}return function(a,b,e){b&&l(a.prototype,b);e&&l(a,e)}(b,[{key:"clone",value:function(){return new b(this.id,this.paused)}},{key:"plain",value:function(){return{id:this.id,paused:this.paused}}},{key:"isPaused",value:function(){return this.paused}},{key:"getId",value:function(){return this.id}}]),b}();h.exports=p},function(h,p,l){function b(a,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;
g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}var a=l(3);p=function(){function h(a,b){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");!0;this.id=a;this.direction=b;this.formats=[];this.params=new Map}return function(a,h,g){h&&b(a.prototype,h);g&&b(a,g)}(h,[{key:"clone",value:function(){var a=new h(this.id,this.direction);return a.setFormats(this.formats),a.setParams(this.params),a}},{key:"plain",value:function(){var b={id:this.id,
direction:a.toString(this.direction),formats:this.formats,params:{}};return this.params.forEach(function(a,g){b.params[g]=a}),b}},{key:"getId",value:function(){return this.id}},{key:"getDirection",value:function(){return this.direction}},{key:"setDirection",value:function(a){this.direction=a}},{key:"getFormats",value:function(){return this.formats}},{key:"setFormats",value:function(a){var b=this;this.formats=[];a.forEach(function(a){b.formats.push(parseInt(a,10))})}},{key:"getParams",value:function(){return this.params}},
{key:"setParams",value:function(a){this.params=new Map(a)}}]),h}();h.exports=p},function(h,p){h.exports=function(h){if(!h.webpackPolyfill){var b=Object.create(h);b.children||(b.children=[]);Object.defineProperty(b,"loaded",{enumerable:!0,get:function(){return b.l}});Object.defineProperty(b,"id",{enumerable:!0,get:function(){return b.i}});Object.defineProperty(b,"exports",{enumerable:!0});b.webpackPolyfill=1}return b}},function(h,p){h.exports=function(h){return h.webpackPolyfill||(h.deprecate=function(){},
h.paths=[],h.children||(h.children=[]),Object.defineProperty(h,"loaded",{enumerable:!0,get:function(){return h.l}}),Object.defineProperty(h,"id",{enumerable:!0,get:function(){return h.i}}),h.webpackPolyfill=1),h}},function(h,p,l){p=l(18);h.exports=p.adapter=l(30)},function(h,p,l){(function(b){function a(b){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":
typeof a})(b)}var l,e,G;!function(b){"object"===a(p)&&void 0!==h?h.exports=b():(e=[],void 0===(G="function"==typeof(l=b)?l.apply(p,e):l)||(h.exports=G))}(function(){return function t(a,b,e){function c(d,h){if(!b[d]){if(!a[d]){if(f)return f(d,!0);h=Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h;}h=b[d]={exports:{}};a[d][0].call(h.exports,function(b){return c(a[d][1][b]||b)},h,h.exports,t,a,b,e)}return b[d].exports}for(var f=!1,d=0;d<e.length;d++)c(e[d]);return c}({1:[function(a,
b,e){function d(a,c,b,f,d){c=m.writeRtpDescription(a.kind,c);if(c+=m.writeIceParameters(a.iceGatherer.getLocalParameters()),c+=m.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===b?"actpass":d||"active"),c+="a\x3dmid:"+a.mid+"\r\n",a.direction?c+="a\x3d"+a.direction+"\r\n":a.rtpSender&&a.rtpReceiver?c+="a\x3dsendrecv\r\n":a.rtpSender?c+="a\x3dsendonly\r\n":a.rtpReceiver?c+="a\x3drecvonly\r\n":c+="a\x3dinactive\r\n",a.rtpSender)b="msid:"+f.id+" "+a.rtpSender.track.id+"\r\n",c=c+("a\x3d"+
b)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+b),a.sendEncodingParameters[0].rtx&&(c+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+b,c+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n");return c+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+m.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(c+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+m.localCName+"\r\n"),c}function c(a,c){var b={codecs:[],
headerExtensions:[],fecMechanisms:[]},f=function(a,c){a=parseInt(a,10);for(var b=0;b<c.length;b++)if(c[b].payloadType===a||c[b].preferredPayloadType===a)return c[b]},d=function(a,c,b,d){a=f(a.parameters.apt,b);c=f(c.parameters.apt,d);return a&&c&&a.name.toLowerCase()===c.name.toLowerCase()};return a.codecs.forEach(function(f){for(var k=0;k<c.codecs.length;k++){var e=c.codecs[k];if(f.name.toLowerCase()===e.name.toLowerCase()&&f.clockRate===e.clockRate&&("rtx"!==f.name.toLowerCase()||!f.parameters||
!e.parameters.apt||d(f,e,a.codecs,c.codecs))){(e=JSON.parse(JSON.stringify(e))).numChannels=Math.min(f.numChannels,e.numChannels);b.codecs.push(e);e.rtcpFeedback=e.rtcpFeedback.filter(function(a){for(var c=0;c<f.rtcpFeedback.length;c++)if(f.rtcpFeedback[c].type===a.type&&f.rtcpFeedback[c].parameter===a.parameter)return!0;return!1});break}}}),a.headerExtensions.forEach(function(a){for(var f=0;f<c.headerExtensions.length;f++){var d=c.headerExtensions[f];if(a.uri===d.uri){b.headerExtensions.push(d);
break}}}),b}function f(a,c,b){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[c][a].indexOf(b)}function h(a,c){var b=a.getRemoteCandidates().find(function(a){return c.foundation===a.foundation&&c.ip===a.ip&&c.port===a.port&&c.priority===a.priority&&c.protocol===a.protocol&&c.type===a.type});
return b||a.addRemoteCandidate(c),!b}var m=a("sdp");b.exports=function(a,b){var e=function(c){var f=this,d=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){f[a]=d[a].bind(d)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onicegatheringstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.canTrickleIceCandidates=
null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",c=JSON.parse(JSON.stringify(c||{})),this.usingBundle="max-bundle"===c.bundlePolicy,"negotiate"===c.rtcpMuxPolicy)throw c=Error("rtcpMuxPolicy 'negotiate' is not supported"),c.name="NotSupportedError",c;switch(c.rtcpMuxPolicy||(c.rtcpMuxPolicy="require"),c.iceTransportPolicy){case "all":case "relay":break;
default:c.iceTransportPolicy="all"}switch(c.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:c.bundlePolicy="balanced"}if(c.iceServers=function(a,c){var b=!1;return(a=JSON.parse(JSON.stringify(a))).filter(function(a){if(a&&(a.urls||a.url)){var f=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var d="string"==typeof f;return d&&(f=[f]),f=f.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||
-1!==a.indexOf("turn:[")||b?0===a.indexOf("stun:")&&14393<=c&&-1===a.indexOf("?transport\x3dudp"):(b=!0,!0)}),delete a.url,a.urls=d?f[0]:f,!!f.length}return!1})}(c.iceServers||[],b),this._iceGatherers=[],c.iceCandidatePoolSize)for(var e=c.iceCandidatePoolSize;0<e;e--)this._iceGatherers=new a.RTCIceGatherer({iceServers:c.iceServers,gatherPolicy:c.iceTransportPolicy});else c.iceCandidatePoolSize=0;this._config=c;this.transceivers=[];this._sdpSessionId=m.generateSessionId();this._sdpSessionVersion=0;
this._dtlsRole=void 0};return e.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this.dispatchEvent(a);"function"==typeof this.onicegatheringstatechange&&this.onicegatheringstatechange(a)},e.prototype.getConfiguration=function(){return this._config},e.prototype.getLocalStreams=function(){return this.localStreams},e.prototype.getRemoteStreams=function(){return this.remoteStreams},e.prototype._createTransceiver=function(a){var c=0<this.transceivers.length;a=
{track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);return this.transceivers.push(a),
a},e.prototype.addTrack=function(c,b){for(var f,d=0;d<this.transceivers.length;d++)this.transceivers[d].track||this.transceivers[d].kind!==c.kind||(f=this.transceivers[d]);return f||(f=this._createTransceiver(c.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(b)&&this.localStreams.push(b),f.track=c,f.stream=b,f.rtpSender=new a.RTCRtpSender(c,f.dtlsTransport),f.rtpSender},e.prototype.addStream=function(a){var c=this;if(15025<=b)a.getTracks().forEach(function(b){c.addTrack(b,
a)});else{var f=a.clone();a.getTracks().forEach(function(a,c){var b=f.getTracks()[c];a.addEventListener("enabled",function(a){b.enabled=a.enabled})});f.getTracks().forEach(function(a){c.addTrack(a,f)})}},e.prototype.removeStream=function(a){a=this.localStreams.indexOf(a);-1<a&&(this.localStreams.splice(a,1),this._maybeFireNegotiationNeeded())},e.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})},e.prototype.getReceivers=
function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})},e.prototype._createIceGatherer=function(c,b){var f=this;if(b&&0<c)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new a.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(d,"state",{value:"new",writable:!0}),this.transceivers[c].candidates=[],this.transceivers[c].bufferCandidates=
function(a){var b=!a.candidate||0===Object.keys(a.candidate).length;d.state=b?"completed":"gathering";null!==f.transceivers[c].candidates&&f.transceivers[c].candidates.push(a.candidate)},d.addEventListener("localcandidate",this.transceivers[c].bufferCandidates),d},e.prototype._gather=function(c,b){var f=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var e=this.transceivers[b].candidates;this.transceivers[b].candidates=null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);
d.onlocalcandidate=function(a){if(!(f.usingBundle&&0<b)){var k=new Event("icecandidate");k.candidate={sdpMid:c,sdpMLineIndex:b};var e=a.candidate;(a=!e||0===Object.keys(e).length)?"new"!==d.state&&"gathering"!==d.state||(d.state="completed"):("new"===d.state&&(d.state="gathering"),e.component=1,k.candidate.candidate=m.writeCandidate(e));e=m.splitSections(f.localDescription.sdp);e[k.candidate.sdpMLineIndex+1]+=a?"a\x3dend-of-candidates\r\n":"a\x3d"+k.candidate.candidate+"\r\n";f.localDescription.sdp=
e.join("");e=f.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==f.iceGatheringState&&(f.iceGatheringState="gathering",f._emitGatheringStateChange());a||(f.dispatchEvent(k),"function"==typeof f.onicecandidate&&f.onicecandidate(k));e&&(f.dispatchEvent(new Event("icecandidate")),"function"==typeof f.onicecandidate&&f.onicecandidate(new Event("icecandidate")),f.iceGatheringState="complete",f._emitGatheringStateChange())}};a.setTimeout(function(){e.forEach(function(a){var c=
new Event("RTCIceGatherEvent");c.candidate=a;d.onlocalcandidate(c)})},0)}},e.prototype._createIceAndDtlsTransports=function(){var c=this,b=new a.RTCIceTransport(null);b.onicestatechange=function(){c._updateConnectionState()};var f=new a.RTCDtlsTransport(b);return f.ondtlsstatechange=function(){c._updateConnectionState()},f.onerror=function(){Object.defineProperty(f,"state",{value:"failed",writable:!0});c._updateConnectionState()},{iceTransport:b,dtlsTransport:f}},e.prototype._disposeIceAndDtlsTransports=
function(a){var c=this.transceivers[a].iceGatherer;c&&(delete c.onlocalcandidate,delete this.transceivers[a].iceGatherer);(c=this.transceivers[a].iceTransport)&&(delete c.onicestatechange,delete this.transceivers[a].iceTransport);(c=this.transceivers[a].dtlsTransport)&&(delete c.ondtlsstatechange,delete c.onerror,delete this.transceivers[a].dtlsTransport)},e.prototype._transceive=function(a,f,d){var k=c(a.localCapabilities,a.remoteCapabilities);f&&a.rtpSender&&(k.encodings=a.sendEncodingParameters,
k.rtcp={cname:m.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(k.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(k));d&&a.rtpReceiver&&0<k.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>b&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),k.encodings=a.recvEncodingParameters,k.rtcp={cname:a.rtcpParameters.cname,compound:a.rtcpParameters.compound},a.sendEncodingParameters.length&&(k.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),
a.rtpReceiver.receive(k))},e.prototype.setLocalDescription=function(a){var b=this,d=arguments;if(!f("setLocalDescription",a.type,this.signalingState))return new Promise(function(c,f){c=Error("Can not set local "+a.type+" in state "+b.signalingState);c.name="InvalidStateError";2<d.length&&"function"==typeof d[2]&&d[2].apply(null,[c]);f(c)});if("offer"===a.type){var e=m.splitSections(a.sdp);var h=e.shift();e.forEach(function(a,c){a=m.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});this.transceivers.forEach(function(a,
c){b._gather(a.mid,c)})}else if("answer"===a.type){e=m.splitSections(b.remoteDescription.sdp);h=e.shift();var n=0<m.matchPrefix(h,"a\x3dice-lite").length;e.forEach(function(a,f){var d=b.transceivers[f],k=d.iceGatherer,e=d.iceTransport,q=d.dtlsTransport,r=d.localCapabilities,l=d.remoteCapabilities;if(!(m.isRejected(a)&&1===!m.matchPrefix(a,"a\x3dbundle-only").length||d.isDatachannel)){var E=m.getIceParameters(a,h);a=m.getDtlsParameters(a,h);n&&(a.role="server");b.usingBundle&&0!==f||(b._gather(d.mid,
f),"new"===e.state&&e.start(k,E,n?"controlling":"controlled"),"new"===q.state&&q.start(a));f=c(r,l);b._transceive(d,0<f.codecs.length,!1)}})}switch(this.localDescription={type:a.type,sdp:a.sdp},a.type){case "offer":this._updateSignalingState("have-local-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+a.type+'"');}var r=1<arguments.length&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(a){r&&r.apply(null);
a()})},e.prototype.setRemoteDescription=function(c){var d=this,k=arguments;if(!f("setRemoteDescription",c.type,this.signalingState))return new Promise(function(a,b){a=Error("Can not set remote "+c.type+" in state "+d.signalingState);a.name="InvalidStateError";2<k.length&&"function"==typeof k[2]&&k[2].apply(null,[a]);b(a)});var e={};this.remoteStreams.forEach(function(a){e[a.id]=a});var n=[],r=m.splitSections(c.sdp),l=r.shift(),E=0<m.matchPrefix(l,"a\x3dice-lite").length,t=0<m.matchPrefix(l,"a\x3dgroup:BUNDLE ").length;
this.usingBundle=t;var v=m.matchPrefix(l,"a\x3dice-options:")[0];switch(this.canTrickleIceCandidates=!!v&&0<=v.substr(14).split(" ").indexOf("trickle"),r.forEach(function(f,k){var r=m.splitLines(f),q=m.getKind(f),B=m.isRejected(f)&&1===!m.matchPrefix(f,"a\x3dbundle-only").length,v=r[0].substr(2).split(" ")[2];r=m.getDirection(f,l);var y=m.parseMsid(f),p=m.getMid(f)||m.generateIdentifier();if("application"!==q||"DTLS/SCTP"!==v){var x,A,H,I,u,z,Q,C,D=m.parseRtpParameters(f);B||(Q=m.getIceParameters(f,
l),(C=m.getDtlsParameters(f,l)).role="client");v=m.parseRtpEncodingParameters(f);var U=m.parseRtcpParameters(f),W=0<m.matchPrefix(f,"a\x3dend-of-candidates",l).length;f=m.matchPrefix(f,"a\x3dcandidate:").map(function(a){return m.parseCandidate(a)}).filter(function(a){return 1===a.component});if(("offer"===c.type||"answer"===c.type)&&!B&&t&&0<k&&d.transceivers[k]&&(d._disposeIceAndDtlsTransports(k),d.transceivers[k].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[k].iceTransport=d.transceivers[0].iceTransport,
d.transceivers[k].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[k].rtpSender&&d.transceivers[k].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[k].rtpReceiver&&d.transceivers[k].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==c.type||B)"answer"!==c.type||B||(A=(x=d.transceivers[k]).iceGatherer,H=x.iceTransport,I=x.dtlsTransport,u=x.rtpReceiver,B=x.sendEncodingParameters,p=x.localCapabilities,d.transceivers[k].recvEncodingParameters=v,d.transceivers[k].remoteCapabilities=
D,d.transceivers[k].rtcpParameters=U,f.length&&"new"===H.state&&(!E&&!W||t&&0!==k?f.forEach(function(a){h(x.iceTransport,a)}):H.setRemoteCandidates(f)),t&&0!==k||("new"===H.state&&H.start(A,Q,"controlling"),"new"===I.state&&I.start(C)),d._transceive(x,"sendrecv"===r||"recvonly"===r,"sendrecv"===r||"sendonly"===r),!u||"sendrecv"!==r&&"sendonly"!==r?delete x.rtpReceiver:(z=u.track,y?(e[y.stream]||(e[y.stream]=new a.MediaStream),e[y.stream].addTrack(z),n.push([z,u,e[y.stream]])):(e.default||(e.default=
new a.MediaStream),e.default.addTrack(z),n.push([z,u,e.default]))));else{(x=d.transceivers[k]||d._createTransceiver(q)).mid=p;x.iceGatherer||(x.iceGatherer=d._createIceGatherer(k,t));f.length&&"new"===x.iceTransport.state&&(!W||t&&0!==k?f.forEach(function(a){h(x.iceTransport,a)}):x.iceTransport.setRemoteCandidates(f));p=a.RTCRtpReceiver.getCapabilities(q);15019>b&&(p.codecs=p.codecs.filter(function(a){return"rtx"!==a.name}));B=x.sendEncodingParameters||[{ssrc:1001*(2*k+2)}];var P;A=!1;if("sendrecv"===
r||"sendonly"===r)if(A=!x.rtpReceiver,u=x.rtpReceiver||new a.RTCRtpReceiver(x.dtlsTransport,q),A)z=u.track,y?(e[y.stream]||(e[y.stream]=new a.MediaStream,Object.defineProperty(e[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(z,"id",{get:function(){return y.track}}),P=e[y.stream]):(e.default||(e.default=new a.MediaStream),P=e.default),P.addTrack(z),n.push([z,u,P]);x.localCapabilities=p;x.remoteCapabilities=D;x.rtpReceiver=u;x.rtcpParameters=U;x.sendEncodingParameters=B;x.recvEncodingParameters=
v;d._transceive(d.transceivers[k],!1,A)}}else d.transceivers[k]={mid:p,isDatachannel:!0}}),void 0===this._dtlsRole&&(this._dtlsRole="offer"===c.type?"active":"passive"),this.remoteDescription={type:c.type,sdp:c.sdp},c.type){case "offer":this._updateSignalingState("have-remote-offer");break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+c.type+'"');}return Object.keys(e).forEach(function(c){var b=e[c];if(b.getTracks().length){if(-1===d.remoteStreams.indexOf(b)){d.remoteStreams.push(b);
var f=new Event("addstream");f.stream=b;a.setTimeout(function(){d.dispatchEvent(f);"function"==typeof d.onaddstream&&d.onaddstream(f)})}n.forEach(function(c){var f=c[0],k=c[1];if(b.id===c[2].id){var e=new Event("track");e.track=f;e.receiver=k;e.transceiver={receiver:k};e.streams=[b];a.setTimeout(function(){d.dispatchEvent(e);"function"==typeof d.ontrack&&d.ontrack(e)})}})}}),a.setTimeout(function(){d&&d.transceivers&&d.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&
0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3),new Promise(function(a){1<k.length&&"function"==typeof k[1]&&k[1].apply(null);a()})},e.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._updateSignalingState("closed")},
e.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this.dispatchEvent(a);"function"==typeof this.onsignalingstatechange&&this.onsignalingstatechange(a)},e.prototype._maybeFireNegotiationNeeded=function(){var c=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,a.setTimeout(function(){if(!1!==c.needNegotiation){c.needNegotiation=!1;var a=new Event("negotiationneeded");c.dispatchEvent(a);"function"==typeof c.onnegotiationneeded&&
c.onnegotiationneeded(a)}},0))},e.prototype._updateConnectionState=function(){var a,c={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(a){c[a.iceTransport.state]++;c[a.dtlsTransport.state]++}),c.connected+=c.completed,a="new",0<c.failed?a="failed":0<c.connecting||0<c.checking?a="connecting":0<c.disconnected?a="disconnected":0<c.new?a="new":(0<c.connected||0<c.completed)&&(a="connected"),a!==this.iceConnectionState)this.iceConnectionState=
a,a=new Event("iceconnectionstatechange"),this.dispatchEvent(a),"function"==typeof this.oniceconnectionstatechange&&this.oniceconnectionstatechange(a)},e.prototype.createOffer=function(){var c,f=this,k=arguments;1===arguments.length&&"function"!=typeof arguments[0]?c=arguments[0]:3===arguments.length&&(c=arguments[2]);var e=this.transceivers.filter(function(a){return"audio"===a.kind}).length,h=this.transceivers.filter(function(a){return"video"===a.kind}).length;if(c){if(c.mandatory||c.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==c.offerToReceiveAudio&&(e=!0===c.offerToReceiveAudio?1:!1===c.offerToReceiveAudio?0:c.offerToReceiveAudio);void 0!==c.offerToReceiveVideo&&(h=!0===c.offerToReceiveVideo?1:!1===c.offerToReceiveVideo?0:c.offerToReceiveVideo)}for(this.transceivers.forEach(function(a){"audio"===a.kind?0>--e&&(a.wantReceive=!1):"video"===a.kind&&0>--h&&(a.wantReceive=!1)});0<e||0<h;)0<e&&(this._createTransceiver("audio"),e--),0<h&&(this._createTransceiver("video"),h--);var n=m.writeSessionBoilerplate(this._sdpSessionId,
this._sdpSessionVersion++);this.transceivers.forEach(function(c,d){var k=c.track,e=c.kind,h=m.generateIdentifier();c.mid=h;c.iceGatherer||(c.iceGatherer=f._createIceGatherer(d,f.usingBundle));h=a.RTCRtpSender.getCapabilities(e);15019>b&&(h.codecs=h.codecs.filter(function(a){return"rtx"!==a.name}));h.codecs.forEach(function(a){"H264"===a.name&&void 0===a.parameters["level-asymmetry-allowed"]&&(a.parameters["level-asymmetry-allowed"]="1")});d=c.sendEncodingParameters||[{ssrc:1001*(2*d+1)}];k&&15019<=
b&&"video"===e&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1});c.wantReceive&&(c.rtpReceiver=new a.RTCRtpReceiver(c.dtlsTransport,e));c.localCapabilities=h;c.sendEncodingParameters=d});"max-compat"!==this._config.bundlePolicy&&(n+="a\x3dgroup:BUNDLE "+this.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");n+="a\x3dice-options:trickle\r\n";this.transceivers.forEach(function(a,c){n+=d(a,a.localCapabilities,"offer",a.stream,f._dtlsRole);n+="a\x3drtcp-rsize\r\n";!a.iceGatherer||"new"===f.iceGatheringState||
0!==c&&f.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;n+="a\x3d"+m.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(n+="a\x3dend-of-candidates\r\n"))});var l=new a.RTCSessionDescription({type:"offer",sdp:n});return new Promise(function(a){if(0<k.length&&"function"==typeof k[0])return k[0].apply(null,[l]),void a();a(l)})},e.prototype.createAnswer=function(){var f=this,e=arguments,k=m.writeSessionBoilerplate(this._sdpSessionId,this._sdpSessionVersion++);
this.usingBundle&&(k+="a\x3dgroup:BUNDLE "+this.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var h=m.splitSections(this.remoteDescription.sdp).length-1;this.transceivers.forEach(function(a,e){if(!(e+1>h))if(a.isDatachannel)k+="m\x3dapplication 0 DTLS/SCTP 5000\r\nc\x3dIN IP4 0.0.0.0\r\na\x3dmid:"+a.mid+"\r\n";else{var m;a.stream&&("audio"===a.kind?m=a.stream.getAudioTracks()[0]:"video"===a.kind&&(m=a.stream.getVideoTracks()[0]),m&&15019<=b&&"video"===a.kind&&!a.sendEncodingParameters[0].rtx&&
(a.sendEncodingParameters[0].rtx={ssrc:a.sendEncodingParameters[0].ssrc+1}));e=c(a.localCapabilities,a.remoteCapabilities);!e.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&a.sendEncodingParameters[0].rtx&&delete a.sendEncodingParameters[0].rtx;k+=d(a,e,"answer",a.stream,f._dtlsRole);a.rtcpParameters&&a.rtcpParameters.reducedSize&&(k+="a\x3drtcp-rsize\r\n")}});var n=new a.RTCSessionDescription({type:"answer",sdp:k});return new Promise(function(a){if(0<e.length&&"function"==
typeof e[0])return e[0].apply(null,[n]),void a();a(n)})},e.prototype.addIceCandidate=function(a){var c,b;if(a&&""!==a.candidate){if(void 0===a.sdpMLineIndex&&!a.sdpMid)throw new TypeError("sdpMLineIndex or sdpMid required");if(this.remoteDescription){var f=a.sdpMLineIndex;if(a.sdpMid)for(b=0;b<this.transceivers.length;b++)if(this.transceivers[b].mid===a.sdpMid){f=b;break}if(b=this.transceivers[f]){if(b.isDatachannel)return Promise.resolve();var d=0<Object.keys(a.candidate).length?m.parseCandidate(a.candidate):
{};if("tcp"===d.protocol&&(0===d.port||9===d.port)||d.component&&1!==d.component)return Promise.resolve();if((0===f||0<f&&b.iceTransport!==this.transceivers[0].iceTransport)&&(h(b.iceTransport,d)||((c=Error("Can not add ICE candidate")).name="OperationError")),!c){var e=a.candidate.trim();0===e.indexOf("a\x3d")&&(e=e.substr(2));(b=m.splitSections(this.remoteDescription.sdp))[f+1]+="a\x3d"+(d.type?e:"end-of-candidates")+"\r\n";this.remoteDescription.sdp=b.join("")}}else(c=Error("Can not add ICE candidate")).name=
"OperationError"}else(c=Error("Can not add ICE candidate without a remote description")).name="InvalidStateError"}else for(f=0;f<this.transceivers.length&&(this.transceivers[f].isDatachannel||(this.transceivers[f].iceTransport.addRemoteCandidate({}),(b=m.splitSections(this.remoteDescription.sdp))[f+1]+="a\x3dend-of-candidates\r\n",this.remoteDescription.sdp=b.join(""),!this.usingBundle));f++);var n=arguments;return new Promise(function(a,b){c?(2<n.length&&"function"==typeof n[2]&&n[2].apply(null,
[c]),b(c)):(1<n.length&&"function"==typeof n[1]&&n[1].apply(null),a())})},e.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(c){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){c[b]&&a.push(c[b].getStats())})});var c=1<arguments.length&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(b){var f=new Map;Promise.all(a).then(function(a){a.forEach(function(a){Object.keys(a).forEach(function(c){var b=a[c];a[c].type=
{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[b.type]||b.type;f.set(c,a[c])})});c&&c.apply(null,f);b(f)})})},e}},{sdp:2}],2:[function(b,e,h){var d={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};d.localCName=d.generateIdentifier();d.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};d.splitSections=function(a){return a.split("\nm\x3d").map(function(a,
c){return(0<c?"m\x3d"+a:a).trim()+"\r\n"})};d.matchPrefix=function(a,b){return d.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};d.parseCandidate=function(a){var c;a={foundation:(c=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):a.substring(10).split(" "))[0],component:parseInt(c[1],10),protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],port:parseInt(c[5],10),type:c[7]};for(var b=8;b<c.length;b+=2)switch(c[b]){case "raddr":a.relatedAddress=c[b+1];break;case "rport":a.relatedPort=
parseInt(c[b+1],10);break;case "tcptype":a.tcpType=c[b+1];break;case "ufrag":a.ufrag=c[b+1];a.usernameFragment=c[b+1];break;default:a[c[b]]=c[b+1]}return a};d.writeCandidate=function(a){var c=[];c.push(a.foundation);c.push(a.component);c.push(a.protocol.toUpperCase());c.push(a.priority);c.push(a.ip);c.push(a.port);var b=a.type;return c.push("typ"),c.push(b),"host"!==b&&a.relatedAddress&&a.relatedPort&&(c.push("raddr"),c.push(a.relatedAddress),c.push("rport"),c.push(a.relatedPort)),a.tcpType&&"tcp"===
a.protocol.toLowerCase()&&(c.push("tcptype"),c.push(a.tcpType)),a.ufrag&&(c.push("ufrag"),c.push(a.ufrag)),"candidate:"+c.join(" ")};d.parseIceOptions=function(a){return a.substr(14).split(" ")};d.parseRtpMap=function(a){a=a.substr(9).split(" ");var c={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),c.name=a[0],c.clockRate=parseInt(a[1],10),c.numChannels=3===a.length?parseInt(a[2],10):1,c};d.writeRtpMap=function(a){var c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),
"a\x3drtpmap:"+c+" "+a.name+"/"+a.clockRate+(1!==a.numChannels?"/"+a.numChannels:"")+"\r\n"};d.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};d.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};d.parseFmtp=function(a){var c,b={};a=a.substr(a.indexOf(" ")+1).split(";");for(var d=0;d<a.length;d++)b[(c=a[d].trim().split("\x3d"))[0].trim()]=
c[1];return b};d.writeFmtp=function(a){var c="",b=a.payloadType;if(void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(c){d.push(c+"\x3d"+a.parameters[c])});c+="a\x3dfmtp:"+b+" "+d.join(";")+"\r\n"}return c};d.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};d.writeRtcpFb=function(a){var c="",b=a.payloadType;return void 0!==a.preferredPayloadType&&
(b=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){c+="a\x3drtcp-fb:"+b+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"}),c};d.parseSsrcMedia=function(a){var c=a.indexOf(" "),b={ssrc:parseInt(a.substr(7,c-7),10)},d=a.indexOf(":",c);return-1<d?(b.attribute=a.substr(c+1,d-c-1),b.value=a.substr(d+1)):b.attribute=a.substr(c+1),b};d.getMid=function(a){if(a=d.matchPrefix(a,"a\x3dmid:")[0])return a.substr(6)};d.parseFingerprint=function(a){a=
a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};d.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:d.matchPrefix(a+b,"a\x3dfingerprint:").map(d.parseFingerprint)}};d.writeDtlsParameters=function(a,b){var c="a\x3dsetup:"+b+"\r\n";return a.fingerprints.forEach(function(a){c+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c};d.getIceParameters=function(a,b){a=d.splitLines(a);return{usernameFragment:(a=a.concat(d.splitLines(b))).filter(function(a){return 0===
a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};d.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+a.password+"\r\n"};d.parseRtpParameters=function(a){for(var c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},b=d.splitLines(a)[0].split(" "),e=3;e<b.length;e++){var h=b[e],l=d.matchPrefix(a,"a\x3drtpmap:"+h+" ")[0];if(l){l=d.parseRtpMap(l);var n=d.matchPrefix(a,"a\x3dfmtp:"+
h+" ");switch(l.parameters=n.length?d.parseFmtp(n[0]):{},l.rtcpFeedback=d.matchPrefix(a,"a\x3drtcp-fb:"+h+" ").map(d.parseRtcpFb),c.codecs.push(l),l.name.toUpperCase()){case "RED":case "ULPFEC":c.fecMechanisms.push(l.name.toUpperCase())}}}return d.matchPrefix(a,"a\x3dextmap:").forEach(function(a){c.headerExtensions.push(d.parseExtmap(a))}),c};d.writeRtpDescription=function(a,b){var c="";c+="m\x3d"+a+" ";c+=0<b.codecs.length?"9":"0";c+=" UDP/TLS/RTP/SAVPF ";c+=b.codecs.map(function(a){return void 0!==
a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";c+="c\x3dIN IP4 0.0.0.0\r\n";c+="a\x3drtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){c+=d.writeRtpMap(a);c+=d.writeFmtp(a);c+=d.writeRtcpFb(a)});var f=0;return b.codecs.forEach(function(a){a.maxptime>f&&(f=a.maxptime)}),0<f&&(c+="a\x3dmaxptime:"+f+"\r\n"),c+="a\x3drtcp-mux\r\n",b.headerExtensions.forEach(function(a){c+=d.writeExtmap(a)}),c};d.parseRtpEncodingParameters=function(a){var c,b=[],e=d.parseRtpParameters(a),
h=-1!==e.fecMechanisms.indexOf("RED"),l=-1!==e.fecMechanisms.indexOf("ULPFEC"),n=d.matchPrefix(a,"a\x3dssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),r=0<n.length&&n[0].ssrc;n=d.matchPrefix(a,"a\x3dssrc-group:FID").map(function(a){a=a.split(" ");return a.shift(),a.map(function(a){return parseInt(a,10)})});0<n.length&&1<n[0].length&&n[0][0]===r&&(c=n[0][1]);e.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:r,
codecPayloadType:parseInt(a.parameters.apt,10),rtx:{ssrc:c}},b.push(a),h&&((a=JSON.parse(JSON.stringify(a))).fec={ssrc:c,mechanism:l?"red+ulpfec":"red"},b.push(a)))});0===b.length&&r&&b.push({ssrc:r});var q=d.matchPrefix(a,"b\x3d");return q.length&&(q=0===q[0].indexOf("b\x3dTIAS:")?parseInt(q[0].substr(7),10):0===q[0].indexOf("b\x3dAS:")?950*parseInt(q[0].substr(5),10)-16E3:void 0,b.forEach(function(a){a.maxBitrate=q})),b};d.parseRtcpParameters=function(a){var c={},b=d.matchPrefix(a,"a\x3dssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===
a.attribute})[0];b&&(c.cname=b.value,c.ssrc=b.ssrc);b=d.matchPrefix(a,"a\x3drtcp-rsize");c.reducedSize=0<b.length;c.compound=0===b.length;a=d.matchPrefix(a,"a\x3drtcp-mux");return c.mux=0<a.length,c};d.parseMsid=function(a){var c,b=d.matchPrefix(a,"a\x3dmsid:");if(1===b.length)return{stream:(c=b[0].substr(7).split(" "))[0],track:c[1]};a=d.matchPrefix(a,"a\x3dssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});return 0<a.length?{stream:(c=a[0].value.split(" "))[0],
track:c[1]}:void 0};d.generateSessionId=function(){return Math.random().toString().substr(2,21)};d.writeSessionBoilerplate=function(a,b){b=void 0!==b?b:2;return"v\x3d0\r\no\x3dthisisadapterortc "+(a||d.generateSessionId())+" "+b+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};d.writeMediaSection=function(a,b,e,h){b=d.writeRtpDescription(a.kind,b);if(b+=d.writeIceParameters(a.iceGatherer.getLocalParameters()),b+=d.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===e?"actpass":"active"),
b+="a\x3dmid:"+a.mid+"\r\n",a.direction?b+="a\x3d"+a.direction+"\r\n":a.rtpSender&&a.rtpReceiver?b+="a\x3dsendrecv\r\n":a.rtpSender?b+="a\x3dsendonly\r\n":a.rtpReceiver?b+="a\x3drecvonly\r\n":b+="a\x3dinactive\r\n",a.rtpSender)e="msid:"+h.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a\x3d"+e)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+
"\r\n");return b+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+d.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+d.localCName+"\r\n"),b};d.getDirection=function(a,b){a=d.splitLines(a);for(var c=0;c<a.length;c++)switch(a[c]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return a[c].substr(2)}return b?d.getDirection(b):"sendrecv"};d.getKind=function(a){return d.splitLines(a)[0].split(" ")[0].substr(2)};
d.isRejected=function(a){return"0"===a.split(" ",2)[1]};d.parseMLine=function(a){a=d.splitLines(a)[0].split(" ");return{kind:a[0].substr(2),port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};"object"===a(e)&&(e.exports=d)},{}],3:[function(a,e,h){h=void 0!==b?b:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};a=a("./adapter_factory.js");e.exports=a({window:h.window})},{"./adapter_factory.js":4}],4:[function(a,b,e){var d=a("./utils");b.exports=function(c,b){c=c&&c.window;
var f={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(e in b)hasOwnProperty.call(b,e)&&(f[e]=b[e]);b=d.log;var e=d.detectBrowser(c);var h={browserDetails:e,extractVersion:d.extractVersion,disableLog:d.disableLog,disableWarnings:d.disableWarnings},l=a("./chrome/chrome_shim")||null,n=a("./edge/edge_shim")||null,r=a("./firefox/firefox_shim")||null,q=a("./safari/safari_shim")||null,k=a("./common_shim")||null;switch(e.browser){case "chrome":if(!l||!l.shimPeerConnection||!f.shimChrome)return b("Chrome shim is not included in this adapter release."),
h;b("adapter.js shimming chrome.");h.browserShim=l;k.shimCreateObjectURL(c);l.shimGetUserMedia(c);l.shimMediaStream(c);l.shimSourceObject(c);l.shimPeerConnection(c);l.shimOnTrack(c);l.shimAddTrackRemoveTrack(c);l.shimGetSendersWithDtmf(c);k.shimRTCIceCandidate(c);break;case "firefox":if(!r||!r.shimPeerConnection||!f.shimFirefox)return b("Firefox shim is not included in this adapter release."),h;b("adapter.js shimming firefox.");h.browserShim=r;k.shimCreateObjectURL(c);r.shimGetUserMedia(c);r.shimSourceObject(c);
r.shimPeerConnection(c);r.shimOnTrack(c);k.shimRTCIceCandidate(c);break;case "edge":if(!n||!n.shimPeerConnection||!f.shimEdge)return b("MS edge shim is not included in this adapter release."),h;b("adapter.js shimming edge.");h.browserShim=n;k.shimCreateObjectURL(c);n.shimGetUserMedia(c);n.shimPeerConnection(c);n.shimReplaceTrack(c);break;case "safari":if(!q||!f.shimSafari)return b("Safari shim is not included in this adapter release."),h;b("adapter.js shimming safari.");h.browserShim=q;k.shimCreateObjectURL(c);
q.shimRTCIceServerUrls(c);q.shimCallbacksAPI(c);q.shimLocalStreamsAPI(c);q.shimRemoteStreamsAPI(c);q.shimTrackEventTransceiver(c);q.shimGetUserMedia(c);q.shimCreateOfferLegacy(c);k.shimRTCIceCandidate(c);break;default:b("Unsupported browser!")}return h}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":10,"./safari/safari_shim":12,"./utils":13}],5:[function(b,e,h){var d=b("../utils.js"),c=d.log;e.exports={shimMediaStream:function(a){a.MediaStream=a.MediaStream||
a.webkitMediaStream},shimOnTrack:function(c){if("object"===a(c)&&c.RTCPeerConnection&&!("ontrack"in c.RTCPeerConnection.prototype)){Object.defineProperty(c.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)}});var b=c.RTCPeerConnection.prototype.setRemoteDescription;c.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;return a._ontrackpoly||
(a._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var f=c.RTCPeerConnection.prototype.getReceivers?a.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var e=new Event("track");e.track=d.track;e.receiver=f;e.transceiver={receiver:f};e.streams=[b.stream];a.dispatchEvent(e)});b.stream.getTracks().forEach(function(d){var f=c.RTCPeerConnection.prototype.getReceivers?a.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):
{track:d};var e=new Event("track");e.track=d;e.receiver=f;e.transceiver={receiver:f};e.streams=[b.stream];a.dispatchEvent(e)})},a.addEventListener("addstream",a._ontrackpoly)),b.apply(a,arguments)}}},shimAddTrackRemoveTrack:function(a){function c(a,c){var b=c.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(a._streams[c.id].id,"g"),c.id)}),new RTCSessionDescription({type:c.type,sdp:b})}var b=d.detectBrowser(a);if(!(a.RTCPeerConnection.prototype.addTrack&&
63<=b.version)){var f=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=f.apply(this);return a._reverseStreams=a._reverseStreams||{},c.map(function(c){return a._reverseStreams[c.id]})};var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(c){var b=this;if(b._streams=b._streams||{},b._reverseStreams=b._reverseStreams||{},c.getTracks().forEach(function(a){if(b.getSenders().find(function(c){return c.track===
a}))throw new DOMException("Track already exists.","InvalidAccessError");}),!b._reverseStreams[c.id]){var d=new a.MediaStream(c.getTracks());b._streams[c.id]=d;b._reverseStreams[d.id]=c;c=d}e.apply(b,[c])};var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};h.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];
delete this._streams[a.id]};a.RTCPeerConnection.prototype.addTrack=function(c,b){var d=this;if("closed"===d.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var f=[].slice.call(arguments,1);if(1!==f.length||!f[0].getTracks().find(function(a){return a===c}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(d.getSenders().find(function(a){return a.track===
c}))throw new DOMException("Track already exists.","InvalidAccessError");d._streams=d._streams||{};d._reverseStreams=d._reverseStreams||{};(f=d._streams[b.id])?(f.addTrack(c),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(f=new a.MediaStream([c]),d._streams[b.id]=f,d._reverseStreams[f.id]=b,d.addStream(f));return d.getSenders().find(function(a){return a.track===c})};["createOffer","createAnswer"].forEach(function(b){var d=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=
function(){var a=this,b=arguments;return arguments.length&&"function"==typeof arguments[0]?d.apply(a,[function(d){d=c(a,d);b[0].apply(null,[d])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):d.apply(a,arguments).then(function(b){return c(a,b)})}});var l=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(a,c){var b=c.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(c){c=
a._reverseStreams[c];b=b.replace(new RegExp(c.id,"g"),a._streams[c.id].id)}),new RTCSessionDescription({type:c.type,sdp:b})}(this,arguments[0]),l.apply(this,arguments)):l.apply(this,arguments)};var q=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=q.get.apply(this);return""===a.type?a:c(this,a)}});a.RTCPeerConnection.prototype.removeTrack=function(a){var c,b=this;if("closed"===
b.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==b)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");b._streams=b._streams||{};Object.keys(b._streams).forEach(function(d){b._streams[d].getTracks().find(function(c){return a.track===c})&&(c=b._streams[d])});
c&&(1===c.getTracks().length?b.removeStream(b._reverseStreams[c.id]):c.removeTrack(a.track),b.dispatchEvent(new Event("negotiationneeded")))}}},shimGetSendersWithDtmf:function(c){if("object"===a(c)&&c.RTCPeerConnection&&!("getSenders"in c.RTCPeerConnection.prototype)&&"createDTMFSender"in c.RTCPeerConnection.prototype){var b=function(a,c){return{track:c,get dtmf(){return void 0===this._dtmf&&("audio"===c.kind?this._dtmf=a.createDTMFSender(c):this._dtmf=null),this._dtmf},_pc:a}};if(!c.RTCPeerConnection.prototype.getSenders){c.RTCPeerConnection.prototype.getSenders=
function(){return this._senders=this._senders||[],this._senders.slice()};var d=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addTrack=function(a,c){var f=d.apply(this,arguments);return f||(f=b(this,a),this._senders.push(f)),f};var f=c.RTCPeerConnection.prototype.removeTrack;c.RTCPeerConnection.prototype.removeTrack=function(a){f.apply(this,arguments);var c=this._senders.indexOf(a);-1!==c&&this._senders.splice(c,1)}}var e=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=
function(a){var c=this;c._senders=c._senders||[];e.apply(c,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var h=c.RTCPeerConnection.prototype.removeStream;c.RTCPeerConnection.prototype.removeStream=function(a){var c=this;c._senders=c._senders||[];h.apply(c,[a]);a.getTracks().forEach(function(a){var b=c._senders.find(function(c){return c.track===a});b&&c._senders.splice(c._senders.indexOf(b),1)})}}else if("object"===a(c)&&c.RTCPeerConnection&&"getSenders"in c.RTCPeerConnection.prototype&&
"createDTMFSender"in c.RTCPeerConnection.prototype&&c.RTCRtpSender&&!("dtmf"in c.RTCRtpSender.prototype)){var l=c.RTCPeerConnection.prototype.getSenders;c.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=l.apply(a,[]);return c.forEach(function(c){c._pc=a}),c};Object.defineProperty(c.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSourceObject:function(c){var b=
c&&c.URL;"object"===a(c)&&(!c.HTMLMediaElement||"srcObject"in c.HTMLMediaElement.prototype||Object.defineProperty(c.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;this._srcObject=a;this.src&&b.revokeObjectURL(this.src);a?(this.src=b.createObjectURL(a),a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)}),a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)})):
this.src=""}}))},shimPeerConnection:function(b){var f=d.detectBrowser(b);if(b.RTCPeerConnection){var e=b.RTCPeerConnection;b.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var b=[],f=0;f<a.iceServers.length;f++){var h=a.iceServers[f];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),(h=JSON.parse(JSON.stringify(h))).urls=h.url,b.push(h)):b.push(a.iceServers[f])}a.iceServers=b}return new e(a,c)};b.RTCPeerConnection.prototype=e.prototype;
Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}else b.RTCPeerConnection=function(a,d){return c("PeerConnection"),a&&a.iceTransportPolicy&&(a.iceTransports=a.iceTransportPolicy),new b.webkitRTCPeerConnection(a,d)},b.RTCPeerConnection.prototype=b.webkitRTCPeerConnection.prototype,b.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(b.RTCPeerConnection,"generateCertificate",{get:function(){return b.webkitRTCPeerConnection.generateCertificate}});
var h=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=function(a,c,b){var d=this,f=arguments;if(0<arguments.length&&"function"==typeof a)return h.apply(this,arguments);if(0===h.length&&(0===arguments.length||"function"!=typeof arguments[0]))return h.apply(this,[]);var e=function(a){var c={};return a.result().forEach(function(a){var b={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(c){b[c]=
a.stat(c)});c[b.id]=b}),c},m=function(a){return new Map(Object.keys(a).map(function(c){return[c,a[c]]}))};return 2<=arguments.length?h.apply(this,[function(a){f[1](m(e(a)))},arguments[0]]):(new Promise(function(a,c){h.apply(d,[function(c){a(m(e(c)))},c])})).then(c,b)};51>f.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){var a=arguments,b=this,d=new Promise(function(d,f){c.apply(b,
[a[0],d,f])});return 2>a.length?d:d.then(function(){a[1].apply(null,[])},function(c){3<=a.length&&a[2].apply(null,[c])})}});52>f.version&&["createOffer","createAnswer"].forEach(function(c){var d=b.RTCPeerConnection.prototype[c];b.RTCPeerConnection.prototype[c]=function(){var c=this;if(1>arguments.length||1===arguments.length&&"object"===a(arguments[0])){var b=1===arguments.length?arguments[0]:void 0;return new Promise(function(a,f){d.apply(c,[a,f,b])})}return d.apply(this,arguments)}});["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a];b.RTCPeerConnection.prototype[a]=function(){return arguments[0]=new ("addIceCandidate"===a?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}});var l=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?l.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},shimGetUserMedia:b("./getusermedia")}},
{"../utils.js":13,"./getusermedia":6}],6:[function(b,e,h){var d=b("../utils.js"),c=d.log;e.exports=function(b){var f=d.detectBrowser(b),e=b&&b.navigator,h=function(c){if("object"!==a(c)||c.mandatory||c.optional)return c;var b={};return Object.keys(c).forEach(function(d){if("require"!==d&&"advanced"!==d&&"mediaSource"!==d){var f="object"===a(c[d])?c[d]:{ideal:c[d]};void 0!==f.exact&&"number"==typeof f.exact&&(f.min=f.max=f.exact);var e=function(a,c){return a?a+c.charAt(0).toUpperCase()+c.slice(1):
"deviceId"===c?"sourceId":c};if(void 0!==f.ideal){b.optional=b.optional||[];var h={};"number"==typeof f.ideal?(h[e("min",d)]=f.ideal,b.optional.push(h),(h={})[e("max",d)]=f.ideal,b.optional.push(h)):(h[e("",d)]=f.ideal,b.optional.push(h))}void 0!==f.exact&&"number"!=typeof f.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",d)]=f.exact):["min","max"].forEach(function(a){void 0!==f[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,d)]=f[a])})}}),c.advanced&&(b.optional=(b.optional||[]).concat(c.advanced)),
b},l=function(b,d){if((b=JSON.parse(JSON.stringify(b)))&&"object"===a(b.audio)){var k=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])};k((b=JSON.parse(JSON.stringify(b))).audio,"autoGainControl","googAutoGainControl");k(b.audio,"noiseSuppression","googNoiseSuppression");b.audio=h(b.audio)}if(b&&"object"===a(b.video)){var m=b.video.facingMode;m=m&&("object"===a(m)?m:{ideal:m});var l;k=66>f.version;if(!(!m||"user"!==m.exact&&"environment"!==m.exact&&"user"!==m.ideal&&"environment"!==m.ideal||
e.mediaDevices.getSupportedConstraints&&e.mediaDevices.getSupportedConstraints().facingMode&&!k)&&(delete b.video.facingMode,"environment"===m.exact||"environment"===m.ideal?l=["back","rear"]:"user"!==m.exact&&"user"!==m.ideal||(l=["front"]),l))return e.mediaDevices.enumerateDevices().then(function(a){var f=(a=a.filter(function(a){return"videoinput"===a.kind})).find(function(a){return l.some(function(c){return-1!==a.label.toLowerCase().indexOf(c)})});return!f&&a.length&&-1!==l.indexOf("back")&&(f=
a[a.length-1]),f&&(b.video.deviceId=m.exact?{exact:f.deviceId}:{ideal:f.deviceId}),b.video=h(b.video),c("chrome: "+JSON.stringify(b)),d(b)});b.video=h(b.video)}return c("chrome: "+JSON.stringify(b)),d(b)},n=function(a){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[a.name]||
a.name,message:a.message,constraint:a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};e.getUserMedia=function(a,c,b){l(a,function(a){e.webkitGetUserMedia(a,c,function(a){b&&b(n(a))})})};var r=function(a){return new Promise(function(c,b){e.getUserMedia(a,c,b)})};if(e.mediaDevices||(e.mediaDevices={getUserMedia:r,enumerateDevices:function(){return new Promise(function(a){var c={audio:"audioinput",video:"videoinput"};return b.MediaStreamTrack.getSources(function(b){a(b.map(function(a){return{label:a.label,
kind:c[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),e.mediaDevices.getUserMedia){var q=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(a){return l(a,function(a){return q(a).then(function(c){if(a.audio&&!c.getAudioTracks().length||a.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");
return c},function(a){return Promise.reject(n(a))})})}}else e.mediaDevices.getUserMedia=function(a){return r(a)};void 0===e.mediaDevices.addEventListener&&(e.mediaDevices.addEventListener=function(){c("Dummy mediaDevices.addEventListener called.")});void 0===e.mediaDevices.removeEventListener&&(e.mediaDevices.removeEventListener=function(){c("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":13}],7:[function(b,e,h){var d=b("sdp"),c=b("./utils");e.exports={shimRTCIceCandidate:function(c){if(!(c.RTCIceCandidate&&
"foundation"in c.RTCIceCandidate.prototype)){var b=c.RTCIceCandidate;c.RTCIceCandidate=function(c){"object"===a(c)&&c.candidate&&0===c.candidate.indexOf("a\x3d")&&((c=JSON.parse(JSON.stringify(c))).candidate=c.candidate.substr(2));var f=new b(c);c=d.parseCandidate(c.candidate);var e=Object.assign(f,c);return e.toJSON=function(){return{candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex,usernameFragment:e.usernameFragment}},e};(function(a,c,b){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;
var d=a.addEventListener;a.addEventListener=function(a,f){if(a!==c)return d.apply(this,arguments);var e=function(a){f(b(a))};return this._eventMap=this._eventMap||{},this._eventMap[f]=e,d.apply(this,[a,e])};var f=a.removeEventListener;a.removeEventListener=function(a,b){if(a!==c||!this._eventMap||!this._eventMap[b])return f.apply(this,arguments);var d=this._eventMap[b];return delete this._eventMap[b],f.apply(this,[a,d])};Object.defineProperty(a,"on"+c,{get:function(){return this["_on"+c]},set:function(a){this["_on"+
c]&&(this.removeEventListener(c,this["_on"+c]),delete this["_on"+c]);a&&this.addEventListener(c,this["_on"+c]=a)}})}})(c,"icecandidate",function(a){return a.candidate&&Object.defineProperty(a,"candidate",{value:new c.RTCIceCandidate(a.candidate),writable:"false"}),a})}},shimCreateObjectURL:function(b){var d=b&&b.URL;if("object"===a(b)&&b.HTMLMediaElement&&"srcObject"in b.HTMLMediaElement.prototype&&d.createObjectURL&&d.revokeObjectURL){var f=d.createObjectURL.bind(d),e=d.revokeObjectURL.bind(d),h=
new Map,l=0;d.createObjectURL=function(a){if("getTracks"in a){var b="polyblob:"+ ++l;return h.set(b,a),c.deprecated("URL.createObjectURL(stream)","elem.srcObject \x3d stream"),b}return f(a)};d.revokeObjectURL=function(a){e(a);h.delete(a)};var p=Object.getOwnPropertyDescriptor(b.HTMLMediaElement.prototype,"src");Object.defineProperty(b.HTMLMediaElement.prototype,"src",{get:function(){return p.get.apply(this)},set:function(a){return this.srcObject=h.get(a)||null,p.set.apply(this,[a])}});var q=b.HTMLMediaElement.prototype.setAttribute;
b.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=h.get(arguments[1])||null),q.apply(this,arguments)}}}}},{"./utils":13,sdp:2}],8:[function(a,b,e){var d=a("../utils"),c=a("rtcpeerconnection-shim");b.exports={shimGetUserMedia:a("./getusermedia"),shimPeerConnection:function(a){var b=d.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=
function(a){return a}),15025>b.version)){var f=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){f.set.call(this,a);var c=new Event("enabled");c.enabled=a;this.dispatchEvent(c)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===
this.track.kind&&(this._dtmf=null)),this._dtmf}});a.RTCPeerConnection=c(a,b.version)},shimReplaceTrack:function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)}}},{"../utils":13,"./getusermedia":9,"rtcpeerconnection-shim":1}],9:[function(a,b,e){b.exports=function(a){a=a&&a.navigator;var c=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(a){return c(a).catch(function(a){return Promise.reject(function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||
a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}}(a))})}}},{}],10:[function(b,e,h){var d=b("../utils");e.exports={shimOnTrack:function(c){"object"!==a(c)||!c.RTCPeerConnection||"ontrack"in c.RTCPeerConnection.prototype||Object.defineProperty(c.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",
this._ontrack=a);this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(c){var b=new Event("track");b.track=c;b.receiver={track:c};b.transceiver={receiver:b.receiver};b.streams=[a.stream];this.dispatchEvent(b)}.bind(this))}.bind(this))}});"object"===a(c)&&c.RTCTrackEvent&&"receiver"in c.RTCTrackEvent.prototype&&!("transceiver"in c.RTCTrackEvent.prototype)&&Object.defineProperty(c.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},
shimSourceObject:function(c){"object"===a(c)&&(!c.HTMLMediaElement||"srcObject"in c.HTMLMediaElement.prototype||Object.defineProperty(c.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(c){var b=d.detectBrowser(c);if("object"===a(c)&&(c.RTCPeerConnection||c.mozRTCPeerConnection)){c.RTCPeerConnection||(c.RTCPeerConnection=function(a,d){if(38>b.version&&a&&a.iceServers){for(var f=[],e=0;e<a.iceServers.length;e++){var h=
a.iceServers[e];if(h.hasOwnProperty("urls"))for(var m=0;m<h.urls.length;m++){var l={url:h.urls[m]};0===h.urls[m].indexOf("turn")&&(l.username=h.username,l.credential=h.credential);f.push(l)}else f.push(a.iceServers[e])}a.iceServers=f}return new c.mozRTCPeerConnection(a,d)},c.RTCPeerConnection.prototype=c.mozRTCPeerConnection.prototype,c.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(c.RTCPeerConnection,"generateCertificate",{get:function(){return c.mozRTCPeerConnection.generateCertificate}}),
c.RTCSessionDescription=c.mozRTCSessionDescription,c.RTCIceCandidate=c.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var b=c.RTCPeerConnection.prototype[a];c.RTCPeerConnection.prototype[a]=function(){return arguments[0]=new ("addIceCandidate"===a?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]),b.apply(this,arguments)}});var e=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?
e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var h={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(a,c,d){return l.apply(this,[a||null]).then(function(a){if(48>b.version&&(a=function(a){var c=new Map;return Object.keys(a).forEach(function(b){c.set(b,a[b]);c[b]=a[b]}),
c}(a)),53>b.version&&!c)try{a.forEach(function(a){a.type=h[a.type]||a.type})}catch(k){if("TypeError"!==k.name)throw k;a.forEach(function(c,b){a.set(b,Object.assign({},c,{type:h[c.type]||c.type}))})}return a}).then(c,d)}}},shimGetUserMedia:b("./getusermedia")}},{"../utils":13,"./getusermedia":11}],11:[function(b,e,h){var d=b("../utils"),c=d.log;e.exports=function(b){var e=d.detectBrowser(b),f=b&&b.navigator;b=b&&b.MediaStreamTrack;var h=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",
PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},l=function(b,d,k){var m=function(c){if("object"!==a(c)||c.require)return c;var b=[];return Object.keys(c).forEach(function(d){if("require"!==d&&"advanced"!==d&&"mediaSource"!==
d){var f=c[d]="object"===a(c[d])?c[d]:{ideal:c[d]};if(void 0===f.min&&void 0===f.max&&void 0===f.exact||b.push(d),void 0!==f.exact&&("number"==typeof f.exact?f.min=f.max=f.exact:c[d]=f.exact,delete f.exact),void 0!==f.ideal){c.advanced=c.advanced||[];var e={};"number"==typeof f.ideal?e[d]={min:f.ideal,max:f.ideal}:e[d]=f.ideal;c.advanced.push(e);delete f.ideal;Object.keys(f).length||delete c[d]}}}),b.length&&(c.require=b),c};return b=JSON.parse(JSON.stringify(b)),38>e.version&&(c("spec: "+JSON.stringify(b)),
b.audio&&(b.audio=m(b.audio)),b.video&&(b.video=m(b.video)),c("ff37: "+JSON.stringify(b))),f.mozGetUserMedia(b,d,function(a){k(h(a))})};if(f.mediaDevices||(f.mediaDevices={getUserMedia:function(a){return new Promise(function(c,b){l(a,c,b)})},addEventListener:function(){},removeEventListener:function(){}}),f.mediaDevices.enumerateDevices=f.mediaDevices.enumerateDevices||function(){return new Promise(function(a){a([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",
label:"",groupId:""}])})},41>e.version){var n=f.mediaDevices.enumerateDevices.bind(f.mediaDevices);f.mediaDevices.enumerateDevices=function(){return n().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a;})}}if(49>e.version){var p=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(a){return p(a).then(function(c){if(a.audio&&!c.getAudioTracks().length||a.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(a){a.stop()}),new DOMException("The object can not be found here.",
"NotFoundError");return c},function(a){return Promise.reject(h(a))})}}if(!(55<e.version&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var q=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])},k=f.mediaDevices.getUserMedia.bind(f.mediaDevices);if(f.mediaDevices.getUserMedia=function(c){return"object"===a(c)&&"object"===a(c.audio)&&(c=JSON.parse(JSON.stringify(c)),q(c.audio,"autoGainControl","mozAutoGainControl"),q(c.audio,"noiseSuppression","mozNoiseSuppression")),k(c)},b&&
b.prototype.getSettings){var t=b.prototype.getSettings;b.prototype.getSettings=function(){var a=t.apply(this,arguments);return q(a,"mozAutoGainControl","autoGainControl"),q(a,"mozNoiseSuppression","noiseSuppression"),a}}if(b&&b.prototype.applyConstraints){var u=b.prototype.applyConstraints;b.prototype.applyConstraints=function(c){return"audio"===this.kind&&"object"===a(c)&&(c=JSON.parse(JSON.stringify(c)),q(c,"autoGainControl","mozAutoGainControl"),q(c,"noiseSuppression","mozNoiseSuppression")),u.apply(this,
[c])}}}f.getUserMedia=function(a,c,b){if(44>e.version)return l(a,c,b);d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");f.mediaDevices.getUserMedia(a).then(c,b)}}},{"../utils":13}],12:[function(b,e,h){var d=b("../utils");e.exports={shimCallbacksAPI:function(c){if("object"===a(c)&&c.RTCPeerConnection){c=c.RTCPeerConnection.prototype;var b=c.createOffer,d=c.createAnswer,e=c.setLocalDescription,h=c.setRemoteDescription,l=c.addIceCandidate;c.createOffer=function(a,c){var d=
b.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return c?(d.then(a,c),Promise.resolve()):d};c.createAnswer=function(a,c){var b=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return c?(b.then(a,c),Promise.resolve()):b};var n=function(a,c,b){a=e.apply(this,[a]);return b?(a.then(c,b),Promise.resolve()):a};c.setLocalDescription=n;n=function(a,c,b){a=h.apply(this,[a]);return b?(a.then(c,b),Promise.resolve()):a};c.setRemoteDescription=n;n=function(a,c,b){a=l.apply(this,[a]);
return b?(a.then(c,b),Promise.resolve()):a};c.addIceCandidate=n}},shimLocalStreamsAPI:function(c){if("object"===a(c)&&c.RTCPeerConnection){if("getLocalStreams"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getStreamById=function(a){var c=null;return this._localStreams&&this._localStreams.forEach(function(b){b.id===
a&&(c=b)}),this._remoteStreams&&this._remoteStreams.forEach(function(b){b.id===a&&(c=b)}),c}),!("addStream"in c.RTCPeerConnection.prototype)){var b=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]);-1===this._localStreams.indexOf(a)&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(d){b.call(c,d,a)})};c.RTCPeerConnection.prototype.addTrack=function(a,c){c&&(this._localStreams?-1===this._localStreams.indexOf(c)&&
this._localStreams.push(c):this._localStreams=[c]);b.call(this,a,c)}}"removeStream"in c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(a);if(-1!==c){this._localStreams.splice(c,1);var b=this,d=a.getTracks();this.getSenders().forEach(function(a){-1!==d.indexOf(a.track)&&b.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(c){"object"===a(c)&&c.RTCPeerConnection&&("getRemoteStreams"in
c.RTCPeerConnection.prototype||(c.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in c.RTCPeerConnection.prototype||Object.defineProperty(c.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);
this.addEventListener("track",this._onaddstreampoly=function(a){var c=a.streams[0];(this._remoteStreams||(this._remoteStreams=[]),0<=this._remoteStreams.indexOf(c))||(this._remoteStreams.push(c),c=new Event("addstream"),c.stream=a.streams[0],this.dispatchEvent(c))}.bind(this))}}))},shimGetUserMedia:function(a){var c=a&&a.navigator;c.getUserMedia||(c.webkitGetUserMedia?c.getUserMedia=c.webkitGetUserMedia.bind(c):c.mediaDevices&&c.mediaDevices.getUserMedia&&(c.getUserMedia=function(a,b,d){c.mediaDevices.getUserMedia(a).then(b,
d)}.bind(c)))},shimRTCIceServerUrls:function(a){var c=a.RTCPeerConnection;a.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var e=[],f=0;f<a.iceServers.length;f++){var h=a.iceServers[f];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),(h=JSON.parse(JSON.stringify(h))).urls=h.url,delete h.url,e.push(h)):e.push(a.iceServers[f])}a.iceServers=e}return new c(a,b)};a.RTCPeerConnection.prototype=c.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return c.generateCertificate}})},shimTrackEventTransceiver:function(c){"object"===a(c)&&c.RTCPeerConnection&&"receiver"in c.RTCTrackEvent.prototype&&!c.RTCTransceiver&&Object.defineProperty(c.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(a){var c=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){var b=
this.getTransceivers().find(function(a){return a.sender.track&&"audio"===a.sender.track.kind});!1===a.offerToReceiveAudio&&b?"sendrecv"===b.direction?b.setDirection("sendonly"):"recvonly"===b.direction&&b.setDirection("inactive"):!0!==a.offerToReceiveAudio||b||this.addTransceiver("audio");b=this.getTransceivers().find(function(a){return a.sender.track&&"video"===a.sender.track.kind});!1===a.offerToReceiveVideo&&b?"sendrecv"===b.direction?b.setDirection("sendonly"):"recvonly"===b.direction&&b.setDirection("inactive"):
!0!==a.offerToReceiveVideo||b||this.addTransceiver("video")}return c.apply(this,arguments)}}}},{"../utils":13}],13:[function(b,e,h){var d=!0,c=!0;b={disableLog:function(c){return"boolean"!=typeof c?Error("Argument type: "+a(c)+". Please use a boolean."):(d=c,c?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(b){return"boolean"!=typeof b?Error("Argument type: "+a(b)+". Please use a boolean."):(c=!b,"adapter.js deprecation warnings "+(b?"disabled":"enabled"))},log:function(){"object"!==
("undefined"==typeof window?"undefined":a(window))||d||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},deprecated:function(a,b){c&&console.warn(a+" is deprecated, please use "+b+" instead.")},extractVersion:function(a,c,b){return(a=a.match(c))&&a.length>=b&&parseInt(a[b],10)},detectBrowser:function(a){var c=a&&a.navigator,b={browser:null,version:null};if(void 0===a||!a.navigator)return b.browser="Not a browser.",b;if(c.mozGetUserMedia)b.browser="firefox",
b.version=this.extractVersion(c.userAgent,/Firefox\/(\d+)\./,1);else if(c.webkitGetUserMedia)if(a.webkitRTCPeerConnection)b.browser="chrome",b.version=this.extractVersion(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!c.userAgent.match(/Version\/(\d+).(\d+)/))return b.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",b;b.browser="safari";b.version=this.extractVersion(c.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/))b.browser=
"edge",b.version=this.extractVersion(c.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!c.mediaDevices||!c.userAgent.match(/AppleWebKit\/(\d+)\./))return b.browser="Not a supported browser.",b;b.browser="safari";b.version=this.extractVersion(c.userAgent,/AppleWebKit\/(\d+)\./,1)}return b}};e.exports={log:b.log,deprecated:b.deprecated,disableLog:b.disableLog,disableWarnings:b.disableWarnings,extractVersion:b.extractVersion,shimCreateObjectURL:b.shimCreateObjectURL,detectBrowser:b.detectBrowser.bind(b)}},
{}]},{},[3])(3)})}).call(this,l(18))},function(h,p,l){l(32)(l(33))},function(h,p){h.exports=function(h){function b(a){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",a)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(h):"undefined"!=typeof eval?eval.call(null,h):b("EvalError: No eval function available")}catch(a){b(a)}}},function(h,p){h.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\r\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\r\n* directory of this distribution and at\r\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\r\n*/\nthis.L \x3d this.L || {};\n/**\r\n * @param {HTMLElement} element\r\n * @param {String}      prop\r\n * @returns {String|Number}\r\n */\n\nL.GetComputedStyle \x3d function (computedElement, prop) {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n\n  return computedElement.style[prop];\n};\n/**\r\n *\r\n * @type {Function}\r\n * @constructor\r\n */\n\n\nL.ElementQueries \x3d function ElementQueries() {\n  /**\r\n   *\r\n   * @param element\r\n   * @returns {Number}\r\n   */\n  function getEmSize() {\n    var element \x3d arguments.length \x3e 0 \x26\x26 arguments[0] !\x3d\x3d undefined ? arguments[0] : document.documentElement;\n    var fontSize \x3d L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n  /**\r\n   *\r\n   * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\r\n   *\r\n   * @param element\r\n   * @param value\r\n   * @param units\r\n   * @returns {*}\r\n   */\n\n\n  function convertToPx(element, originalValue) {\n    var vh;\n    var vw;\n    var chooser;\n    var units \x3d originalValue.replace(/[0-9]*/, '');\n    var value \x3d parseFloat(originalValue);\n\n    switch (units) {\n      case 'px':\n        return value;\n\n      case 'em':\n        return value * getEmSize(element);\n\n      case 'rem':\n        return value * getEmSize();\n      // Viewport units!\n      // According to http://quirksmode.org/mobile/tableViewport.html\n      // documentElement.clientWidth/Height gets us the most reliable info\n\n      case 'vw':\n        return value * document.documentElement.clientWidth / 100;\n\n      case 'vh':\n        return value * document.documentElement.clientHeight / 100;\n\n      case 'vmin':\n      case 'vmax':\n        vw \x3d document.documentElement.clientWidth / 100;\n        vh \x3d document.documentElement.clientHeight / 100;\n        chooser \x3d Math[units \x3d\x3d\x3d 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n\n      default:\n        return value;\n      // for now, not supporting physical units (since they are just a set number of px)\n      // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n  /**\r\n   *\r\n   * @param {HTMLElement} element\r\n   * @constructor\r\n   */\n\n\n  function SetupInformation(element) {\n    var _this \x3d this;\n\n    this.element \x3d element;\n    this.options \x3d [];\n    var i;\n    var j;\n    var option;\n    var width \x3d 0;\n    var height \x3d 0;\n    var value;\n    var actualValue;\n    var attrValues;\n    var attrValue;\n    var attrName;\n    /**\r\n     * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\r\n     */\n\n    this.addOption \x3d function (newOption) {\n      _this.options.push(newOption);\n    };\n\n    var attributes \x3d ['min-width', 'min-height', 'max-width', 'max-height'];\n    /**\r\n     * Extracts the computed width/height and sets to min/max- attribute.\r\n     */\n\n    this.call \x3d function () {\n      // extract current dimensions\n      width \x3d _this.element.offsetWidth;\n      height \x3d _this.element.offsetHeight;\n      attrValues \x3d {};\n\n      for (i \x3d 0, j \x3d _this.options.length; i \x3c j; i +\x3d 1) {\n        option \x3d _this.options[i];\n        value \x3d convertToPx(_this.element, option.value);\n        actualValue \x3d option.property \x3d\x3d\x3d 'width' ? width : height;\n        attrName \x3d \"\".concat(option.mode, \"-\").concat(option.property);\n        attrValue \x3d '';\n\n        if (option.mode \x3d\x3d\x3d 'min' \x26\x26 actualValue \x3e\x3d value) {\n          attrValue +\x3d option.value;\n        }\n\n        if (option.mode \x3d\x3d\x3d 'max' \x26\x26 actualValue \x3c\x3d value) {\n          attrValue +\x3d option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] \x3d '';\n\n        if (attrValue \x26\x26 \" \".concat(attrValues[attrName], \" \").indexOf(\" \".concat(attrValue, \" \")) \x3d\x3d\x3d -1) {\n          attrValues[attrName] +\x3d \" \".concat(attrValue);\n        }\n      }\n\n      for (var k \x3d 0; k \x3c attributes.length; k +\x3d 1) {\n        if (attrValues[attributes[k]]) {\n          _this.element.setAttribute(attributes[k], attrValues[attributes[k]].substr(1));\n        } else {\n          _this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n  /**\r\n   * @param {HTMLElement} element\r\n   * @param {Object}      options\r\n   */\n\n\n  function setupElement(originalElement, options) {\n    var element \x3d originalElement;\n\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation \x3d new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor \x3d new L.ResizeSensor(element, function () {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n  /**\r\n   * @param {String} selector\r\n   * @param {String} mode min|max\r\n   * @param {String} property width|height\r\n   * @param {String} value\r\n   */\n\n\n  function queueQuery(selector, mode, property, value) {\n    var query;\n    if (document.querySelectorAll) query \x3d document.querySelectorAll.bind(document);\n    if (!query \x26\x26 typeof $$ !\x3d\x3d 'undefined') query \x3d $$;\n    if (!query \x26\x26 typeof jQuery !\x3d\x3d 'undefined') query \x3d jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    var elements \x3d query(selector) || [];\n\n    for (var i \x3d 0, j \x3d elements.length; i \x3c j; i +\x3d 1) {\n      elements[i] \x3d setupElement(elements[i], {\n        mode: mode,\n        property: property,\n        value: value\n      });\n    }\n  }\n\n  var regex \x3d /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?\x3d[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi; // jshint ignore:line\n\n  /**\r\n   * @param {String} css\r\n   */\n\n  function extractQuery(originalCss) {\n    var match;\n    var css \x3d originalCss.replace(/'/g, '\"');\n\n    while ((match \x3d regex.exec(css)) !\x3d\x3d null) {\n      if (match.length \x3e 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n  /**\r\n   * @param {CssRule[]|String} rules\r\n   */\n\n\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n\n    var selector \x3d '';\n    var rules \x3d originalRules;\n\n    if (typeof originalRules \x3d\x3d\x3d 'string') {\n      rules \x3d originalRules.toLowerCase();\n\n      if (rules.indexOf('min-width') !\x3d\x3d -1 || rules.indexOf('max-width') !\x3d\x3d -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (var i \x3d 0, j \x3d rules.length; i \x3c j; i +\x3d 1) {\n        if (rules[i].type \x3d\x3d\x3d 1) {\n          selector \x3d rules[i].selectorText || rules[i].cssText;\n\n          if (selector.indexOf('min-height') !\x3d\x3d -1 || selector.indexOf('max-height') !\x3d\x3d -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !\x3d\x3d -1 || selector.indexOf('max-width') !\x3d\x3d -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type \x3d\x3d\x3d 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n  /**\r\n   * Searches all css rules and setups the event listener\r\n   * to all elements with element query rules..\r\n   */\n\n\n  this.init \x3d function () {\n    var styleSheets \x3d document.styleSheets || [];\n\n    for (var i \x3d 0, j \x3d styleSheets.length; i \x3c j; i +\x3d 1) {\n      if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssText')) {\n        readRules(styleSheets[i].cssText);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssRules')) {\n        readRules(styleSheets[i].cssRules);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'rules')) {\n        readRules(styleSheets[i].rules);\n      }\n    }\n  };\n};\n\nfunction init() {\n  new L.ElementQueries().init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n/**\r\n * Iterate over each of the provided element(s).\r\n *\r\n * @param {HTMLElement|HTMLElement[]} elements\r\n * @param {Function}                  callback\r\n */\n\n\nfunction forEachElement(elements) {\n  var callback \x3d arguments.length \x3e 1 \x26\x26 arguments[1] !\x3d\x3d undefined ? arguments[1] : function () {};\n  var elementsType \x3d Object.prototype.toString.call(elements);\n  var isCollectionTyped \x3d elementsType \x3d\x3d\x3d '[object Array]' || elementsType \x3d\x3d\x3d '[object NodeList]' || elementsType \x3d\x3d\x3d '[object HTMLCollection]' || typeof jQuery !\x3d\x3d 'undefined' \x26\x26 elements instanceof jQuery || // jquery\n  typeof Elements !\x3d\x3d 'undefined' \x26\x26 elements instanceof Elements // mootools\n  ;\n  var i \x3d 0;\n  var j \x3d elements.length;\n\n  if (isCollectionTyped) {\n    for (; i \x3c j; i +\x3d 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n/**\r\n * Class for dimension change detection.\r\n *\r\n * @param {Element|Element[]|Elements|jQuery} element\r\n * @param {Function} callback\r\n *\r\n * @constructor\r\n */\n\n\nL.ResizeSensor \x3d function ResizeSensor(element) {\n  var callback \x3d arguments.length \x3e 1 \x26\x26 arguments[1] !\x3d\x3d undefined ? arguments[1] : function () {};\n\n  /**\r\n   *\r\n   * @constructor\r\n   */\n  function EventQueue() {\n    var q \x3d [];\n\n    this.add \x3d function (ev) {\n      q.push(ev);\n    };\n\n    var i;\n    var j;\n\n    this.call \x3d function () {\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove \x3d function (ev) {\n      var newQueue \x3d [];\n\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\n        if (q[i] !\x3d\x3d ev) newQueue.push(q[i]);\n      }\n\n      q \x3d newQueue;\n    };\n\n    this.length \x3d function () {\n      return q.length;\n    };\n  }\n  /**\r\n   *\r\n   * @param {HTMLElement} element\r\n   * @param {Function}    resized\r\n   */\n\n\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    var customRequestAnimationFrame \x3d window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || function delay(fn) {\n      return window.setTimeout(fn, 20);\n    };\n\n    var newElement \x3d htmlElement;\n\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached \x3d new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor \x3d document.createElement('div');\n    newElement.resizeSensor.className \x3d 'resize-sensor';\n    var style \x3d 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' + 'overflow: hidden; z-index: -1; visibility: hidden;';\n    var styleChild \x3d 'position: absolute; left: 0; top: 0; transition: 0s;';\n    newElement.resizeSensor.style.cssText \x3d style;\n    newElement.resizeSensor.innerHTML \x3d \"\x3cdiv class\x3d\\\"resize-sensor-expand\\\" style\x3d\\\"\".concat(style, \"\\\"\x3e\") + \"\x3cdiv style\x3d\\\"\".concat(styleChild, \"\\\"\x3e\x3c/div\x3e\") + '\x3c/div\x3e' + \"\x3cdiv class\x3d\\\"resize-sensor-shrink\\\" style\x3d\\\"\".concat(style, \"\\\"\x3e\") + \"\x3cdiv style\x3d\\\"\".concat(styleChild, \" width: 200%; height: 200%\\\"\x3e\x3c/div\x3e\") + '\x3c/div\x3e';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') \x3d\x3d\x3d 'static') {\n      newElement.style.position \x3d 'relative';\n    }\n\n    var expand \x3d newElement.resizeSensor.childNodes[0];\n    var expandChild \x3d expand.childNodes[0];\n    var shrink \x3d newElement.resizeSensor.childNodes[1];\n\n    var reset \x3d function reset() {\n      expandChild.style.width \x3d \"\".concat(100000, \"px\");\n      expandChild.style.height \x3d \"\".concat(100000, \"px\");\n      expand.scrollLeft \x3d 100000;\n      expand.scrollTop \x3d 100000;\n      shrink.scrollLeft \x3d 100000;\n      shrink.scrollTop \x3d 100000;\n    };\n\n    reset();\n    var dirty \x3d false;\n\n    var dirtyChecking \x3d function dirtyChecking() {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty \x3d false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    var lastWidth;\n    var lastHeight;\n    var cachedWidth;\n    var cachedHeight; // useful to not query offsetWidth twice\n\n    var onScroll \x3d function onScroll() {\n      if ((cachedWidth \x3d newElement.offsetWidth) !\x3d\x3d lastWidth || (cachedHeight \x3d newElement.offsetHeight) !\x3d\x3d lastHeight) {\n        dirty \x3d true;\n        lastWidth \x3d cachedWidth;\n        lastHeight \x3d cachedHeight;\n      }\n\n      reset();\n    };\n\n    var addEvent \x3d function addEvent(el, name, cb) {\n      if (el.attachEvent) {\n        el.attachEvent(\"on\".concat(name), cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, function (elem) {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach \x3d function (ev) {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach \x3d function (element, ev) {\n  forEachElement(element, function (elem) {\n    var elementItem \x3d elem;\n\n    if (elementItem.resizedAttached \x26\x26 typeof ev \x3d\x3d\x3d 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};"},
function(h,p,l){function b(a){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function w(a){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:
function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function e(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function");}function G(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function g(a,c,b){return c&&G(a.prototype,c),b&&G(a,b),a}function d(a,c){if(!c||"object"!==w(c)&&"function"!=typeof c){if(void 0===
a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}else a=c;return a}function z(a){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function u(a,c){return(u=Object.setPrototypeOf||function(a,c){return a.__proto__=c,a})(a,c)}function t(a){if(!(a=function(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++)b[c]=a[c];return b}}(a)||function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===
Object.prototype.toString.call(a))return Array.from(a)}(a)))throw new TypeError("Invalid attempt to spread non-iterable instance");return a}function c(a){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&
"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function E(a){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function m(a){if(!(a=function(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++)b[c]=a[c];return b}}(a)||function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===
Object.prototype.toString.call(a))return Array.from(a)}(a)))throw new TypeError("Invalid attempt to spread non-iterable instance");return a}l.r(p);h=l(1);var v=l.n(h),A={addSim:function(a){var c="a\x3dssrc-group:SIM";return a.forEach(function(a){c+=" ".concat(a)}),"".concat(c,"\r\n")},addGroup:function(a,c){return"a\x3dssrc-group:FID ".concat(a," ").concat(c,"\r\n")},addSpatialLayer:function(a,c,b,d,e,f){return"a\x3dssrc:".concat(e," cname:").concat(a,"\r\n")+"a\x3dssrc:".concat(e," msid:").concat(c,
"\r\n")+"a\x3dssrc:".concat(e," mslabel:").concat(b,"\r\n")+"a\x3dssrc:".concat(e," label:").concat(d,"\r\n")+"a\x3dssrc:".concat(f," cname:").concat(a,"\r\n")+"a\x3dssrc:".concat(f," msid:").concat(c,"\r\n")+"a\x3dssrc:".concat(f," mslabel:").concat(b,"\r\n")+"a\x3dssrc:".concat(f," label:").concat(d,"\r\n")},setMaxBW:function(a,c){if(c.p2p){if(c.video&&c.maxVideoBW){var b=a.getMedia("video");b&&b.setBitrate(c.maxVideoBW)}c.audio&&c.maxAudioBW&&(a=a.getMedia("audio"))&&a.setBitrate(c.maxAudioBW)}},
enableOpusNacks:function(a){var c=a.match(/a=rtpmap:(.*)opus.*\r\n/);if(null!==c){var b="".concat(c[0],"a\x3drtcp-fb:").concat(c[1],"nack\r\n");a=a.replace(c[0],b)}return a},setParamForCodecs:function(a,c,b,d){a.medias.forEach(function(a){a.id===c&&a.codecs.forEach(function(a){a.setParam(b,d)})})}},n=l(0),r=function(a){var c,d,e,f,g={},h=[],k=!1,l=-1;n.a.info("Starting Base stack",a);g.pcConfig={iceServers:[]};g.con={};void 0!==a.iceServers&&(g.pcConfig.iceServers=a.iceServers);!0===a.forceTurn&&
(g.pcConfig.iceTransportPolicy="relay");g.audio=a.audio;g.video=a.video;void 0===g.audio&&(g.audio=!0);void 0===g.video&&(g.video=!0);a.remoteCandidates=[];a.localCandidates=[];a.remoteDescriptionSet=!1;g.mediaConstraints={offerToReceiveVideo:void 0!==g.video&&!1!==g.video,offerToReceiveAudio:void 0!==g.audio&&!1!==g.audio};g.peerConnection=new RTCPeerConnection(g.pcConfig,g.con);var m=function(a,c,b){n.a.error("message:",b,"in baseStack at",a);void 0!==c&&c("error")},p=function(){if(!k&&0<h.length){var a=
h.pop();"local"===a[0]?g.createOffer(a[1],a[2],a[3]):r(a[1])}},q=function(b){c=b;e=v.a.SDPInfo.processString(c.sdp);A.setMaxBW(e,a);c.sdp=e.toString();g.localSdp=e;a.callback({type:c.type,sdp:c.sdp,config:{maxVideoBW:a.maxVideoBW}});n.a.info("Setting local description",c);g.peerConnection.setLocalDescription(c).then(function(){k=!1;p();n.a.info("Success in BaseStack",void 0)}).catch(m)};var r=function(c){k?h.push(["remote",c]):(k=!0,f=v.a.SDPInfo.processString(c.sdp),A.setMaxBW(f,a),c.sdp=f.toString(),
g.remoteSdp=f,g.peerConnection.setRemoteDescription(c).then(function(){g.peerConnection.createAnswer(g.mediaConstraints).then(q).catch(m.bind(null,"createAnswer",void 0));a.remoteDescriptionSet=!0}).catch(m.bind(null,"process Offer",void 0)))};return g.peerConnection.onicecandidate=function(c){var b={};(c=c.candidate)?(b={sdpMLineIndex:c.sdpMLineIndex,sdpMid:c.sdpMid,candidate:c.candidate}).candidate.match(/a=/)||(b.candidate="a\x3d".concat(b.candidate)):(n.a.info("Gathered all candidates. Sending END candidate"),
b={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});a.remoteDescriptionSet?a.callback({type:"candidate",candidate:b}):(a.localCandidates.push(b),n.a.info("Storing candidate: ",a.localCandidates.length,b))},g.setStartVideoBW=function(a){return n.a.error("startVideoBW not implemented for this browser"),a},g.setHardMinVideoBW=function(a){return n.a.error("hardMinVideoBw not implemented for this browser"),a},g.enableSimulcast=function(a){return n.a.error("Simulcast not implemented"),a},g.close=function(){g.state=
"closed";g.peerConnection.close()},g.setSimulcast=function(a){g.simulcast=a},g.setVideo=function(a){g.video=a},g.setAudio=function(a){g.audio=a},g.updateSpec=function(b,h){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},D=!a.p2p&&b.maxVideoBW;(a.p2p&&b.maxVideoBW||b.maxAudioBW)&&(b.maxVideoBW&&(n.a.debug("Maxvideo Requested:",b.maxVideoBW,"limit:",a.limitMaxVideoBW),b.maxVideoBW>a.limitMaxVideoBW&&(b.maxVideoBW=a.limitMaxVideoBW),a.maxVideoBW=b.maxVideoBW,n.a.debug("Result",
a.maxVideoBW)),b.maxAudioBW&&(b.maxAudioBW>a.limitMaxAudioBW&&(b.maxAudioBW=a.limitMaxAudioBW),a.maxAudioBW=b.maxAudioBW),e=v.a.SDPInfo.processString(c.sdp),A.setMaxBW(e,a),c.sdp=e.toString(),g.localSdp=e,b.Sdp||b.maxAudioBW?(n.a.debug("Updating with SDP renegotiation",a.maxVideoBW,a.maxAudioBW),g.peerConnection.setLocalDescription(c).then(function(){return f=v.a.SDPInfo.processString(d.sdp),A.setMaxBW(f,a),d.sdp=f.toString(),g.remoteSdp=f,g.peerConnection.setRemoteDescription(new RTCSessionDescription(d))}).then(function(){a.remoteDescriptionSet=
!0;a.callback({type:"updatestream",sdp:c.sdp},h)}).catch(m.bind(null,"updateSpec",k))):(n.a.debug("Updating without SDP renegotiation, newVideoBW:",a.maxVideoBW,"newAudioBW:",a.maxAudioBW),a.callback({type:"updatestream",sdp:c.sdp},h)));(D||b.minVideoBW||void 0!==b.slideShowMode||void 0!==b.muteStream||void 0!==b.qualityLayer||void 0!==b.minLayer||void 0!==b.video)&&(n.a.debug("MaxVideoBW Changed to ",b.maxVideoBW),n.a.debug("MinVideo Changed to ",b.minVideoBW),n.a.debug("SlideShowMode Changed to ",
b.slideShowMode),n.a.debug("muteStream changed to ",b.muteStream),n.a.debug("Video Constraints",b.video),a.callback({type:"updatestream",config:b},h))},g.createOffer=function(){var b=0<arguments.length&&void 0!==arguments[0]&&arguments[0],d=1<arguments.length&&void 0!==arguments[1]&&arguments[1],f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";b||d||(g.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});k?h.push(["local",b,d,f]):(k=!0,n.a.debug("Creating offer",g.mediaConstraints,
f),g.peerConnection.createOffer(g.mediaConstraints).then(function(b,d,f){c=f;b||(c.sdp=g.enableSimulcast(c.sdp));e=v.a.SDPInfo.processString(c.sdp);A.setMaxBW(e,a);c.sdp=e.toString();g.localSdp=e;a.callback({type:c.type,sdp:c.sdp,config:{maxVideoBW:a.maxVideoBW}},d)}.bind(null,b,f)).catch(m.bind(null,"Create Offer",void 0)))},g.addStream=function(a){g.peerConnection.addStream(a)},g.removeStream=function(a){g.peerConnection.removeStream(a)},g.processSignalingMessage=function(e){"offer"===e.type?r(e):
"answer"===e.type?function(b){var e=(f=v.a.SDPInfo.processString(b.sdp))&&f.origin&&f.origin.sessionVersion;l>=e||(n.a.info("Set remote and local description"),l=e,A.setMaxBW(f,a),g.setStartVideoBW(f),g.setHardMinVideoBW(f),b.sdp=f.toString(),n.a.debug("Remote Description",b.sdp),n.a.debug("Local Description",c.sdp),g.remoteSdp=f,d=b,g.peerConnection.setLocalDescription(c).then(function(){g.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).then(function(){a.remoteDescriptionSet=!0;
for(n.a.info("Candidates to be added: ",a.remoteCandidates.length,a.remoteCandidates);0<a.remoteCandidates.length;)g.peerConnection.addIceCandidate(a.remoteCandidates.shift());for(n.a.info("Local candidates to send:",a.localCandidates.length);0<a.localCandidates.length;)a.callback({type:"candidate",candidate:a.localCandidates.shift()});k=!1;p()}).catch(m.bind(null,"processAnswer",void 0))}).catch(m.bind(null,"processAnswer",void 0)))}(e):"candidate"===e.type&&function(c){try{var d;if("end"!==(d="object"===
b(c.candidate)?c.candidate:JSON.parse(c.candidate)).candidate){d.candidate=d.candidate.replace(/a=/g,"");d.sdpMLineIndex=parseInt(d.sdpMLineIndex,10);var e=new RTCIceCandidate(d);a.remoteDescriptionSet?g.peerConnection.addIceCandidate(e):a.remoteCandidates.push(e)}}catch(ea){n.a.error("Error parsing candidate",c.candidate)}}(e)},g},q=function(a){n.a.info("Starting Chrome stable stack",a);var c=r(a);return c.enableSimulcast=function(a){var b=a;if(!c.simulcast)return b;a=b.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);
if(!a||0>=a.length)return b;var d=c.simulcast.numSpatialLayers||2;var e=parseInt(a[1],10),f=parseInt(a[2],10),g=b.match(new RegExp("a\x3dssrc:".concat(a[1]," cname:(.*)\r?\n")))[1],h=b.match(new RegExp("a\x3dssrc:".concat(a[1]," msid:(.*)\r?\n")))[1],k=b.match(new RegExp("a\x3dssrc:".concat(a[1]," mslabel:(.*)\r?\n")))[1],C=b.match(new RegExp("a\x3dssrc:".concat(a[1]," label:(.*)\r?\n")))[1];b.match(new RegExp("a\x3dssrc:".concat(a[1],".*\r?\n"),"g")).forEach(function(a){b=b.replace(a,"")});b.match(new RegExp("a\x3dssrc:".concat(a[2],
".*\r?\n"),"g")).forEach(function(a){b=b.replace(a,"")});for(var D=[e],l=[f],m=1;m<d;m+=1)D.push(e+1E3*m),l.push(f+1E3*m);d=A.addSim(D);for(m=0;m<D.length;m+=1)e=D[m],f=l[m],d+=A.addGroup(e,f);for(m=0;m<D.length;m+=1)e=D[m],f=l[m],d+=A.addSpatialLayer(g,h,k,C,e,f);return d+="a\x3dx-google-flag:conference\r\n",b.replace(a[0],d)},c.setStartVideoBW=function(b){c.video&&a.startVideoBW&&(n.a.debug("startVideoBW requested: ".concat(a.startVideoBW)),A.setParamForCodecs(b,"video","x-google-start-bitrate",
a.startVideoBW))},c.setHardMinVideoBW=function(b){c.video&&a.hardMinVideoBW&&(n.a.debug("hardMinVideoBW requested: ".concat(a.hardMinVideoBW)),A.setParamForCodecs(b,"video","x-google-min-bitrate",a.hardMinVideoBW))},c},k=function(a){n.a.info("Starting Firefox stack");var c=r(a),b=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],d=function(){if(!c.simulcast)return[];var a=[];return c.peerConnection.getSenders().forEach(function(d){"video"===d.track.kind&&a.push(function(a){var d=
c.simulcast.numSpatialLayers||2,e=b.length;d=d<e?d:e;var f=a.getParameters()||{};f.encodings=[];for(var g=e-1;g>=e-d;--g)f.encodings.push(b[g]);return a.setParameters(f)}(d))}),a};c.enableSimulcast=function(a){return a};var e=c.createOffer;return c.createOffer=function(a){var c=1<arguments.length&&void 0!==arguments[1]&&arguments[1],b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",f=[];!0!==a&&(f=d());Promise.all(f).then(function(){e(a,c,b)})},c},y=function(a){var c={pcConfig:{},peerConnection:{},
desc:{},signalCallback:void 0,close:function(){n.a.info("Close FcStack")},createOffer:function(){n.a.debug("FCSTACK: CreateOffer")},addStream:function(a){n.a.debug("FCSTACK: addStream",a)},processSignalingMessage:function(a){n.a.debug("FCSTACK: processSignaling",a);void 0!==c.signalCallback&&c.signalCallback(a)},sendSignalingMessage:function(c){n.a.debug("FCSTACK: Sending signaling Message",c);a.callback(c)},setSignalingCallback:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
function(){};n.a.debug("FCSTACK: Setting signalling callback");c.signalCallback=a}};return c},x=function(){var a={},c={};return a.addEventListener=function(a,b){void 0===c[a]&&(c[a]=[]);c[a].push(b)},a.removeEventListener=function(a,b){c[a]&&(b=c[a].indexOf(b),-1!==b&&c[a].splice(b,1))},a.removeAllListeners=function(){c={}},a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");n.a.debug("Event: ".concat(a.type));for(var b=c[a.type]||[],d=0;d<b.length;d+=1)b[d](a)},a.on=a.addEventListener,
a.off=a.removeEventListener,a.emit=a.dispatchEvent,a},B=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");!0;this.emitter=x()}return function(c,b,d){b&&a(c.prototype,b);d&&a(c,d)}(c,[{key:"addEventListener",value:function(a,c){this.emitter.addEventListener(a,c)}},{key:"removeEventListener",value:function(a,c){this.emitter.removeEventListener(a,c)}},{key:"dispatchEvent",value:function(a){this.emitter.dispatchEvent(a)}},{key:"on",value:function(a,
c){this.addEventListener(a,c)}},{key:"off",value:function(a,c){this.removeEventListener(a,c)}},{key:"emit",value:function(a){this.dispatchEvent(a)}}]),c}(),I=function(a){var c={};return c.type=a.type,c},H=function(a){var c=I(a);return c.stream=a.stream,c.state=a.state,c},K=function(a){var c=I(a);return c.streams=a.streams,c.message=a.message,c},F=function(a){var c=I(a);return c.stream=a.stream,c.msg=a.msg,c.bandwidth=a.bandwidth,c.attrs=a.attrs,c},J=function(){var a={},c={};return a.add=function(a,
b){c[a]=b},a.get=function(a){return c[a]},a.has=function(a){return void 0!==c[a]},a.size=function(){return Object.keys(c).length},a.forEach=function(a){for(var b=Object.keys(c),d=0;d<b.length;d+=1){var e=b[d];a(c[e],e)}},a.keys=function(){return Object.keys(c)},a.remove=function(a){delete c[a]},a.clear=function(){c={}},a},M=l(2),R=103,N=function(a){function c(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;e(this,c);var f=d(this,z(c).call(this));n.a.debug("Building a new Connection");
f.stack={};f.erizoId=b;f.streamsMap=J();if(R+=1,a.sessionId=R,f.sessionId=R,f.browser=M.a.getBrowser(),"fake"===f.browser)n.a.warning("Publish/subscribe video/audio streams not supported in erizofc yet"),f.stack=y(a);else if("mozilla"===f.browser)n.a.debug("Firefox Stack"),f.stack=k(a);else{if("safari"===f.browser)n.a.debug("Safari using Chrome Stable Stack");else{if("chrome-stable"!==f.browser&&"electron"!==f.browser)throw n.a.error("No stack available for this browser"),Error("WebRTC stack not available");
n.a.debug("Chrome Stable Stack")}f.stack=q(a)}return f.stack.updateSpec||(f.stack.updateSpec=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};n.a.error("Update Configuration not implemented in this browser");c("unimplemented")}),f.stack.setSignallingCallback||(f.stack.setSignallingCallback=function(){n.a.error("setSignallingCallback is not implemented in this stack")}),f.stack.peerConnection&&(f.peerConnection=f.stack.peerConnection,f.stack.peerConnection.onaddstream=
function(a){f.emit(H({type:"add-stream",stream:a.stream}))},f.stack.peerConnection.onremovestream=function(a){f.emit(H({type:"remove-stream",stream:a.stream}))},f.stack.peerConnection.oniceconnectionstatechange=function(){f.emit(H({type:"ice-state-change",state:f.stack.peerConnection.iceConnectionState}))}),f}return function(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,
writable:!0,configurable:!0}});c&&u(a,c)}(c,B),g(c,[{key:"close",value:function(){n.a.debug("Closing ErizoConnection");this.streamsMap.clear();this.stack.close()}},{key:"createOffer",value:function(a,c,b){this.stack.createOffer(a,c,b)}},{key:"addStream",value:function(a){n.a.debug("message: Adding stream to Connection, streamId: ".concat(a.getID()));this.streamsMap.add(a.getID(),a);a.local&&this.stack.addStream(a.stream)}},{key:"removeStream",value:function(a){var c=a.getID();this.streamsMap.has(c)?
(a.local&&this.stack.removeStream(a.stream),this.streamsMap.remove(c)):n.a.warning("message: Cannot remove stream not in map, streamId: ".concat(c))}},{key:"processSignalingMessage",value:function(a){this.stack.processSignalingMessage(a)}},{key:"sendSignalingMessage",value:function(a){this.stack.sendSignalingMessage(a)}},{key:"setSimulcast",value:function(a){this.stack.setSimulcast(a)}},{key:"setVideo",value:function(a){this.stack.setVideo(a)}},{key:"setAudio",value:function(a){this.stack.setAudio(a)}},
{key:"updateSpec",value:function(a,c,b){this.stack.updateSpec(a,c,b)}}]),c}(),Y=function(){function a(){e(this,a);this.ErizoConnectionsMap=new Map}return g(a,[{key:"getOrBuildErizoConnection",value:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0,b=2<arguments.length&&void 0!==arguments[2]&&arguments[2];n.a.debug("message: getOrBuildErizoConnection, erizoId: ".concat(c));var d;if(void 0===c)return new N(a);b?(this.ErizoConnectionsMap.has(c)?d=this.ErizoConnectionsMap.get(c):
(d={},this.ErizoConnectionsMap.set(c,d)),d["single-pc"]||(d["single-pc"]=new N(a,c)),b=d["single-pc"]):(b=new N(a,c),this.ErizoConnectionsMap.has(c))?this.ErizoConnectionsMap.get(c)[b.sessionId]=b:(d={},d[b.sessionId]=b,this.ErizoConnectionsMap.set(c,d));return a.simulcast&&b.setSimulcast(a.simulcast),a.video&&b.setVideo(a.video),a.audio&&b.setVideo(a.audio),b}},{key:"maybeCloseConnection",value:function(a){n.a.debug("Trying to remove connection ".concat(a.sessionId,"\n       with erizoId ").concat(a.erizoId));
0===a.streamsMap.size()&&(a.close(),void 0!==this.ErizoConnectionsMap.get(a.erizoId)&&delete this.ErizoConnectionsMap.get(a.erizoId)[a.sessionId])}}]),a}();h=l(19);var Z=l.n(h),T=function(a){var c=x(),b=function(){},d=[];c.CONNECTED=Symbol("connected");c.RECONNECTING=Symbol("reconnecting");c.DISCONNECTED=Symbol("disconnected");var e;c.state=c.DISCONNECTED;c.IO=void 0===a?Z.a:a;var f=function(a){for(var b=arguments.length,d=Array(1<b?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];c.emit(function(a,c){a=I({type:a});
return a.args=c.args,a}(a,{args:d}))};return c.connect=function(a,g){var h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:b,k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:b,l=1E3,D=(e=c.IO.connect((a.secure?"wss://":"ws://")+a.host,{reconnection:!0,reconnectionAttempts:3,secure:a.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1})).io.engine.transport.ws.onclose;e.io.engine.transport.ws.onclose=function(a){n.a.warning("WebSocket closed, code:",a.code);l=a.code;D(a)};
c.socket=e;e.on("onAddStream",f.bind(c,"onAddStream"));e.on("signaling_message_erizo",f.bind(c,"signaling_message_erizo"));e.on("signaling_message_peer",f.bind(c,"signaling_message_peer"));e.on("publish_me",f.bind(c,"publish_me"));e.on("unpublish_me",f.bind(c,"unpublish_me"));e.on("onBandwidthAlert",f.bind(c,"onBandwidthAlert"));e.on("onDataStream",f.bind(c,"onDataStream"));e.on("onUpdateAttributeStream",f.bind(c,"onUpdateAttributeStream"));e.on("onRemoveStream",f.bind(c,"onRemoveStream"));e.on("disconnect",
function(a){n.a.debug("disconnect",c.id,a);1E3===l?(f("disconnect",a),e.close()):c.state=c.RECONNECTING});e.on("connection_failed",function(a){n.a.error("connection failed, id:",c.id);f("connection_failed",a)});e.on("error",function(a){n.a.warning("socket error, id:",c.id,", error:",a.message);f("error")});e.on("connect_error",function(a){n.a.warning("connect error, id:",c.id,", error:",a.message)});e.on("connect_timeout",function(a){n.a.warning("connect timeout, id:",c.id,", error:",a.message)});
e.on("reconnecting",function(a){n.a.debug("reconnecting, id:",c.id,", attempet:",a)});e.on("reconnect",function(a){n.a.debug("reconnected, id:",c.id,", attempet:",a);c.state=c.CONNECTED;e.emit("reconnected",c.id);c.state===c.CONNECTED&&d.forEach(function(a){c.sendMessage.apply(c,t(a))})});e.on("reconnect_attempt",function(a){n.a.debug("reconnect attempt, id:",c.id,", attempet:",a)});e.on("reconnect_error",function(a){n.a.debug("error reconnecting, id:",c.id,", error:",a.message)});e.on("reconnect_failed",
function(){n.a.warning("reconnect failed, id:",c.id);c.state=c.DISCONNECTED;f("disconnect","reconnect failed")});g.token=a;c.sendMessage("token",g,function(a){c.state=c.CONNECTED;c.id=a.clientId;h(a)},k)},c.disconnect=function(){c.state=c.DISCONNECTED;e.disconnect()},c.sendMessage=function(a,f){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:b,h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:b;c.state!==c.DISCONNECTED||"token"===a?c.state!==c.RECONNECTING?e.emit(a,f,function(a,
c){"success"===a?g(c):"error"===a?h(c):g(a,c)}):d.push([a,f,g,h]):n.a.error("Trying to send a message over a disconnected Socket")},c.sendSDP=function(a,d,f){var g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:b;c.state!==c.DISCONNECTED?e.emit(a,d,f,function(){g.apply(void 0,arguments)}):n.a.error("Trying to send a message over a disconnected Socket")},c},O=function(){var a=x({});return a.url=App&&App.staticUrl+"assets/img/weedeo",a},aa=function(a){var c=O({}),b=50;if(c.elementID=a.elementID,
c.media=a.media,c.id=a.id,c.stream=a.stream,c.div=document.createElement("div"),c.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;"),c.icon=document.createElement("img"),c.icon.setAttribute("id","volume_".concat(c.id)),c.icon.setAttribute("src","".concat(c.url,"/assets/sound48.png")),c.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;"),c.div.appendChild(c.icon),c.icon.onclick=function(){c.media.muted?(c.media.muted=
!1,c.icon.setAttribute("src","".concat(c.url,"/assets/sound48.png")),c.stream.local?c.stream.stream.getAudioTracks()[0].enabled=!0:(c.picker.value=b,c.media.volume=c.picker.value/100)):(c.media.muted=!0,c.icon.setAttribute("src","".concat(c.url,"/assets/mute48.png")),c.stream.local?c.stream.stream.getAudioTracks()[0].enabled=!1:(b=c.picker.value,c.picker.value=0,c.media.volume=0))},!c.stream.local){c.picker=document.createElement("input");c.picker.setAttribute("id","picker_".concat(c.id));c.picker.type=
"range";c.picker.min=0;c.picker.max=100;c.picker.step=10;c.picker.value=b;c.picker.setAttribute("orient","vertical");c.div.appendChild(c.picker);c.media.volume=c.picker.value/100;c.media.muted=!1;c.picker.oninput=function(){0<c.picker.value?(c.media.muted=!1,c.icon.setAttribute("src","".concat(c.url,"/assets/sound48.png"))):(c.media.muted=!0,c.icon.setAttribute("src","".concat(c.url,"/assets/mute48.png")));c.media.volume=c.picker.value/100};var d=function(a){c.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: ".concat(c.div.offsetHeight,
"px; display: ").concat(a))};c.div.onmouseover=function(){d("block")};c.div.onmouseout=function(){d("none")};d("none")}return document.getElementById(c.elementID).appendChild(c.div),c},X=function(a){var c,b=O({});b.elementID=a.elementID;b.id=a.id;b.div=document.createElement("div");b.div.setAttribute("id","bar_".concat(b.id));b.div.setAttribute("class","licode_bar");b.bar=document.createElement("div");b.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");
b.bar.setAttribute("id","subbar_".concat(b.id));b.bar.setAttribute("class","licode_subbar");b.link=document.createElement("a");b.link.setAttribute("href","http://www.lynckia.com/");b.link.setAttribute("class","licode_link");b.link.setAttribute("target","_blank");b.logo=document.createElement("img");b.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");b.logo.setAttribute("class","licode_logo");b.logo.setAttribute("alt","Lynckia");b.logo.setAttribute("src",
"".concat(b.url,"/assets/star.svg"));var d=function(a){var d=a;"block"!==a?d="none":clearTimeout(c);b.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: ".concat(d))};return b.display=function(){d("block")},b.hide=function(){c=setTimeout(d,1E3)},document.getElementById(b.elementID).appendChild(b.div),b.div.appendChild(b.bar),b.bar.appendChild(b.link),b.link.appendChild(b.logo),a.stream.screen||void 0!==a.options&&void 0!==a.options.speaker&&!0!==
a.options.speaker||(b.speaker=aa({elementID:"subbar_".concat(b.id),id:b.id,stream:a.stream,media:a.media})),b.display(),b.hide(),b},ba=function(a){var b=O({});b.id=a.id;b.stream=a.stream.stream;b.elementID=a.elementID;var d=function(a,c,d,e){(e?1/a*c>d:1/a*c<d)?(b.video.style.width="".concat(c,"px"),b.video.style.height="".concat(1/a*c,"px"),b.video.style.top="".concat(-(1/a*c/2-d/2),"px"),b.video.style.left="0px"):(b.video.style.height="".concat(d,"px"),b.video.style.width="".concat(a*d,"px"),b.video.style.left=
"".concat(-(a*d/2-c/2),"px"),b.video.style.top="0px")};return b.destroy=function(){b.video.pause();delete b.resizer;b.parentNode.removeChild(b.div)},b.resize=function(){var c=b.container.offsetWidth,e=b.container.offsetHeight;a.stream.screen||!1===a.options.crop?d(16/9,c,e,!1):c===b.containerWidth&&e===b.containerHeight||d(4/3,c,e,!0);b.containerWidth=c;b.containerHeight=e},b.div=document.createElement("div"),b.div.setAttribute("id","player_".concat(b.id)),b.div.setAttribute("class","licode_player"),
b.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),!1!==a.options.loader&&(b.loader=document.createElement("img"),b.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),b.loader.setAttribute("id","back_".concat(b.id)),b.loader.setAttribute("class","licode_loader"),b.loader.setAttribute("src","".concat(b.url,"/assets/loader.gif"))),b.video=document.createElement("video"),
b.video.setAttribute("id","stream".concat(b.id)),b.video.setAttribute("class","licode_stream"),b.video.setAttribute("style","width: 100%; height: 100%; position: absolute"),b.video.setAttribute("autoplay","autoplay"),b.video.setAttribute("playsinline","playsinline"),a.stream.local&&(b.video.volume=0),void 0!==b.elementID?"object"===c(b.elementID)&&"function"==typeof b.elementID.appendChild?b.container=b.elementID:b.container=document.getElementById(b.elementID):b.container=document.body,b.container.appendChild(b.div),
b.parentNode=b.div.parentNode,b.loader&&b.div.appendChild(b.loader),b.div.appendChild(b.video),b.containerWidth=0,b.containerHeight=0,!1!==a.options.resizer&&(b.resizer=L.ResizeSensor(b.container,b.resize),b.resize()),!1!==a.options.bar?(b.bar=X({elementID:"player_".concat(b.id),id:b.id,stream:a.stream,media:b.video,options:a.options}),b.div.onmouseover=function(){b.bar.display()},b.div.onmouseout=function(){b.bar.hide()}):b.media=b.video,b.video.srcObject=b.stream,b},ca=function(a){var c,b,d=O({});
return d.id=a.id,d.stream=a.stream.stream,d.elementID=a.elementID,d.audio=document.createElement("audio"),d.audio.setAttribute("id","stream".concat(d.id)),d.audio.setAttribute("class","licode_stream"),d.audio.setAttribute("style","width: 100%; height: 100%; position: absolute"),d.audio.setAttribute("autoplay","autoplay"),a.stream.local&&(d.audio.volume=0),void 0!==d.elementID?(d.destroy=function(){d.audio.pause();d.parentNode.removeChild(d.div)},c=function(){d.bar.display()},b=function(){d.bar.hide()},
d.div=document.createElement("div"),d.div.setAttribute("id","player_".concat(d.id)),d.div.setAttribute("class","licode_player"),d.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),"object"===f(d.elementID)&&"function"==typeof d.elementID.appendChild?d.container=d.elementID:d.container=document.getElementById(d.elementID),d.container.appendChild(d.div),d.parentNode=d.div.parentNode,d.div.appendChild(d.audio),!1!==a.options.bar?(d.bar=X({elementID:"player_".concat(d.id),
id:d.id,stream:a.stream,media:d.audio,options:a.options}),d.div.onmouseover=c,d.div.onmouseout=b):d.media=d.audio):(d.destroy=function(){d.audio.pause();d.parentNode.removeChild(d.audio)},document.body.appendChild(d.audio),d.parentNode=document.body),d.audio.srcObject=d.stream,d},S=function(a,c){var b=x(c);b.stream=c.stream;b.url=c.url;b.recording=c.recording;b.room=void 0;b.showing=!1;b.local=!1;b.video=c.video;b.audio=c.audio;b.screen=c.screen;b.videoSize=c.videoSize;b.videoFrameRate=c.videoFrameRate;
b.extensionId=c.extensionId;b.desktopStreamId=c.desktopStreamId;b.audioMuted=!1;b.videoMuted=!1;b.p2p=!1;b.ConnectionHelpers=void 0===a?M.a:a;var d=function(a){a.stream.id===b.getLabel()&&b.emit(F({type:"added",stream:a.stream}))},e=function(a){a.stream.id===b.getLabel()&&b.emit(F({type:"removed",stream:b}))},f=function(a){b.emit(F({type:"icestatechanged",msg:a}))};if(!(void 0===b.videoSize||b.videoSize instanceof Array&&4===b.videoSize.length))throw Error("Invalid Video Size");void 0!==c.local&&
!0!==c.local||(b.local=!0);b.getID=function(){return b.local&&!c.streamID?"local":c.streamID};b.getLabel=function(){return b.stream&&b.stream.id?b.stream.id:c.label};b.getAttributes=function(){return c.attributes};b.setAttributes=function(a){b.local?b.emit(F({type:"internal-set-attributes",stream:b,attrs:a})):n.a.error("Failed to set attributes data. This Stream object has not been published.")};b.updateLocalAttributes=function(a){c.attributes=a};b.hasAudio=function(){return!1!==c.audio&&void 0!==
c.audio};b.hasVideo=function(){return!1!==c.video&&void 0!==c.video};b.hasData=function(){return!1!==c.data&&void 0!==c.data};b.hasScreen=function(){return c.screen};b.hasMedia=function(){return c.audio||c.video||c.screen};b.isExternal=function(){return void 0!==b.url||void 0!==b.recording};b.addPC=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;if(c)return b.p2p=!0,void 0===b.pc&&(b.pc=J()),b.pc.add(c,a),void a.on("ice-state-change",f);b.pc&&(b.pc.off("add-stream",
d),b.pc.off("remove-stream",e),b.pc.off("ice-state-change",f));b.pc=a;b.pc.on("add-stream",d);b.pc.on("remove-stream",e);b.pc.on("ice-state-change",f)};b.sendData=function(a){b.local&&b.hasData()?b.emit(F({type:"internal-send-data",stream:b,msg:a})):n.a.error("Failed to send data. This Stream object has not been published.")};b.init=function(){try{if((c.audio||c.video||c.screen)&&void 0===c.url){n.a.info("Requested access to local media");var a=c.video;!0===a||!0===c.screen?(a=!0===a?{}:a,void 0!==
b.videoSize&&(a.width={min:b.videoSize[0],max:b.videoSize[2]},a.height={min:b.videoSize[1],max:b.videoSize[3]}),void 0!==b.videoFrameRate&&(a.frameRate={min:b.videoFrameRate[0],max:b.videoFrameRate[1]})):!0===c.screen&&void 0===a&&(a=!0);b.ConnectionHelpers.GetUserMedia({video:a,audio:c.audio,fake:c.fake,screen:c.screen,extensionId:b.extensionId,desktopStreamId:b.desktopStreamId},function(a){n.a.info("User has granted access to local media.");b.stream=a;b.dispatchEvent(F({type:"access-accepted"}));
b.stream.getTracks().forEach(function(a){n.a.info("getTracks",a);a.onended=function(){b.stream.getTracks().forEach(function(a){a.onended=null});var c=F({type:"stream-ended",stream:b,msg:a.kind});b.dispatchEvent(c)}})},function(a){n.a.error("Failed to get access to local media. Error code was ".concat(a.code,"."));a=F({type:"access-denied",msg:a});b.dispatchEvent(a)})}else{var d=F({type:"access-accepted"});b.dispatchEvent(d)}}catch(V){n.a.error("Failed to get access to local media. Error was ".concat(V,
".")),a=F({type:"access-denied",msg:V}),b.dispatchEvent(a)}};b.close=function(){b.local&&(void 0!==b.room&&b.room.unpublish(b),b.hide(),void 0!==b.stream&&b.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),b.stream=void 0);b.pc&&!b.p2p?(b.pc.off("add-stream",d),b.pc.off("remove-stream",e),b.pc.off("ice-state-change",f)):b.pc&&b.p2p&&b.pc.forEach(function(a){a.off("add-stream",d);a.off("remove-stream",e);a.off("ice-state-change",f)})};b.play=function(a,c){var d;c=c||{};b.elementID=
a;b.hasVideo()||b.hasScreen()?void 0!==a&&(d=ba({id:b.getID(),stream:b,elementID:a,options:c}),b.player=d,b.showing=!0):b.hasAudio()&&(d=ca({id:b.getID(),stream:b,elementID:a,options:c}),b.player=d,b.showing=!0)};b.stop=function(){b.showing&&void 0!==b.player&&(b.player.destroy(),b.showing=!1)};b.show=b.play;b.hide=b.stop;var g=function(){if(void 0!==b.player&&void 0!==b.stream){var a=b.player.video,c=document.defaultView.getComputedStyle(a),d=parseInt(c.getPropertyValue("width"),10),e=parseInt(c.getPropertyValue("height"),
10),f=parseInt(c.getPropertyValue("left"),10);c=parseInt(c.getPropertyValue("top"),10);var g="object"===E(b.elementID)&&"function"==typeof b.elementID.appendChild?b.elementID:document.getElementById(b.elementID);var h=document.defaultView.getComputedStyle(g);g=parseInt(h.getPropertyValue("width"),10);h=parseInt(h.getPropertyValue("height"),10);var k=document.createElement("canvas");return k.id="testing",k.width=g,k.height=h,k.setAttribute("style","display: none"),k.getContext("2d").drawImage(a,f,
c,d,e),k}return null};b.getVideoFrameURL=function(a){var b=g();return null!==b?a?b.toDataURL(a):b.toDataURL():null};b.getVideoFrame=function(){var a=g();return null!==a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};b.checkOptions=function(a,c){!0===c?(a.audio||a.screen)&&(n.a.warning("Cannot update type of subscription"),a.audio=void 0,a.screen=void 0):!1===b.local&&(!0===a.video&&!1===b.hasVideo()&&(n.a.warning("Trying to subscribe to video when there is no video, won't subscribe to video"),
a.video=!1),!0===a.audio&&!1===b.hasAudio()&&(n.a.warning("Trying to subscribe to audio when there is no audio, won't subscribe to audio"),a.audio=!1));!1===b.local&&(b.hasVideo()||!0!==a.slideShowMode||(n.a.warning("Cannot enable slideShowMode if it is not a video subscription, please check your parameters"),a.slideShowMode=!1))};var h=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};if(b.room&&b.room.p2p)return n.a.warning("muteAudio/muteVideo are not implemented in p2p streams"),
void a("error");if(b.stream)for(var c=0;c<b.stream.getVideoTracks().length;c+=1)b.stream.getVideoTracks()[c].enabled=!b.videoMuted;c={muteStream:{audio:b.audioMuted,video:b.videoMuted}};b.checkOptions(c,!0);b.pc&&b.pc.updateSpec(c,b.getID(),a)};b.muteAudio=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};b.audioMuted=a;h(c)};b.muteVideo=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};b.videoMuted=a;h(c)};b._setStaticQualityLayer=
function(a,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};if(b.room&&b.room.p2p)return n.a.warning("setStaticQualityLayer is not implemented in p2p streams"),void d("error");var e={qualityLayer:{spatialLayer:a,temporalLayer:c}};b.checkOptions(e,!0);b.pc.updateSpec(e,b.getID(),d)};b._setDynamicQualityLayer=function(a){if(b.room&&b.room.p2p)return n.a.warning("setDynamicQualityLayer is not implemented in p2p streams"),void a("error");var c={qualityLayer:{spatialLayer:-1,
temporalLayer:-1}};b.checkOptions(c,!0);b.pc.updateSpec(c,b.getID(),a)};b._setMinSpatialLayer=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};if(b.room&&b.room.p2p)return n.a.warning("setMinSpatialLayer is not implemented in p2p streams"),void c("error");var d={minLayer:{spatialLayer:a}};b.checkOptions(d,!0);n.a.debug("Calling updateSpec with config",d);b.pc.updateSpec(d,b.getID(),c)};var k=function(a,c,d){!0!==c&&(c=!1);0<(a=(a="string"==typeof a?[a]:a)instanceof
Array?a:[]).length&&b.room.sendControlMessage(b,"control",{name:"controlhandlers",enable:d,publisherSide:c,handlers:a})};return b.disableHandlers=function(a,c){k(a,c,!1)},b.enableHandlers=function(a,c){k(a,c,!0)},b.updateConfiguration=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};if(void 0!==a)if(b.pc)if(b.checkOptions(a,!0),b.local)if(b.room.p2p)for(var d=0;d<b.pc.length;d+=1)b.pc[d].updateSpec(a,b.getID(),c);else b.pc.updateSpec(a,b.getID(),c);else b.pc.updateSpec(a,
b.getID(),c);else c("This stream has no peerConnection attached, ignoring")},b},da=function(){for(var a,c,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),d=[],e=0;e<b.length;e+=1)d[b[e]]=e;var f=function(){if(!a||c>=a.length)return-1;var b=255&a.charCodeAt(c);return c+=1,b},g=function(){if(!a)return-1;for(;;){if(c>=a.length)return-1;var b=a.charAt(c);if(c+=1,d[b])return d[b];if("A"===b)return 0}},h=function(a){a=a.toString(16);return 1===a.length&&(a="0".concat(a)),
a="%".concat(a),unescape(a)};return{encodeBase64:function(d){var e;a=d;c=0;d="";var g=Array(3);var h=0;for(e=!1;!e&&-1!==(g[0]=f());)g[1]=f(),g[2]=f(),d+=b[g[0]>>2],-1!==g[1]?(d+=b[g[0]<<4&48|g[1]>>4],-1!==g[2]?(d+=b[g[1]<<2&60|g[2]>>6],d+=b[63&g[2]]):(d+=b[g[1]<<2&60],d="".concat(d,"\x3d"),e=!0)):(d+=b[g[0]<<4&48],d="".concat(d,"\x3d"),d="".concat(d,"\x3d"),e=!0),76<=(h+=4)&&(d="".concat(d,"\n"),h=0);return d},decodeBase64:function(b){var d;a=b;c=0;b="";var e=Array(4);for(d=!1;!d&&-1!==(e[0]=g())&&
-1!==(e[1]=g());)e[2]=g(),e[3]=g(),b+=h(e[0]<<2&255|e[1]>>4),-1!==e[2]?(b+=h(e[1]<<4&255|e[2]>>2),-1!==e[3]?b+=h(e[2]<<6&255|e[3]):d=!0):d=!0;return b}}}();l(29);l(31);l={Room:function(a,b,c,d){var e=x(d);e.remoteStreams=J();e.localStreams=J();e.roomID="";e.state=0;e.p2p=!1;e.ConnectionHelpers=void 0===b?M.a:b;e.erizoConnectionManager=void 0===c?new Y:new c.ErizoConnectionManager;var f=T(a);e.socket=f;var g=e.remoteStreams,h=e.localStreams,k=function(a){a.removeAllListeners();a.pc&&!e.p2p&&a.pc.removeStream(a);
n.a.debug("Removed stream");a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&e.p2p?a.pc.forEach(function(b,c){b.close();a.pc.remove(c)}):(e.erizoConnectionManager.maybeCloseConnection(a.pc),delete a.pc))},l=function(a,b){0!==e.state&&a&&!a.failed&&(a.failed=!0,b=F({type:"stream-failed",msg:b||"Stream failed after connection",stream:a}),e.dispatchEvent(b),a.local?e.unpublish(a):e.unsubscribe(a))},p=function(a,b){n.a.info("Stream subscribed");a.stream=b.stream;e.p2p||a.pc.addStream(a);
a=F({type:"stream-subscribed",stream:a});e.dispatchEvent(a)},q=function(a,b){return{callback:function(c){f.sendSDP("signaling_message",{streamId:a.getID(),peerSocket:b,msg:c})},audio:a.hasAudio(),video:a.hasVideo(),iceServers:e.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:d.maxAudioBW,limitMaxVideoBW:d.maxVideoBW,forceTurn:a.forceTurn,p2p:!0}},r=function(a,b,c){var g={callback:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a.getID();n.a.info("Sending message",
b,a.getID(),c);f.sendSDP("signaling_message",{streamId:c,msg:b,browser:a.pc&&a.pc.browser},void 0,function(){})},nop2p:!0,audio:b.audio&&a.hasAudio(),video:b.video&&a.hasVideo(),maxAudioBW:b.maxAudioBW,maxVideoBW:b.maxVideoBW,limitMaxAudioBW:d.maxAudioBW,limitMaxVideoBW:d.maxVideoBW,label:a.getLabel(),iceServers:e.iceServers,forceTurn:a.forceTurn,p2p:!1};return c||(g.simulcast=b.simulcast,g.startVideoBW=b.startVideoBW,g.hardMinVideoBW=b.hardMinVideoBW),g},t=function(a){var b=a.stream;a=a.msg;b.local?
f.sendMessage("sendDataStream",{id:b.getID(),msg:a}):n.a.error("You can not send data through a remote stream")},u=function(a){var b=a.stream;a=a.attrs;b.local?(b.updateLocalAttributes(a),f.sendMessage("updateStreamAttributes",{id:b.getID(),attrs:a})):n.a.error("You can not update attributes in a remote stream")};a=function(a,b){b.args?a.apply(void 0,m(b.args)):a()};var v=function(a,b,c){return{state:a,data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),label:b.getLabel(),screen:b.hasScreen(),
attributes:b.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream}},w=function(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};if(null===a)return n.a.error("Error when publishing the stream",c),void d(void 0,c);n.a.info("Stream published");b.getID=function(){return a};b.on("internal-send-data",t);b.on("internal-set-attributes",u);h.add(a,b);b.room=e;d(a)},y=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:
function(){};n.a.info("Publishing to Erizo Normally, is createOffer",b.createOffer);var g=v("erizo",a,b);g.minVideoBW=b.minVideoBW;g.maxVideoBW=b.maxVideoBW;g.scheme=b.scheme;f.sendSDP("publish",g,void 0,function(f,g,h){if(null===f)return n.a.error("Error publishing stream",h),void c(void 0,h);w(f,a,h,void 0);(function(a,b,c){a.addPC(e.erizoConnectionManager.getOrBuildErizoConnection(r(a,c),b,d.singlePC));a.on("icestatechanged",function(b){n.a.info("".concat(a.getID()," - iceConnectionState: ").concat(b.msg.state));
"failed"===b.msg.state&&l(a)});a.pc.addStream(a);c.createOffer||a.pc.createOffer(!1,d.singlePC,a.getID())})(a,g,b);c(f)})},z=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};b.maxVideoBW=b.maxVideoBW||d.defaultVideoBW;b.maxVideoBW>d.maxVideoBW&&(b.maxVideoBW=d.maxVideoBW);b.audio=void 0===b.audio||b.audio;b.video=void 0===b.video||b.video;b.data=void 0===b.data||b.data;a.checkOptions(b);var g={streamId:a.getID(),audio:b.audio&&a.hasAudio(),video:function(a,b){a=
b&&a.hasVideo();var c=b&&b.width,d=b&&b.height;b=b&&b.frameRate;return c||d||b?{width:c,height:d,frameRate:b}:a}(a,b.video),maxVideoBW:b.maxVideoBW,data:b.data&&a.hasData(),browser:e.ConnectionHelpers.getBrowser(),createOffer:b.createOffer,metadata:b.metadata,muteStream:b.muteStream,slideShowMode:b.slideShowMode};f.sendSDP("subscribe",g,void 0,function(f,g,h){if(null===f)return n.a.error("Error subscribing to stream ",h),void c(void 0,h);n.a.info("Subscriber added");(function(a,b,c){a.addPC(e.erizoConnectionManager.getOrBuildErizoConnection(r(a,
c,!0),b,d.singlePC));a.on("added",p.bind(null,a));a.on("icestatechanged",function(b){n.a.info("".concat(a.getID()," - iceConnectionState: ").concat(b.msg.state));"failed"===b.msg.state&&l(a)});a.pc.createOffer(!0,!1,a.getID())})(a,g,b);c(!0)})};return e.connect=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=da.decodeBase64(d.token);0!==e.state&&n.a.warning("Room already connected");e.state=1;f.connect(JSON.parse(b),a,function(a){var b=[],c=a.streams||[],f=a.id;e.p2p=
a.p2p;e.iceServers=a.iceServers;e.state=2;d.singlePC=a.singlePC;d.defaultVideoBW=a.defaultVideoBW;d.maxVideoBW=a.maxVideoBW;for(var h=Object.keys(c),k=0;k<h.length;k+=1){var l=c[h[k]];(a=S(e.ConnectionHelpers,{streamID:l.id,local:!1,audio:l.audio,video:l.video,data:l.data,label:l.label,screen:l.screen,attributes:l.attributes})).room=e;b.push(a);g.add(l.id,a)}e.roomID=f;n.a.info("Connected to room ".concat(e.roomID));b=K({type:"room-connected",streams:b});e.dispatchEvent(b)},function(a){n.a.error("Not Connected! Error: ".concat(a));
a=K({type:"room-error",message:a});e.dispatchEvent(a)})},e.disconnect=function(){n.a.debug("Disconnection requested");var a=K({type:"room-disconnected",message:"expected-disconnection"});e.dispatchEvent(a)},e.publish=function(a){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};c.maxVideoBW=c.maxVideoBW||d.defaultVideoBW;c.maxVideoBW>d.maxVideoBW&&(c.maxVideoBW=d.maxVideoBW);void 0===c.minVideoBW&&(c.minVideoBW=0);
c.minVideoBW>d.defaultVideoBW&&(c.minVideoBW=d.defaultVideoBW);a.forceTurn=c.forceTurn;c.simulcast=c.simulcast||!1;c.muteStream={audio:a.audioMuted,video:a.videoMuted};a&&a.local&&!a.failed&&!h.has(a.getID())?a.hasMedia()?a.isExternal()?function(a,b){var c,d,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};a.url?(c="url",d=a.url):(c="recording",d=a.recording);n.a.info("Checking publish options for",a.getID());a.checkOptions(b);f.sendSDP("publish",v(c,a,b),d,function(b,c){w(b,
a,c,e)})}(a,c,b):e.p2p?function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};a.maxAudioBW=b.maxAudioBW;a.maxVideoBW=b.maxVideoBW;f.sendSDP("publish",v("p2p",a,b),void 0,function(b,d){w(b,a,d,c)})}(a,c,b):y(a,c,b):a.hasData()&&function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};f.sendSDP("publish",v("data",a,b),void 0,function(b,d){w(b,a,d,c)})}(a,c,b):(n.a.error("Trying to publish invalid stream"),b(void 0,"Invalid Stream"))},e.startRecording=
function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};if(void 0===a)return n.a.error("Trying to start recording on an invalid stream",a),void b(void 0,"Invalid Stream");n.a.debug("Start Recording stream: ".concat(a.getID()));f.sendMessage("startRecorder",{to:a.getID()},function(a,c){if(null===a)return n.a.error("Error on start recording",c),void b(void 0,c);n.a.info("Start recording",a);b(a)})},e.stopRecording=function(a){var b=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:function(){};f.sendMessage("stopRecorder",{id:a},function(c,d){if(null===c)return n.a.error("Error on stop recording",d),void b(void 0,d);n.a.info("Stop recording",a);b(!0)})},e.unpublish=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};if(a&&a.local){if(f.sendMessage("unpublish",a.getID(),function(c,d){if(null===c)return n.a.error("Error unpublishing stream",d),void b(void 0,d);delete a.failed;b(!0)}),n.a.info("Stream unpublished"),a.room=void 0,
a.hasMedia()&&!a.isExternal()){var c=h.has(a.getID())?h.get(a.getID()):a;k(c)}h.remove(a.getID());a.getID=function(){};a.off("internal-send-data",t);a.off("internal-set-attributes",u)}else n.a.error("Cannot unpublish, stream does not exist or is not local"),b(void 0,"Cannot unpublish, stream does not exist or is not local")},e.sendControlMessage=function(a,b,c){a&&a.getID()&&(b={type:"control",action:c},f.sendSDP("signaling_message",{streamId:a.getID(),msg:b}))},e.subscribe=function(a){var b=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:function(){},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!a||a.local||a.failed)c="Error on subscribe",a?a.local?(n.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),c="Local copy of stream"):a.failed&&(n.a.warning("Cannot subscribe to failed stream."),c="Failed stream"):(n.a.warning("Cannot subscribe to invalid stream"),c="Invalid or undefined stream"),b(void 0,c);else{if(a.hasMedia())a.hasVideo()||
a.hasScreen()||(c.video=!1),a.hasAudio()||(c.audio=!1),c.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=c.forceTurn,e.p2p?(f.sendSDP("subscribe",{streamId:a.getID(),metadata:c.metadata}),b(!0)):z(a,c,b);else{if(!a.hasData()||!1===c.data)return n.a.warning("There's nothing to subscribe to"),void b(void 0,"Nothing to subscribe to");!function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};f.sendSDP("subscribe",{streamId:a.getID(),data:b.data,metadata:b.metadata},
void 0,function(b,d){if(null===b)return n.a.error("Error subscribing to stream ",d),void c(void 0,d);n.a.info("Stream subscribed");b=F({type:"stream-subscribed",stream:a});e.dispatchEvent(b);c(!0)})}(a,c,b)}n.a.info("Subscribing to: ".concat(a.getID()))}},e.unsubscribe=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};void 0!==f&&a&&!a.local&&f.sendMessage("unsubscribe",a.getID(),function(c,d){null!==c?(k(a),delete a.failed,b(!0)):b(void 0,d)},function(){n.a.error("Error calling unsubscribe.")})},
e.getStreamStats=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return f?a?void f.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)}):"Error getting stats - no stream":"Error getting stats - no socket"},e.getStreamsByAttribute=function(a,b){var c=[];return g.forEach(function(d){void 0!==d.getAttributes()&&d.getAttributes()[a]===b&&c.push(d)}),c},e.on("room-disconnected",function(){e.state=0;f.state=f.DISCONNECTED;g.forEach(function(a,b){if(k(a),g.remove(b),
a&&!a.failed)a=F({type:"stream-removed",stream:a}),e.dispatchEvent(a)});g=J();h.forEach(function(a,b){k(a);h.remove(b)});h=J();try{f.disconnect()}catch(fa){n.a.debug("Socket already disconnected")}f=void 0}),f.on("onAddStream",a.bind(null,function(a){if(!g.has(a.id)){var b=S(e.Connection,{streamID:a.id,local:h.has(a.id),audio:a.audio,video:a.video,data:a.data,label:a.label,screen:a.screen,attributes:a.attributes});b.room=e;g.add(a.id,b);a=F({type:"stream-added",stream:b});e.dispatchEvent(a)}})),f.on("signaling_message_erizo",
a.bind(null,function(a){var b;(b=a.peerId?g.get(a.peerId):h.get(a.streamId))&&b.pc&&!b.failed&&b.pc.processSignalingMessage(a.mess)})),f.on("signaling_message_peer",a.bind(null,function(a){var b=h.get(a.streamId);b&&!b.failed?b.pc.get(a.peerSocket).processSignalingMessage(a.msg):((b=g.get(a.streamId)).pc||function(a,b){a.addPC(e.erizoConnectionManager.getOrBuildErizoConnection(q(a,b)));a.on("added",p.bind(null,a));a.on("icestatechanged",function(b){n.a.info("".concat(a.getID()," - iceConnectionState: ").concat(b.msg.state));
"failed"===b.msg.state&&l(a)})}(b,a.peerSocket),b.pc.processSignalingMessage(a.msg))})),f.on("publish_me",a.bind(null,function(a){!function(a,b){var c=e.erizoConnectionManager.getOrBuildErizoConnection(q(a,b));a.addPC(c,b);a.on("icestatechanged",function(c){n.a.info("".concat(a.getID()," - iceConnectionState: ").concat(c.msg.state));"failed"===c.msg.state&&(a.pc.get(b).close(),a.pc.remove(b))});c.addStream(a);c.createOffer()}(h.get(a.streamId),a.peerSocket)})),f.on("unpublish_me",a.bind(null,function(a){var b=
h.get(a.streamId);b&&(a=a.peerSocket,void 0!==b.pc&&b.pc.has(a)&&(b.pc.get(a).close(),b.pc.remove(a)))})),f.on("onBandwidthAlert",a.bind(null,function(a){if(n.a.info("Bandwidth Alert on",a.streamID,"message",a.message,"BW:",a.bandwidth),a.streamID){var b=g.get(a.streamID);b&&!b.failed&&(a=F({type:"bandwidth-alert",stream:b,msg:a.message,bandwidth:a.bandwidth}),b.dispatchEvent(a))}})),f.on("onDataStream",a.bind(null,function(a){var b=g.get(a.id);a=F({type:"stream-data",msg:a.msg,stream:b});b.dispatchEvent(a)})),
f.on("onUpdateAttributeStream",a.bind(null,function(a){var b=g.get(a.id),c=F({type:"stream-attributes-update",attrs:a.attrs,stream:b});b.updateLocalAttributes(a.attrs);b.dispatchEvent(c)})),f.on("onRemoveStream",a.bind(null,function(a){var b=h.get(a.id);if(b)l(b);else if(b=g.get(a.id))k(b),g.remove(a.id),a=F({type:"stream-removed",stream:b}),e.dispatchEvent(a)})),f.on("disconnect",a.bind(null,function(){if(n.a.info("Socket disconnected, lost connection to ErizoController"),0!==e.state){n.a.error("Unexpected disconnection from ErizoController");
var a=K({type:"room-disconnected",message:"unexpected-disconnection"});e.dispatchEvent(a)}})),f.on("connection_failed",a.bind(null,function(a){if(a.streamId){var b="ICE Connection Failed on ".concat(a.type," ").concat(a.streamId," ").concat(e.state);n.a.error(b);a="publish"===a.type?h.get(a.streamId):g.get(a.streamId);l(a,b)}})),f.on("error",a.bind(null,function(a){n.a.error("Cannot connect to erizo Controller");a=K({type:"room-error",message:a});e.dispatchEvent(a)})),e}.bind(null,void 0,void 0,void 0),
LicodeEvent:I,RoomEvent:K,StreamEvent:F,Stream:S.bind(null,void 0),Logger:n.a};p.default=l}]).default;
//# sourceMappingURL=erizo.js.map
